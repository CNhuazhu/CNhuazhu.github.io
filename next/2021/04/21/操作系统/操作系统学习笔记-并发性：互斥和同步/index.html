<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>èŠ±çŒªã®Blog | èŠ±çŒªã®Blog</title><meta name="keywords" content="keywords"><meta name="author" content="èŠ±çŒª,2296412185@qq.com"><meta name="copyright" content="èŠ±çŒª"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="{&quot;hostname&quot;:&quot;cnhuazhu.gitee.io&quot;,&quot;root&quot;:&quot;&#x2F;next&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;next&#x2F;images&quot;,&quot;scheme&quot;:&quot;Mist&quot;,&quot;version&quot;:&quot;8.6.1&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;Muse | Mist&quot;:320,&quot;disp">
<meta property="og:type" content="website">
<meta property="og:title" content="èŠ±çŒªã®Blog">
<meta property="og:url" content="https://cnhuazhu.top/next/2021/04/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5/index.html">
<meta property="og:site_name" content="èŠ±çŒªã®Blog">
<meta property="og:description" content="{&quot;hostname&quot;:&quot;cnhuazhu.gitee.io&quot;,&quot;root&quot;:&quot;&#x2F;next&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;next&#x2F;images&quot;,&quot;scheme&quot;:&quot;Mist&quot;,&quot;version&quot;:&quot;8.6.1&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;Muse | Mist&quot;:320,&quot;disp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/tag.jpg">
<meta property="article:published_time" content="2021-09-27T01:20:57.681Z">
<meta property="article:modified_time" content="2021-09-27T01:20:57.681Z">
<meta property="article:author" content="èŠ±çŒª">
<meta property="article:tag" content="keywords">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/tag.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg"><link rel="canonical" href="https://cnhuazhu.top/next/2021/04/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/butterfly/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/butterfly/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":60,"languages":{"author":"ä½œè€…: èŠ±çŒª","link":"é“¾æ¥: ","source":"æ¥æº: èŠ±çŒªã®Blog","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#ABADAC","bgDark":"#121212","position":"bottom-right"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'èŠ±çŒªã®Blog',
  isPost: false,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-09-27 09:20:57'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/butterfly/css/tag.css"><link rel="stylesheet" href="/butterfly/css/pagelucency.css"><style>#article-container.post-content h1:before, h2:before, h3:before, h4:before, h5:before, h6:before { -webkit-animation: avatar_turn_around 1s linear infinite; -moz-animation: avatar_turn_around 1s linear infinite; -o-animation: avatar_turn_around 1s linear infinite; -ms-animation: avatar_turn_around 1s linear infinite; animation: avatar_turn_around 1s linear infinite; }</style><link rel="stylesheet" href="/butterfly/css/avatarbg.css"><link rel="stylesheet" href="/butterfly/css/footerlucency.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/macblack.css"><link rel="stylesheet" href="/butterfly/css/mouse.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiper.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiperstyle.css"><!-- hexo injector head_end end --><link rel="alternate" href="/butterfly/atom.xml" title="èŠ±çŒªã®Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/butterfly/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">82</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/butterfly/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/butterfly/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/butterfly/blog-LeadPage/"><i class="fa-fw fas fa-gift"></i><span> å¼•å¯¼</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-sitemap"></i><span> åˆ†ç«™</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterfly/./next"><i class="fa-fw fas fa-chevron-right"></i><span> Next</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/butterfly/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterfly/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></li><li><a class="site-page child" href="/butterfly/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/butterfly/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> ç”Ÿæ´»</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterfly/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/butterfly/Gallery/"><i class="fa-fw fas fa-images"></i><span> å›¾åº“</span></a></li><li><a class="site-page child" href="/butterfly/books/"><i class="fa-fw fas fa-book"></i><span> é˜…è¯»</span></a></li><li><a class="site-page child" href="/butterfly/movies/"><i class="fa-fw fas fa-film"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/butterfly/video/"><i class="fa-fw fa fa-video"></i><span> è§†é¢‘</span></a></li><li><a class="site-page child" href="/butterfly/artitalk/"><i class="fa-fw fas fa-quote-left"></i><span> è¯´è¯´</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> é“¾æ¥</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterfly/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></li><li><a class="site-page child" href="/butterfly/website/"><i class="fa-fw fas fa-globe"></i><span> ç½‘ç«™</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/butterfly/Message/"><i class="fa-fw fas fa-comment"></i><span> ç•™è¨€</span></a></div><div class="menus_item"><a class="site-page" href="/butterfly/about/"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div id="body-wrap"><header class="not-home-page" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/CNhuazhu/Image/tag.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/butterfly/">èŠ±çŒªã®Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/butterfly/blog-LeadPage/"><i class="fa-fw fas fa-gift"></i><span> å¼•å¯¼</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-sitemap"></i><span> åˆ†ç«™</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterfly/./next"><i class="fa-fw fas fa-chevron-right"></i><span> Next</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/butterfly/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterfly/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></li><li><a class="site-page child" href="/butterfly/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/butterfly/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> ç”Ÿæ´»</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterfly/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/butterfly/Gallery/"><i class="fa-fw fas fa-images"></i><span> å›¾åº“</span></a></li><li><a class="site-page child" href="/butterfly/books/"><i class="fa-fw fas fa-book"></i><span> é˜…è¯»</span></a></li><li><a class="site-page child" href="/butterfly/movies/"><i class="fa-fw fas fa-film"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/butterfly/video/"><i class="fa-fw fa fa-video"></i><span> è§†é¢‘</span></a></li><li><a class="site-page child" href="/butterfly/artitalk/"><i class="fa-fw fas fa-quote-left"></i><span> è¯´è¯´</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> é“¾æ¥</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterfly/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></li><li><a class="site-page child" href="/butterfly/website/"><i class="fa-fw fas fa-globe"></i><span> ç½‘ç«™</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/butterfly/Message/"><i class="fa-fw fas fa-comment"></i><span> ç•™è¨€</span></a></div><div class="menus_item"><a class="site-page" href="/butterfly/about/"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="page-site-info"><h1 id="site-title">èŠ±çŒªã®Blog</h1></div></header><main class="layout" id="content-inner"><div id="page"><div id="article-container"><!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg">

<link rel="stylesheet" href="/next/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"cnhuazhu.gitee.io","root":"/next/","images":"/next/images","scheme":"Mist","version":"8.6.1","exturl":false,"sidebar":{"position":"left","Muse | Mist":320,"display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/next/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/next/js/config.js"></script>
<meta name="description" content="è®°å½•æ“ä½œç³»ç»Ÿå­¦ä¹ å†ç¨‹">
<meta property="og:type" content="article">
<meta property="og:title" content="æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥">
<meta property="og:url" content="https://cnhuazhu.gitee.io/next/2021/04/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5/index.html">
<meta property="og:site_name" content="èŠ±çŒªã®Blog">
<meta property="og:description" content="è®°å½•æ“ä½œç³»ç»Ÿå­¦ä¹ å†ç¨‹">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E5%B9%B6%E8%A1%8C%E5%A4%84%E7%90%86%E8%BF%9B%E7%A8%8B.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E6%A1%88%E4%BE%8B%E8%BF%87%E7%A8%8B%E4%B8%80.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E6%A1%88%E4%BE%8B%E8%BF%87%E7%A8%8B%E4%BA%8C.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E7%AB%9E%E4%BA%89.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E9%A5%A5%E9%A5%BF.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E7%AB%9E%E4%BA%892.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E5%BC%BA%E4%BF%A1%E5%8F%B7%E9%87%8F.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E4%BF%A1%E5%8F%B7%E9%87%8F%E8%AF%B4%E6%98%8E.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E7%AE%A1%E7%A8%8B.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OSAddressing.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F.png">
<meta property="article:published_time" content="2021-04-21T11:55:33.000Z">
<meta property="article:modified_time" content="2021-07-13T16:18:09.242Z">
<meta property="article:author" content="èŠ±çŒª">
<meta property="article:tag" content="æ“ä½œç³»ç»Ÿ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E5%B9%B6%E8%A1%8C%E5%A4%84%E7%90%86%E8%BF%9B%E7%A8%8B.png">


<link rel="canonical" href="https://cnhuazhu.gitee.io/next/2021/04/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://cnhuazhu.gitee.io/next/2021/04/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5/","path":"2021/04/21/æ“ä½œç³»ç»Ÿ/æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥/","title":"æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥ | èŠ±çŒªã®Blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/next/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/next/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">èŠ±çŒªã®Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-ä¸»ç«™"><a href="https://cnhuazhu.top/" rel="noopener" target="_blank"><i class="fas fa-chevron-right fa-fw"></i>ä¸»ç«™</a></li>
        <li class="menu-item menu-item-home"><a href="/next/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li>
        <li class="menu-item menu-item-tags"><a href="/next/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">14</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/next/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">8</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/next/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">53</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0%EF%BC%9A%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5"><span class="nav-number">2.</span> <span class="nav-text">ç¬¬äº”ç« ï¼šå¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E7%9A%84%E5%8E%9F%E7%90%86"><span class="nav-number">2.1.</span> <span class="nav-text">å¹¶å‘çš„åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E6%A1%88%E4%BE%8B%E5%8F%8A%E5%88%86%E6%9E%90"><span class="nav-number">2.1.1.</span> <span class="nav-text">ç®€å•æ¡ˆä¾‹åŠåˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AB%9E%E4%BA%89%E6%9D%A1%E4%BB%B6"><span class="nav-number">2.1.2.</span> <span class="nav-text">ç«äº‰æ¡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%85%B3%E6%B3%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">2.1.3.</span> <span class="nav-text">æ“ä½œç³»ç»Ÿå…³æ³¨çš„é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%BA%A4%E4%BA%92"><span class="nav-number">2.1.4.</span> <span class="nav-text">è¿›ç¨‹çš„äº¤äº’</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E8%B5%84%E6%BA%90%E7%AB%9E%E4%BA%89"><span class="nav-number">2.1.4.1.</span> <span class="nav-text">è¿›ç¨‹é—´çš„èµ„æºç«äº‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E8%BF%87%E5%85%B1%E4%BA%AB%E5%90%88%E4%BD%9C"><span class="nav-number">2.1.4.2.</span> <span class="nav-text">è¿›ç¨‹é—´é€šè¿‡å…±äº«åˆä½œ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E8%BF%87%E9%80%9A%E4%BF%A1%E5%90%88%E4%BD%9C"><span class="nav-number">2.1.4.3.</span> <span class="nav-text">è¿›ç¨‹é—´é€šè¿‡é€šä¿¡åˆä½œ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%92%E6%96%A5%E7%9A%84%E8%A6%81%E6%B1%82"><span class="nav-number">2.1.5.</span> <span class="nav-text">äº’æ–¥çš„è¦æ±‚</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%92%E6%96%A5%EF%BC%9A%E7%A1%AC%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81"><span class="nav-number">2.2.</span> <span class="nav-text">äº’æ–¥ï¼šç¡¬ä»¶çš„æ”¯æŒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E6%96%AD%E7%A6%81%E7%94%A8"><span class="nav-number">2.2.1.</span> <span class="nav-text">ä¸­æ–­ç¦ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%93%E7%94%A8%E6%9C%BA%E5%99%A8%E6%8C%87%E4%BB%A4"><span class="nav-number">2.2.2.</span> <span class="nav-text">ä¸“ç”¨æœºå™¨æŒ‡ä»¤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#compare-and-swap%EF%BC%88%E6%AF%94%E8%BE%83%E5%92%8C%E4%BA%A4%E6%8D%A2%E6%8C%87%E4%BB%A4%EF%BC%89"><span class="nav-number">2.2.2.1.</span> <span class="nav-text">compare_and_swapï¼ˆæ¯”è¾ƒå’Œäº¤æ¢æŒ‡ä»¤ï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exchange%EF%BC%88%E4%BA%A4%E6%8D%A2%E6%8C%87%E4%BB%A4%EF%BC%89"><span class="nav-number">2.2.2.2.</span> <span class="nav-text">exchangeï¼ˆäº¤æ¢æŒ‡ä»¤ï¼‰</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F"><span class="nav-number">2.3.</span> <span class="nav-text">ä¿¡å·é‡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">2.3.1.</span> <span class="nav-text">åŸºæœ¬åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F%E7%9A%84%E7%BB%93%E6%9E%84"><span class="nav-number">2.3.2.</span> <span class="nav-text">ä¿¡å·é‡çš„ç»“æ„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">2.3.3.</span> <span class="nav-text">ä¿¡å·é‡çš„ä½¿ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F%E5%8E%9F%E8%AF%AD%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-number">2.3.4.</span> <span class="nav-text">ä¿¡å·é‡åŸè¯­çš„å®šä¹‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%85%83%E4%BF%A1%E5%8F%B7%E9%87%8F"><span class="nav-number">2.3.5.</span> <span class="nav-text">äºŒå…ƒä¿¡å·é‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%BA%E3%80%81%E5%BC%B1%E4%BF%A1%E5%8F%B7%E9%87%8F"><span class="nav-number">2.3.6.</span> <span class="nav-text">å¼ºã€å¼±ä¿¡å·é‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%92%E6%96%A5"><span class="nav-number">2.3.7.</span> <span class="nav-text">äº’æ–¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F%E9%97%AE%E9%A2%98"><span class="nav-number">2.3.8.</span> <span class="nav-text">ä¿¡å·é‡é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.3.9.</span> <span class="nav-text">ä¿¡å·é‡çš„å®ç°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%A1%E7%A8%8B"><span class="nav-number">2.4.</span> <span class="nav-text">ç®¡ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E4%BF%A1%E5%8F%B7%E7%9A%84%E7%AE%A1%E7%A8%8B"><span class="nav-number">2.4.1.</span> <span class="nav-text">ä½¿ç”¨ä¿¡å·çš„ç®¡ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%80%9A%E7%9F%A5%E5%92%8C%E5%B9%BF%E6%92%AD%E7%9A%84%E7%AE%A1%E7%A8%8B"><span class="nav-number">2.4.2.</span> <span class="nav-text">ä½¿ç”¨é€šçŸ¥å’Œå¹¿æ’­çš„ç®¡ç¨‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B6%88%E6%81%AF%E4%BC%A0%E9%80%92"><span class="nav-number">2.5.</span> <span class="nav-text">æ¶ˆæ¯ä¼ é€’</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8C%E6%AD%A5%EF%BC%88Synchronization%EF%BC%89"><span class="nav-number">2.5.1.</span> <span class="nav-text">åŒæ­¥ï¼ˆSynchronizationï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BB%E5%9D%80%EF%BC%88Addressing%EF%BC%89"><span class="nav-number">2.5.2.</span> <span class="nav-text">å¯»å€ï¼ˆAddressingï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="nav-number">2.5.3.</span> <span class="nav-text">æ¶ˆæ¯æ ¼å¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E9%98%9F%E5%8E%9F%E5%88%99"><span class="nav-number">2.5.4.</span> <span class="nav-text">æ’é˜ŸåŸåˆ™</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%92%E6%96%A5-1"><span class="nav-number">2.5.5.</span> <span class="nav-text">äº’æ–¥</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%8E%E8%AE%B0"><span class="nav-number">3.</span> <span class="nav-text">åè®°</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="èŠ±çŒª"
      src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg">
  <p class="site-author-name" itemprop="name">èŠ±çŒª</p>
  <div class="site-description" itemprop="description">ä¸ºäº†è·å¾—ä¸åŒçš„é˜…è¯»ä½“éªŒï¼Œå»ºç«‹æ­¤åˆ†ç«™ã€‚<br>ï¼ˆå¯åœ¨å¯¼èˆªæ æœç´¢æƒ³è¦æŸ¥çœ‹çš„æ–‡ç« ï¼‰<br><br>æœ¬ç«™ä¸»é¢˜ï¼šNEXT 8.6.1</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/next/archives/">
        
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/next/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/next/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CNhuazhu" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;CNhuazhu" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/CNhuazhu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener external nofollow noreferrer" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnhuazhu.gitee.io/next/2021/04/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg">
      <meta itemprop="name" content="èŠ±çŒª">
      <meta itemprop="description" content="ä¸ºäº†è·å¾—ä¸åŒçš„é˜…è¯»ä½“éªŒï¼Œå»ºç«‹æ­¤åˆ†ç«™ã€‚<br>ï¼ˆå¯åœ¨å¯¼èˆªæ æœç´¢æƒ³è¦æŸ¥çœ‹çš„æ–‡ç« ï¼‰<br><br>æœ¬ç«™ä¸»é¢˜ï¼šNEXT 8.6.1">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±çŒªã®Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-21 19:55:33" itemprop="dateCreated datePublished" datetime="2021-04-21T19:55:33+08:00">2021-04-21</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-07-14 00:18:09" itemprop="dateModified" datetime="2021-07-14T00:18:09+08:00">2021-07-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/next/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">å­¦ä¹ ç¬”è®°</span></a>
        </span>
    </span>

  
    <span id="/next/2021/04/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5/" class="post-meta-item leancloud_visitors" data-flag-title="æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span id="/next/2021/04/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%B9%B6%E5%8F%91%E6%80%A7%EF%BC%9A%E4%BA%92%E6%96%A5%E5%92%8C%E5%90%8C%E6%AD%A5/" class="post-meta-item twikoo_visitors" data-flag-title="æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="twikoo_visitors"></span>
    </span>
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>21k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>20 åˆ†é’Ÿ</span>
    </span>
</div>

            <div class="post-description">è®°å½•æ“ä½œç³»ç»Ÿå­¦ä¹ å†ç¨‹</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><em>æ­£åœ¨å­¦ä¹ æ“ä½œç³»ç»Ÿï¼Œè®°å½•ç¬”è®°ã€‚</em></p>
<blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p>ã€Šæ“ä½œç³»ç»Ÿï¼ˆç²¾é«“ä¸è®¾è®¡åŸç† ç¬¬6ç‰ˆï¼‰ ã€‹</p>
</blockquote>
<hr>
<h1 id="ç¬¬äº”ç« ï¼šå¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥"><a href="#ç¬¬äº”ç« ï¼šå¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥" class="headerlink" title="ç¬¬äº”ç« ï¼šå¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥"></a>ç¬¬äº”ç« ï¼šå¹¶å‘æ€§ï¼šäº’æ–¥å’ŒåŒæ­¥</h1><p>æ“çºµç³»ç»Ÿè®¾è®¡ä¸­çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯å…³äºè¿›ç¨‹å’Œçº¿ç¨‹çš„ç®¡ç†ï¼ˆåŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼‰ï¼š</p>
<ul>
<li>å¤šé“ç¨‹åºè®¾è®¡æŠ€æœ¯ï¼šç®¡ç†å•å¤„ç†å™¨ç³»ç»Ÿä¸­çš„å¤šä¸ªè¿›ç¨‹ã€‚</li>
<li>å¤šå¤„ç†æŠ€æœ¯ï¼šç®¡ç†å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­çš„å¤šä¸ªè¿›ç¨‹ã€‚</li>
<li>åˆ†å¸ƒå¼å¤„ç†æŠ€æœ¯ï¼šç®¡ç†å¤šå°åˆ†å¸ƒå¼è®¡ç®—æœºç³»ç»Ÿä¸­å¤šä¸ªè¿›ç¨‹çš„æ‰§è¡Œã€‚</li>
</ul>
<p>æ”¯æŒå¹¶å‘è¿›ç¨‹çš„åŸºæœ¬è¦æ±‚æ˜¯åŠ å¼º<strong>äº’æ–¥ï¼ˆMutual exclusionï¼‰</strong>çš„èƒ½åŠ›ï¼ˆå³æ’ä»–æ€§ï¼‰ï¼Œå…·ä½“è¡¨ç°ä¸ºï¼šå½“ä¸€ä¸ªè¿›ç¨‹è¢«æˆäºˆäº’æ–¥èƒ½åŠ›æ—¶ï¼Œåœ¨è¯¥è¿›ç¨‹çš„è®¿é—®å…±äº«èµ„æºï¼ˆå¦‚æ–‡ä»¶ã€I/Oè®¿é—®ï¼‰çš„æ´»åŠ¨æœŸé—´ï¼Œä¸å…è®¸å…¶å®ƒè¿›ç¨‹è®¿é—®è¯¥èµ„æºã€‚</p>
<p>ä¸ºäº†å®ç°äº’æ–¥ï¼Œæ ¹æ®ä¸Šè¿°æåˆ°çš„ä¸‰ç±»å¤šè¿›ç¨‹æŠ€æœ¯ï¼Œè¿™é‡Œä¼šä»‹ç»ä¸‰ç§å®ç°äº’æ–¥çš„æ–¹æ¡ˆï¼š<strong>ä¿¡å·é‡ï¼ˆSemaphoresï¼‰ã€ç®¡ç¨‹ï¼ˆMonitorsï¼‰ã€æ¶ˆæ¯ä¼ é€’ï¼ˆMessage Passingï¼‰</strong>ã€‚</p>
<p>åœ¨æ­£å¼ä»‹ç»æœ¬ç« å†…å®¹ä¹‹å‰å…ˆç†è§£ä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†çš„å†…å®¹ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<p>é¦–å…ˆè¦äº†è§£å¹¶å‘å¯ä»¥åœ¨ä¸‰ç§å¹³å°ä»¥ä¸‰ç§æ–¹å¼è¿›è¡Œï¼š</p>
<ul>
<li><p>ä¸‰ç§å¹³å°ï¼š</p>
<ol>
<li>åœ¨å•å¤„ç†å™¨ä¸Šï¼Œå¹¶å‘æ‰§è¡Œï¼ˆäº¤æ›¿ï¼‰ï¼›</li>
<li>åœ¨å¤šå¤„ç†å™¨å¹³å°ä¸Šï¼Œå¹¶è¡Œæ‰§è¡Œï¼›</li>
<li>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¹¶è¡Œæ‰§è¡Œã€‚</li>
</ol>
</li>
<li><p>ä¸‰ç§æ‰§è¡Œæ–¹å¼ï¼š</p>
<ol>
<li><p>å¤šä¸ªåº”ç”¨ç¨‹åºï¼Œå¹¶å‘æ‰§è¡Œï¼Œä»¥æå‡è®¡ç®—æœºç³»ç»Ÿçš„è¿è¡Œæ•ˆç‡ã€‚</p>
<blockquote>
<p>æ¯”å¦‚å¼€ç€QQéŸ³ä¹ï¼Œæµè§ˆæ–°é—»ï¼ŒåŒæ—¶å¼€ç€å¾®ä¿¡ä¸æœ‹å‹èŠå¤©ã€‚</p>
</blockquote>
</li>
<li><p>ç»“æ„åŒ–ç¨‹åºï¼šå°†ä¸€ä¸ªç¨‹åºé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œç„¶åç”¨å¤šçº¿ç¨‹çš„æ–¹å¼å¹¶å‘æ‰§è¡Œã€‚</p>
<blockquote>
<p>æ¯”å¦‚è‰²æƒ…å›¾åƒæ£€æµ‹æ¨¡å—ï¼Œæˆ‘ä»¬åˆ†ä¸ºå…³é”®å¸§æŠ½å–æ¨¡å—ï¼Œæ£€æµ‹æ¨¡å—ä¸ç”¨æˆ·å“åº”æ¨¡å—ï¼Œå°†ä¸‰ä¸ªæ¨¡å—å¹¶å‘æ‰§è¡Œå‡å°‘ç³»ç»Ÿçš„å“åº”æ—¶é—´ã€‚</p>
</blockquote>
</li>
<li><p>åœ¨æ“ä½œç³»ç»Ÿä¸­é‡‡ç”¨å¹¶å‘æ–¹å¼ï¼Œæå‡æ“ä½œç³»ç»Ÿçš„æ•ˆç‡ï¼›</p>
</li>
</ol>
</li>
</ul>
<p>æ¥ç€äº†è§£ä¸‹å’Œå¹¶å‘ç›¸å…³çš„å…³é”®æœ¯è¯­ï¼š</p>
<table>
<thead>
<tr>
<th>æœ¯è¯­</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>åŸå­æ“ä½œï¼ˆAtomic operationï¼‰</td>
<td>ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„åºåˆ—ï¼Œå¯¹å¤–æ˜¯ä¸å¯åˆ†çš„ï¼›å³æ²¡æœ‰å…¶ä»–è¿›ç¨‹å¯ä»¥çœ‹åˆ°å…¶ä¸­é—´çŠ¶æ€æˆ–è€…ä¸­æ–­æ­¤æ“ä½œï¼ˆæŒ‡ä»¤é›†åˆåœ¨æ‰§è¡Œæ—¶ä¸å…è®¸è¢«ä¸­æ–­ï¼Œè¦ä¹ˆå°±å…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå°±ä¸æ‰§è¡Œï¼‰</td>
</tr>
<tr>
<td>ä¸´ç•ŒåŒºï¼ˆCritical sectionï¼‰</td>
<td>æ˜¯ä¸€æ®µä»£ç ï¼Œåœ¨è¿™æ®µä»£ç ä¸­è¿›ç¨‹å°†è®¿é—®å…±äº«èµ„æºï¼Œå½“å¦å¤–ä¸€ä¸ªè¿›ç¨‹å·²ç»åœ¨è¿™æ®µä»£ç ä¸­è¿è¡Œæ—¶ï¼Œè¿™ä¸ªè¿›ç¨‹å°±ä¸èƒ½åœ¨è¿™æ®µä»£ç ä¸­æ‰§è¡Œ</td>
</tr>
<tr>
<td>æ­»é”ï¼ˆDeadlockï¼‰</td>
<td>ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹å› å…¶ä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…å…¶ä»–è¿›ç¨‹åšå®ŒæŸäº›äº‹æƒ…è€Œä¸èƒ½ç»§ç»­æ‰§è¡Œï¼Œè¿™æ ·çš„æƒ…å½¢å«åšæ­»é”ï¼ˆæ¯”å¦‚åªèƒ½é€šè¿‡ä¸€è¾†æ±½è½¦çš„å…¬è·¯ä¸Šï¼Œä¸¤è¾†æ±½è½¦ç›¸å‘è€Œè¡Œï¼‰</td>
</tr>
<tr>
<td>æ´»é”ï¼ˆLivelockï¼‰</td>
<td>ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šè¿›ç¨‹ä¸ºäº†å“åº”å…¶ä»–è¿›ç¨‹ä¸­çš„å˜åŒ–è€ŒæŒç»­æ”¹å˜è‡ªå·±çš„çŠ¶æ€ä½†ä¸åšæœ‰ç”¨çš„å·¥ä½œï¼Œè¿™æ ·çš„æƒ…å½¢å«åšæ´»é”ï¼ˆåŒæ ·æ˜¯ä¸¤ä¸ªå¹¶å‘çš„è¿›ç¨‹å¯èƒ½ä¼šæ­»é”ï¼Œä½†æ˜¯å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹ä¼šä¸»åŠ¨æ”¹å˜çŠ¶æ€ï¼‰</td>
</tr>
<tr>
<td>äº’æ–¥ï¼ˆMutual exclusionï¼‰</td>
<td>å½“ä¸€ä¸ªè¿›ç¨‹åœ¨ä¸´ç•ŒåŒºè®¿é—®å…±äº«èµ„æºæ—¶ï¼Œå…¶ä»–è¿›ç¨‹ä¸èƒ½è¿›å…¥è¯¥ä¸´ç•ŒåŒºè®¿é—®ä»»ä½•å…±äº«èµ„æºï¼Œè¿™ç§æƒ…å½¢å«åšäº’æ–¥ï¼ˆæ’ä»–æ€§ï¼‰</td>
</tr>
<tr>
<td>ç«äº‰æ¡ä»¶ï¼ˆRace conditionï¼‰</td>
<td>å¤šä¸ªçº¿ç¨‹æˆ–è€…è¿›ç¨‹åœ¨è¯»å†™ä¸€ä¸ªå…±äº«æ•°æ®æ—¶ï¼Œç»“æœä¾èµ–äºå®ƒä»¬æ‰§è¡Œçš„ç›¸å¯¹æ—¶é—´ï¼Œè¿™ç§æƒ…å½¢å«åšç«äº‰ï¼ˆå…±äº«èµ„æºçš„çŠ¶æ€ç”±æœ€åæ‰§è¡Œçš„è¿›ç¨‹å†³å®šçš„æƒ…å½¢ï¼‰</td>
</tr>
<tr>
<td>é¥¥é¥¿ï¼ˆStarvationï¼‰</td>
<td>æ˜¯æŒ‡ä¸€ä¸ªå¯è¿è¡Œçš„è¿›ç¨‹å°½ç®¡èƒ½ç»§ç»­æ‰§è¡Œï¼Œä½†è¢«è°ƒåº¦å™¨æ— é™æœŸåœ°å¿½è§†ï¼Œè€Œä¸èƒ½è¢«è°ƒåº¦æ‰§è¡Œçš„æƒ…å†µ</td>
</tr>
</tbody></table>
<blockquote>
<p>ä»ä¸´ç•ŒåŒºä¸­æˆ‘ä»¬åˆå¯ä»¥å¼•å‡º<strong>ä¸´ç•Œèµ„æº</strong>çš„æ¦‚å¿µï¼šä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹éœ€è¦è®¿é—®çš„ä¸€ä¸ªä¸å¯å…±äº«çš„èµ„æºã€‚</p>
</blockquote>
<h2 id="å¹¶å‘çš„åŸç†"><a href="#å¹¶å‘çš„åŸç†" class="headerlink" title="å¹¶å‘çš„åŸç†"></a>å¹¶å‘çš„åŸç†</h2><p>åœ¨æ“ä½œç³»ç»Ÿä¸­å¼•å…¥å¹¶å‘çš„<strong>æ ¹æœ¬ç›®çš„æ˜¯ä¸ºäº†æé«˜è®¡ç®—æœºçš„è¿è¡Œæ•ˆç‡</strong>ï¼Œå¹¶å‘åœ¨ä¸‰ç§ç¡¬ä»¶å¹³å°ä¸Šæœ‰ä¸¤ç§å½¢å¼ï¼š<code>Concurrencyï¼ˆå¹¶å‘ï¼‰</code>ä¸<code>Parallelï¼ˆå¹¶è¡Œï¼‰</code>,ï¼š</p>
<ul>
<li>å¹¶å‘ï¼šæŒ‡çš„æ˜¯åœ¨åŒä¸€ä¸ªæ—¶é—´æ®µå†…æœ‰å¤šä¸ªè¿›ç¨‹åœ¨CPUä¸Šäº¤æ›¿æ‰§è¡Œï¼Œå› ä¸ºè®¡ç®—æœºæ‰§è¡Œé€Ÿåº¦å¿«ï¼Œäººçš„ååº”æ…¢ï¼Œå¹¶å‘ç»™äººä¸€ç§é”™è§‰å°±æ˜¯åœ¨è¿™ä¸ªæ—¶é—´æ®µå†…å¤šä¸ªç¨‹åºåŒæ—¶è¿›è¡Œã€‚</li>
<li>å¹¶è¡Œï¼šæŒ‡çš„æ˜¯åœ¨åŒä¸€ä¸ªæ—¶åˆ»å¤šä¸ªè¿›ç¨‹åŒæ—¶åœ¨æ‰§è¡Œï¼Œè¿™ä¸ªåŒæ—¶æ‰§è¡Œå°±æ˜¯ç‰©ç†å­˜åœ¨è€Œä¸æ˜¯è™šæ‹Ÿçš„ã€‚</li>
</ul>
<p>ä¸‹é¢ä¸¤å¼ å›¾å¯ä»¥è¾ƒä¸ºç›´è§‚çš„ç†è§£å¹¶å‘çš„åŸç†ï¼š</p>
<ul>
<li><p>åœ¨å•å¤„ç†å™¨å¤šé“ç¨‹åºè®¾è®¡ç³»ç»Ÿä¸­ï¼ˆå›¾å·¦ï¼Œ<strong>å¹¶å‘</strong>ï¼‰ï¼šè¿›ç¨‹äº¤æ›¿æ‰§è¡Œï¼Œè¡¨ç°å‡ºä¸€ç§åŒæ—¶æ‰§è¡Œçš„å¤–éƒ¨ç‰¹å¾ã€‚ï¼ˆå¹¶æœªå®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶è¡Œå¤„ç†ï¼‰</p>
<blockquote>
<p>å³ä½¿ä¸èƒ½å®ç°çœŸæ­£çš„å¹¶è¡Œå¤„ç†ï¼Œå¹¶ä¸”åœ¨è¿›ç¨‹é—´æ¥å›åˆ‡æ¢ä¹Ÿéœ€è¦ä¸€å®šçš„å¼€é”€ï¼Œäº¤æ›¿æ‰§è¡Œåœ¨å¤„ç†æ•ˆç‡å’Œç¨‹åºç»“æ„ä¸Šè¿˜æ˜¯å¸¦æ¥äº†é‡è¦çš„å¥½å¤„ã€‚</p>
</blockquote>
</li>
<li><p>åœ¨å¤šå¤„ç†ç³»ç»Ÿä¸­ï¼ˆå›¾å³ï¼Œ<strong>å¹¶è¡Œ</strong>ï¼‰ï¼šè¿›ç¨‹ä¸ä»…å¯ä»¥äº¤æ›¿æ‰§è¡Œï¼Œè€Œä¸”å¯ä»¥é‡å æ‰§è¡Œã€‚ï¼ˆèƒ½å¤Ÿå®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶è¡Œå¤„ç†ï¼‰</p>
<blockquote>
<p>ä»è¡¨é¢ä¸Šçœ‹ï¼Œäº¤æ›¿å’Œé‡å ä»£è¡¨äº†å®Œå…¨ä¸åŒçš„æ‰§è¡Œæ¨¡å¼å’Œä¸åŒçš„é—®é¢˜ã€‚ä½†å®é™…ä¸Šä¸¤ç§æŠ€æœ¯éƒ½å¯ä»¥çœ‹åšæ˜¯å¹¶å‘å¤„ç†çš„ä¸€ä¸ªå®ä¾‹ï¼Œä¸”éƒ½ä»£è¡¨äº†åŒæ ·çš„é—®é¢˜ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E5%B9%B6%E8%A1%8C%E5%A4%84%E7%90%86%E8%BF%9B%E7%A8%8B.png"></p>
</li>
</ul>
<p>ç”±äºå¤šé“ç¨‹åºè®¾è®¡ç³»ç»Ÿçš„ä¸€ä¸ªåŸºæœ¬ç‰¹æ€§ï¼šè¿›ç¨‹çš„ç›¸å¯¹æ‰§è¡Œé€Ÿåº¦ä¸å¯é¢„æµ‹ã€‚ï¼ˆå®ƒå–å†³äºå…¶ä»–è¿›ç¨‹çš„æ´»åŠ¨ã€æ“ä½œç³»ç»Ÿå¤„ç†ä¸­æ–­çš„æ–¹å¼ã€æ“ä½œç³»ç»Ÿçš„è°ƒåº¦ç­–ç•¥ï¼‰ä¼šå¯¼è‡´å¹¶å‘é¢ä¸´ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>ä¸­æ–­æ€§ï¼ˆç ´åäº†è¿ç»­æ€§ï¼‰ï¼šä¸ºäº†å®ç°å¹¶å‘ï¼Œè¿›ç¨‹äº¤æ›¿æ‰§è¡Œï¼Œæ‰€ä»¥åœ¨è¿›ç¨‹å¹¶å‘æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿›ç¨‹çš„æ‰§è¡Œæ˜¯èµ°èµ°åœåœçš„ï¼›</li>
<li>å¤±å»äº†å°é—­æ€§ï¼šè®¡ç®—æœºèµ„æºåœ¨ä¸€ä¸ªæ—¶é—´æ®µå†…æ˜¯ä¸ºæ‰€æœ‰çš„è¿›ç¨‹æ‰€ç‹¬æœ‰ï¼›</li>
<li>æ‰§è¡Œçš„ä¸ä¸€è‡´æ€§ï¼šåœ¨ç›¸åŒçš„è¾“å…¥ä¸‹ï¼Œè¿›ç¨‹æ‰§è¡Œå¯èƒ½ä¼šäº§ç”Ÿä¸åŒçš„ç»“æœã€‚</li>
</ul>
<h3 id="ç®€å•æ¡ˆä¾‹åŠåˆ†æ"><a href="#ç®€å•æ¡ˆä¾‹åŠåˆ†æ" class="headerlink" title="ç®€å•æ¡ˆä¾‹åŠåˆ†æ"></a>ç®€å•æ¡ˆä¾‹åŠåˆ†æ</h3><p>ä¸ºäº†æ›´å¥½ç†è§£è¿™ç« çš„å…³é”®ï¼Œè€ƒè™‘ä¸‹é¢ä¸€ä¸ªç®€å•çš„ç¨‹åºï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">echo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	chin = getchar();</span><br><span class="line">	chout = chin;</span><br><span class="line">	<span class="built_in">putchar</span>(chout);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™ä¸ªè¿‡ç¨‹æ˜¾ç¤ºäº†å­—ç¬¦å›æ˜¾ç¨‹åºçš„åŸºæœ¬æ­¥éª¤ï¼Œæ¯å½“å‡»ä¸€ä¸‹é”®ï¼Œå°±å¯ä»é”®ç›˜è·å¾—è¾“å…¥ã€‚æ¯ä¸ªè¾“å…¥å­—ç¬¦å°±ä¿å­˜åœ¨å˜é‡chinä¸­ï¼Œç„¶åä¼ é€ç»™å˜é‡choutï¼Œå¹¶å›é€ç»™æ˜¾ç¤ºå™¨ã€‚ä»»ä½•ç¨‹åºå¯ä»¥é‡å¤åœ°è°ƒç”¨è¿™ä¸ªè¿‡ç¨‹ï¼Œæ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œå¹¶åœ¨å±å¹•ä¸Šæ˜¾ç¤ºã€‚</p>
</blockquote>
<p>å‡å®šåšä¸»æœ¬äººä½¿ç”¨çš„æ˜¯ä¸€ä¸ªæ”¯æŒå•ç”¨æˆ·çš„å•å¤„ç†å™¨å¤šé“ç¨‹åºè®¾è®¡ç³»ç»Ÿï¼Œæˆ‘è¦åŒæ—¶ä½¿ç”¨å¤šä¸ªåº”ç”¨ç¨‹åºï¼Œè€Œä¸”æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½è¦ä½¿ç”¨åŒä¸€ä¸ªé”®ç›˜è¾“å…¥ï¼ŒåŒä¸€å—æ˜¾ç¤ºå™¨è¾“å‡ºï¼Œå› æ­¤æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½éœ€è¦ä½¿ç”¨è¿™ä¸ª<code>echo()</code>å‡½æ•°ã€‚ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œæˆ‘ä¼šæŠŠè¿™ä¸ªç¨‹åºè½½å…¥åˆ°ä¸€ä¸ªæ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½å¯ä»¥è®¿é—®çš„å…¨å±€å­˜å‚¨åŒºåŸŸã€‚è¿™ç§è®¾è®¡ä¸€æ–¹é¢èŠ‚çœäº†ç©ºé—´ï¼Œå¦ä¸€æ–¹é¢å…è®¸å„ä¸ªè¿›ç¨‹é—´æœ‰æ•ˆè€Œç´§å¯†çš„äº¤äº’ã€‚ä½†æ˜¯è¿™æ ·çš„è®¾è®¡ä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œè€ƒè™‘ä»¥ä¸‹P1å’ŒP2è¿›ç¨‹çš„æ‰§è¡Œé¡ºåºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E6%A1%88%E4%BE%8B%E8%BF%87%E7%A8%8B%E4%B8%80.png"></p>
<ol>
<li>è¿›ç¨‹P1è°ƒç”¨echoè¿‡ç¨‹ï¼Œå¹¶åœ¨getcharè¿”å›å®ƒçš„å€¼ä»¥åŠå°†è¯¥å€¼å­˜å‚¨äºchinåç«‹å³è¢«ä¸­æ–­ï¼Œæ­¤æ—¶ï¼Œæœ€è¿‘è¾“å…¥çš„å­—ç¬¦xä¿å­˜åœ¨å˜é‡chinä¸­ã€‚</li>
<li>è¿›ç¨‹P2è¢«æ¿€æ´»å¹¶è°ƒç”¨echoè¿‡ç¨‹ï¼Œechoè¿‡ç¨‹è¿è¡Œå¾—å‡ºç»“æœï¼Œè¾“å…¥ï¼Œç„¶ååœ¨å±å¹•ä¸Šæ˜¾ç¤ºå•ä¸ªçš„å­—ç¬¦yã€‚</li>
<li>è¿›ç¨‹P1è¢«æ¢å¤ã€‚æ­¤æ—¶chinä¸­çš„å€¼xè¢«å†™è¦†ç›–ï¼Œå› æ­¤å·²ä¸¢å¤±ï¼Œè€Œchinä¸­çš„å€¼yè¢«ä¼ é€ç»™choutå¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚</li>
</ol>
<p>æœ€ç»ˆé€ æˆçš„ç»“æœå°±æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦xä¸¢å¤±ï¼Œç¬¬äºŒä¸ªå­—ç¬¦yè¢«æ˜¾ç¤ºäº†ä¸¤æ¬¡ã€‚</p>
<blockquote>
<p>é—®é¢˜çš„æœ¬è´¨åœ¨äºå…±äº«å…¨å±€å˜é‡chinã€‚å¤šä¸ªè¿›ç¨‹è®¿é—®è¿™ä¸ªå…¨å±€å˜é‡ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹ä¿®æ”¹äº†å®ƒï¼Œç„¶åè¢«ä¸­æ–­ï¼Œé‚£ä¹ˆå¦ä¸€ä¸ªè¿›ç¨‹å¯èƒ½åœ¨ç¬¬ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨å®ƒçš„å€¼ä¹‹å‰åˆä¿®æ”¹äº†è¿™ä¸ªå˜é‡ã€‚</p>
</blockquote>
<p>å‡è®¾åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸€æ¬¡åªå¯ä»¥æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆå‰é¢çš„é¡ºåºä¼šäº§ç”Ÿå¦‚ä¸‹ç»“æœï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E6%A1%88%E4%BE%8B%E8%BF%87%E7%A8%8B%E4%BA%8C.png"></p>
<ol>
<li>è¿›ç¨‹P1è°ƒç”¨echoè¿‡ç¨‹ï¼Œå¹¶åœ¨è¾“å…¥å‡½æ•°å–å¾—ç»“æœåç«‹å³è¢«ä¸­æ–­ï¼Œæ­¤æ—¶ï¼Œæœ€è¿‘è¾“å…¥çš„å­—ç¬¦xä¿å­˜åœ¨å˜é‡chinä¸­ã€‚</li>
<li>è¿›ç¨‹P2è¢«æ¿€æ´»å¹¶è°ƒç”¨echoè¿‡ç¨‹ã€‚ä½†æ˜¯ï¼Œç”±äºP1ä»ç„¶åœ¨echoè¿‡ç¨‹ä¸­ï¼Œå°½ç®¡å½“å‰P1å¤„äºæŒ‚èµ·çŠ¶æ€ï¼ŒP2ä»è¢«é˜»å¡ï¼Œä¸èƒ½è¿›å…¥è¿™ä¸ªè¿‡ç¨‹ã€‚å› æ­¤ï¼ŒP2è¢«æŒ‚èµ·ï¼Œç­‰å¾…echoè¿‡ç¨‹å¯ç”¨ã€‚</li>
<li>ä¸€æ®µæ—¶é—´åï¼Œè¿›ç¨‹P1è¢«æ¢å¤ï¼Œå®Œæˆechoçš„æ‰§è¡Œï¼Œå¹¶æ˜¾ç¤ºå‡ºæ­£ç¡®çš„å­—ç¬¦xã€‚</li>
<li>å½“P1é€€å‡ºechoåï¼Œè§£é™¤äº†å¯¹P2çš„é˜»å¡ï¼ŒP2è¢«æ¢å¤ï¼ŒæˆåŠŸåœ°è°ƒç”¨echoè¿‡ç¨‹ã€‚</li>
</ol>
<p>è¿™æ ·çš„è¾“å‡ºç»“æœæ˜¯æˆ‘ä»¬æ‰€å¸Œæœ›çš„ã€‚</p>
<p>ä¸Šè¿°è¿™ä¸ªç®€å•çš„æ¡ˆä¾‹è¯´æ˜ï¼Œå¦‚æœéœ€è¦ä¿æŠ¤å…±äº«çš„å…¨å±€å˜é‡ï¼ˆä»¥åŠå…¶ä»–å…±äº«çš„å…¨å±€èµ„æºï¼‰ï¼Œå”¯ä¸€çš„åŠæ³•æ˜¯æ§åˆ¶è®¿é—®è¯¥å˜é‡çš„ä»£ç ã€‚å¦‚æœæˆ‘ä»¬å®šä¹‰äº†ä¸€æ¡è§„åˆ™ï¼Œä¸€æ¬¡åªå…è®¸ä¸€ä¸ªè¿›ç¨‹è¿›å…¥echoï¼Œå¹¶ä¸”åªæœ‰åœ¨echoè¿‡ç¨‹è¿è¡Œç»“æŸåå®ƒæ‰å¯¹å¦ä¸€ä¸ªè¿›ç¨‹æ˜¯å¯ç”¨çš„ï¼Œé‚£ä¹ˆåˆšæ‰è®¨è®ºçš„é‚£ç±»é”™è¯¯å°±ä¸ä¼šå‘ç”Ÿäº†ã€‚</p>
<p>å¦‚ä½•å®æ–½æ­¤è§„åˆ™æ˜¯æœ¬ç« çš„é‡è¦å†…å®¹ï¼ï¼ï¼ï¼</p>
<blockquote>
<p>ä¸Šè¿°æˆ‘ä»¬è®¨è®ºçš„æƒ…å†µæ˜¯åœ¨å•å¤„ç†å™¨å¤šé“ç¨‹åºè®¾è®¡ç³»ç»Ÿä¸­ï¼Œä½†å…¶å®åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼ŒåŒæ ·ä¹Ÿå­˜åœ¨ä¿æŠ¤å…±äº«èµ„æºçš„é—®é¢˜ï¼Œå…¶è§£å†³æ–¹æ³•ä¹Ÿæ˜¯ç›¸åŒçš„ï¼š<strong>æ§åˆ¶å¯¹å…±äº«èµ„æºçš„è®¿é—®</strong>ã€‚</p>
</blockquote>
<h3 id="ç«äº‰æ¡ä»¶"><a href="#ç«äº‰æ¡ä»¶" class="headerlink" title="ç«äº‰æ¡ä»¶"></a>ç«äº‰æ¡ä»¶</h3><p>ç«äº‰æ¡ä»¶å‘ç”Ÿåœ¨å¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹è¯»å†™æ•°æ®æ—¶ï¼Œå…¶æœ€ç»ˆçš„ç»“æœä¾èµ–äºå¤šä¸ªè¿›ç¨‹çš„<strong>æŒ‡ä»¤æ‰§è¡Œé¡ºåº</strong>ã€‚</p>
<blockquote>
<p>è€ƒè™‘ä¸‹é¢ä¸¤ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<ul>
<li><p>æ¡ˆä¾‹ä¸€ï¼š</p>
<p>å‡è®¾ä¸¤ä¸ªè¿›ç¨‹P1å’ŒP2å…±äº«å…¨å±€å˜é‡aã€‚åœ¨æŸä¸€æ‰§è¡Œæ—¶åˆ»ï¼ŒP1æ›´æ–°aä¸º1ï¼Œåœ¨æ‰§è¡Œçš„å¦å¤–æŸä¸€æ—¶åˆ»ï¼ŒP2æ›´æ–°aä¸º2ã€‚å› æ­¤ï¼Œä¸¤ä¸ªä»»åŠ¡ç«äº‰æ›´æ–°å˜é‡aã€‚</p>
<p>ï¼ˆåœ¨æœ¬ä¾‹ä¸­ï¼Œç«äº‰çš„â€œå¤±è´¥è€…â€ï¼ˆä¹Ÿå°±æ˜¯æœ€åæ›´æ–°å…¨å±€å˜é‡açš„è¿›ç¨‹ï¼‰å†³å®šäº†å˜é‡açš„æœ€ç»ˆå€¼ã€‚ï¼‰</p>
</li>
<li><p>æ¡ˆä¾‹äºŒï¼š</p>
<p>è€ƒè™‘ä¸¤ä¸ªè¿›ç¨‹P3å’ŒP4å…±äº«å…¨å±€å˜é‡bå’Œcï¼Œå¹¶ä¸”åˆå§‹å€¼b=1ï¼Œc=2ã€‚åœ¨æŸä¸€æ‰§è¡Œæ—¶åˆ»ï¼ŒP3æ‰§è¡Œèµ‹å€¼è¯­å¥b=b+cï¼Œåœ¨å¦ä¸€æ‰§è¡Œæ—¶åˆ»ï¼ŒP4æ‰§è¡Œèµ‹å€¼è¯­å¥ c=b+cã€‚ä¸¤ä¸ªè¿›ç¨‹æ›´æ–°ä¸åŒçš„å˜é‡ï¼Œä½†ä¸¤ä¸ªå˜é‡çš„æœ€ç»ˆå€¼ä¾èµ–äºä¸¤ä¸ªè¿›ç¨‹æ‰§è¡Œèµ‹å€¼è¯­å¥çš„é¡ºåºã€‚å¦‚æœP3é¦–å…ˆæ‰§è¡Œèµ‹å€¼è¯­å¥ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„å€¼ä¸ºb=3ï¼Œc=5ã€‚å¦‚æœP4é¦–å…ˆæ‰§è¡Œèµ‹å€¼è¯­å¥ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„å€¼ä¸ºb=4ï¼Œc=3ã€‚</p>
</li>
</ul>
</blockquote>
<h3 id="æ“ä½œç³»ç»Ÿå…³æ³¨çš„é—®é¢˜"><a href="#æ“ä½œç³»ç»Ÿå…³æ³¨çš„é—®é¢˜" class="headerlink" title="æ“ä½œç³»ç»Ÿå…³æ³¨çš„é—®é¢˜"></a>æ“ä½œç³»ç»Ÿå…³æ³¨çš„é—®é¢˜</h3><p>å¹¶å‘ä¼šå¸¦æ¥å¦‚ä¸‹è®¾è®¡å’Œç®¡ç†é—®é¢˜ï¼š</p>
<ol>
<li><p>æ“ä½œç³»ç»Ÿéœ€è¦è¿›ç¨‹æ§åˆ¶å—ï¼ˆPCBï¼‰æ¥è®°ä½å„ä¸ªæ´»è·ƒçš„è¿›ç¨‹ã€‚</p>
</li>
<li><p>æ“ä½œç³»ç»Ÿå¿…é¡»ä¸ºæ¯ä¸ªæ´»è·ƒè¿›ç¨‹åˆ†é…å’Œé‡Šæ”¾å„ç§èµ„æºï¼ˆå› ä¸ºè¿›ç¨‹æ˜¯èµ„æºçš„åˆ†é…å•ä½ï¼‰ï¼Œè¿™äº›èµ„æºåŒ…æ‹¬ï¼š</p>
<ul>
<li>å¤„ç†å™¨æ—¶é—´ï¼šè¿™æ˜¯è°ƒåº¦åŠŸèƒ½ã€‚</li>
<li>å­˜å‚¨å™¨ï¼šå¤§å¤šæ•°æ“ä½œç³»ç»Ÿä½¿ç”¨è™šæ‹Ÿå­˜å‚¨æ–¹æ¡ˆã€‚</li>
<li>æ–‡ä»¶</li>
<li>I/Oè®¾å¤‡</li>
</ul>
</li>
<li><p>æ“ä½œç³»ç»Ÿå¿…é¡»ä¿æŠ¤æ¯ä¸ªè¿›ç¨‹çš„æ•°æ®å’Œç‰©ç†èµ„æºï¼Œé¿å…å…¶ä»–è¿›ç¨‹çš„æ— æ„å¹²æ¶‰ã€‚</p>
</li>
<li><p>ä¸€ä¸ªè¿›ç¨‹çš„åŠŸèƒ½å’Œè¾“å‡ºç»“æœå¿…é¡»ä¸æ‰§è¡Œé€Ÿåº¦ï¼ˆç›¸å¯¹äºå…¶ä»–å¹¶å‘è¿›ç¨‹çš„æ‰§è¡Œé€Ÿåº¦ï¼‰æ— å…³ã€‚ã€æœ¬ç« å…³é”®å°±æ˜¯ä»‹ç»å¦‚ä½•å®ç°è¿™ä¸€ç‚¹ã€‘</p>
<blockquote>
<p>å…³äºå¦‚ä½•å®ç°ä¸Šè¿°ç¬¬å››ç‚¹ï¼Œè¿™é‡Œç»™å‡ºä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>å–æ¶ˆå…±äº«èµ„æºï¼šæ¯ä¸ªè¿›ç¨‹å’Œæ¯ä¸ªçº¿ç¨‹æ‰€ç”¨åˆ°çš„èµ„æºéƒ½æ˜¯ç‹¬äº«çš„ï¼Œè¿™ç§æ–¹æ³•èƒ½å¤Ÿè§£å†³å‰é¢çš„é—®é¢˜ï¼Œä½†æ˜¯å’Œæ“ä½œç³»ç»Ÿçš„è®¾è®¡ç›®æ ‡ä¸ç¬¦åˆï¼ˆæ“ä½œç³»ç»Ÿæ˜¯èµ„æºçš„ç®¡ç†è€…ï¼Œè¦è®©è®¡ç®—æœºç³»ç»Ÿä¸­çš„èµ„æºå¾—åˆ°å……åˆ†ä½¿ç”¨ï¼‰</li>
<li>è®©è¿›ç¨‹å’Œçº¿ç¨‹çš„æ‰§è¡Œé¡ºåºæ»¡è¶³ä¸€å®šçš„æ¡ä»¶ï¼ˆåŒæ­¥å’Œäº’æ–¥ï¼Œæ ¸å¿ƒæ¦‚å¿µæ˜¯äº’æ–¥ï¼‰</li>
</ul>
</blockquote>
</li>
</ol>
<h3 id="è¿›ç¨‹çš„äº¤äº’"><a href="#è¿›ç¨‹çš„äº¤äº’" class="headerlink" title="è¿›ç¨‹çš„äº¤äº’"></a>è¿›ç¨‹çš„äº¤äº’</h3><p>æ ¹æ®è¿›ç¨‹ç›¸äº’é—´æ˜¯å¦æŒ‡å¯¼å¯¹æ–¹å­˜åœ¨çš„ç¨‹åº¦ï¼Œå¯¹è¿›ç¨‹é—´çš„äº¤äº’æ–¹å¼è¿›è¡Œå¦‚ä¸‹ä¸‰ç§åˆ†ç±»ï¼š</p>
<ul>
<li><p>è¿›ç¨‹ä¹‹é—´ç›¸äº’ä¸çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨</p>
<p>è¿™æ˜¯ä¸€äº›ç‹¬ç«‹çš„è¿›ç¨‹ï¼Œå®ƒä»¬ä¸ä¼šä¸€èµ·å·¥ä½œã€‚å…³äºè¿™ç§æƒ…å†µçš„æœ€å¥½ä¾‹å­æ˜¯å¤šä¸ªç‹¬ç«‹è¿›ç¨‹çš„å¤šé“ç¨‹åºè®¾è®¡ï¼Œå¯ä»¥æ˜¯æ‰¹å¤„ç†ä½œä¸šï¼Œä¹Ÿå¯ä»¥æ˜¯äº¤äº’å¼çš„ä¼šè¯ï¼Œæˆ–è€…æ˜¯ä¸¤è€…çš„æ··åˆã€‚å°½ç®¡è¿™äº›è¿›ç¨‹ä¸ä¼šä¸€èµ·å·¥ä½œï¼Œä½†æ“ä½œç³»ç»Ÿéœ€è¦çŸ¥é“å®ƒä»¬å¯¹èµ„æºçš„ç«äº‰æƒ…å†µã€‚ï¼ˆä¾‹å¦‚ï¼Œä¸¤ä¸ªæ— å…³çš„åº”ç”¨ç¨‹åºå¯èƒ½éƒ½æƒ³è®¿é—®åŒä¸€ä¸ªç£ç›˜ã€æ–‡ä»¶æˆ–æ‰“å°æœºï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»æ§åˆ¶è¿™æ ·çš„è®¿é—®ï¼‰</p>
</li>
<li><p>è¿›ç¨‹é—´æ¥çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨</p>
<p>è¿™äº›è¿›ç¨‹å¹¶ä¸éœ€è¦çŸ¥é“å¯¹æ–¹çš„è¿›ç¨‹IDï¼Œä½†å®ƒä»¬å…±äº«æŸäº›å¯¹è±¡ï¼Œå¦‚ä¸€ä¸ªI/Oç¼“å†²åŒºã€‚è¿™ç±»è¿›ç¨‹åœ¨å…±äº«åŒä¸€ä¸ªå¯¹è±¡æ—¶è¡¨ç°å‡ºåˆä½œè¡Œä¸ºã€‚</p>
</li>
<li><p>è¿›ç¨‹ç›´æ¥çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨</p>
<p>è¿™äº›è¿›ç¨‹å¯ä»¥é€šè¿‡è¿›ç¨‹IDäº’ç›¸é€šä¿¡ï¼Œç”¨äºåˆä½œå®ŒæˆæŸäº›æ´»åŠ¨ã€‚åŒæ ·ï¼Œè¿™ç±»è¿›ç¨‹è¡¨ç°å‡ºåˆä½œè¡Œä¸ºã€‚</p>
</li>
</ul>
<p>ä¸‹é¢çš„è¡¨æ ¼æ›´ä¸ºè¯¦ç»†åœ°è¯´æ˜äº†è¿›ç¨‹é—´çš„ä¸‰ç§äº¤äº’æ–¹å¼ï¼š</p>
<table>
<thead>
<tr>
<th>çŸ¥æ™“ç¨‹åº¦</th>
<th>å…³ç³»</th>
<th>ä¸€ä¸ªè¿›ç¨‹å¯¹å…¶ä»–è¿›ç¨‹çš„å½±å“</th>
<th>æ½œåœ¨çš„æ§åˆ¶é—®é¢˜</th>
</tr>
</thead>
<tbody><tr>
<td>è¿›ç¨‹ä¹‹é—´ç›¸äº’ä¸çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨</td>
<td>ç«äº‰</td>
<td>Â·ä¸€ä¸ªè¿›ç¨‹çš„ç»“æœä¸å…¶ä»–è¿›ç¨‹çš„æ´»åŠ¨æ— å…³<br/>Â·è¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´å¯èƒ½ä¼šå—åˆ°å½±å“</td>
<td>Â·äº’æ–¥<br/>Â·æ­»é”ï¼ˆå¯å¤ç”¨çš„èµ„æºï¼‰<br/>Â·é¥¥é¥¿</td>
</tr>
<tr>
<td>è¿›ç¨‹é—´æ¥çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼ˆå¦‚å…±äº«å¯¹è±¡ï¼‰</td>
<td>é€šè¿‡å…±äº«åˆä½œ</td>
<td>Â·ä¸€ä¸ªè¿›ç¨‹çš„ç»“æœå¯èƒ½ä¾èµ–äºä»å…¶ä»–è¿›ç¨‹è·å¾—çš„ä¿¡æ¯<br/>Â·è¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´å¯èƒ½ä¼šå—åˆ°å½±å“</td>
<td>Â·äº’æ–¥<br/>Â·æ­»é”ï¼ˆå¯å¤ç”¨çš„èµ„æºï¼‰<br/>Â·é¥¥é¥¿<br/>Â·æ•°æ®ä¸€è‡´æ€§</td>
</tr>
<tr>
<td>è¿›ç¨‹ç›´æ¥çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼ˆå®ƒä»¬æœ‰å¯ç”¨çš„é€šä¿¡åŸè¯­ï¼‰</td>
<td>é€šè¿‡é€šä¿¡åˆä½œ</td>
<td>Â·ä¸€ä¸ªè¿›ç¨‹çš„ç»“æœå¯èƒ½ä¾èµ–äºä»å…¶ä»–è¿›ç¨‹è·å¾—çš„ä¿¡æ¯<br/>Â·è¿›ç¨‹çš„è®¡æ—¶å¯èƒ½ä¼šå—åˆ°å½±å“</td>
<td>Â·æ­»é”ï¼ˆå¯æ¶ˆè´¹çš„èµ„æºï¼‰<br/>Â·é¥¥é¥¿</td>
</tr>
</tbody></table>
<blockquote>
<p>å¯¹ä¸Šè¿°è¡¨æ ¼ä¸­ä¸åŒå…³ç³»å­˜åœ¨çš„æ§åˆ¶é—®é¢˜åšä¸€ä¸ªè¯¦ç»†è¡¥å……ï¼š</p>
<ul>
<li>è¿›ç¨‹ä¹‹é—´ç›¸äº’ä¸çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼š<ul>
<li>äº’æ–¥ï¼šè™½ç„¶è¿›ç¨‹äº’ä¸çŸ¥é“ï¼Œä½†æ˜¯ç”±äºåœ¨åŒä¸€ä¸ªè®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå¯¹äºä¸´ç•Œèµ„æºéœ€è¦äº’æ–¥è®¿é—®ï¼›</li>
<li>æ­»é”ï¼šäº’æ–¥çš„è¿›ç¨‹ç›¸äº’ç«äº‰èµ„æºï¼Œå¯¼è‡´æ‰€éœ€çš„èµ„æºæ— æ³•æœ‰æ•ˆé‡Šæ”¾ï¼›</li>
<li>é¥¥é¥¿ï¼šè¿›ç¨‹å…·å¤‡æ‰§è¡Œæ¡ä»¶ï¼Œä½†æ˜¯ç”±äºå¾—ä¸åˆ°èµ„æºæ— æ³•æ‰§è¡Œï¼ˆä½ä¼˜å…ˆçº§çš„è¿›ç¨‹åœ¨æ‰§è¡Œæ—¶ï¼Œå‰é¢è€æœ‰é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹ã€‚ï¼‰</li>
</ul>
</li>
<li>è¿›ç¨‹é—´æ¥çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼š<ul>
<li>å› ä¸ºè¿›ç¨‹é—´å­˜åœ¨å…±äº«èµ„æºçš„å…³ç³»ï¼Œæ‰€ä»¥â€œäº’ä¸çŸ¥é“å…³ç³»â€çš„ä¸‰ä¸ªé—®é¢˜å®ƒéƒ½å…·æœ‰ï¼›</li>
<li>åŒæ—¶å®ƒè¿˜å¤šäº†ä¸€ä¸ªæ•°æ®çš„ä¸ä¸€è‡´æ€§é—®é¢˜ï¼ˆæ¡ä»¶ç«äº‰ï¼‰</li>
</ul>
</li>
<li>è¿›ç¨‹ç›´æ¥çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼š<ul>
<li>æ­»é”ï¼šé”™è¯¯çš„åŒæ­¥ï¼Œå¯¼è‡´ä¸¤ä¸ªè¿›ç¨‹åŒæ—¶ç­‰å¾…å¯¹æ–¹å‘æ¶ˆæ¯ï¼›</li>
<li>é¥¥é¥¿ï¼šå¤šä¸ªå¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹ï¼ŒæŸä¸€ä¸ªè¿›ç¨‹å§‹ç»ˆæ²¡æœ‰å¾—åˆ°è®©ä»–å¯åŠ¨çš„æ¶ˆæ¯ã€‚</li>
</ul>
</li>
</ul>
<p>å®é™…æ¡ä»¶å¹¶ä¸æ€»æ˜¯åƒä¸Šè¡¨ä¸­ç»™å‡ºçš„é‚£ä¹ˆæ¸…æ™°ï¼Œå‡ ä¸ªè¿›ç¨‹å¯èƒ½æ—¢è¡¨ç°å‡ºç«äº‰ï¼Œåˆè¡¨ç°å‡ºåˆä½œã€‚ç„¶è€Œï¼Œå¯¹æ“ä½œç³»ç»Ÿè€Œè¨€ï¼Œåˆ†åˆ«æ£€æŸ¥è¡¨ä¸­çš„æ¯ä¸€é¡¹å¹¶ç¡®å®šå®ƒä»¬çš„æœ¬è´¨æ˜¯å¿…è¦çš„ã€‚</p>
</blockquote>
<h4 id="è¿›ç¨‹é—´çš„èµ„æºç«äº‰"><a href="#è¿›ç¨‹é—´çš„èµ„æºç«äº‰" class="headerlink" title="è¿›ç¨‹é—´çš„èµ„æºç«äº‰"></a>è¿›ç¨‹é—´çš„èµ„æºç«äº‰</h4><p>å½“å¹¶å‘è¿›ç¨‹ç«äº‰ä½¿ç”¨åŒä¸€èµ„æºæ—¶ï¼Œå®ƒä»¬ä¹‹é—´å°±ä¼šå‘ç”Ÿå†²çªã€‚ï¼ˆè¿™ç±»èµ„æºåŒ…æ‹¬I/Oè®¾å¤‡ã€å­˜å‚¨å™¨ã€å¤„ç†å™¨æ—¶é—´å’Œæ—¶é’Ÿï¼‰</p>
<p>ç«äº‰è¿›ç¨‹é¢ä¸´ä»¥ä¸‹ä¸‰ä¸ªæ§åˆ¶é—®é¢˜ï¼š</p>
<ul>
<li><p>äº’æ–¥ï¼š</p>
<p>ä¸€æ¬¡åªå…è®¸æœ‰ä¸€ä¸ªç¨‹åºåœ¨ä¸´ç•ŒåŒºä¸­ã€‚ï¼ˆä¾‹å¦‚ï¼Œæ¯æ¬¡åªå…è®¸ä¸€ä¸ªè¿›ç¨‹å‘æ‰“å°æœºå‘é€å‘½ä»¤ï¼‰</p>
</li>
<li><p>æ­»é”ï¼š</p>
<p>è€ƒè™‘ä¸¤ä¸ªè¿›ç¨‹P1å’ŒP2ï¼Œä»¥åŠä¸¤ä¸ªèµ„æºR1å’ŒR2ã€‚å‡è®¾æ¯ä¸ªè¿›ç¨‹ä¸ºæ‰§è¡Œéƒ¨åˆ†åŠŸèƒ½éƒ½éœ€è¦è®¿é—®è¿™ä¸¤ä¸ªèµ„æºï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å‡ºç°ä¸‹åˆ—æƒ…å†µï¼šæ“ä½œç³»ç»ŸæŠŠR1åˆ†é…ç»™P2ï¼ŒæŠŠR2åˆ†é…ç»™P1ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…å¦ä¸€ä¸ªèµ„æºï¼Œä¸”åœ¨è·å¾—å…¶ä»–èµ„æºå¹¶å®ŒæˆåŠŸèƒ½å‰ï¼Œè°éƒ½ä¸ä¼šé‡Šæ”¾è‡ªå·±å·²ç»æ‹¥æœ‰çš„èµ„æºã€‚è¿™ä¸¤ä¸ªè¿›ç¨‹å‘ç”Ÿæ­»é”ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E7%AB%9E%E4%BA%89.png"></p>
</li>
<li><p>é¥¥é¥¿ï¼š</p>
<p>å‡è®¾æœ‰ä¸‰ä¸ªè¿›ç¨‹ï¼ˆP1ã€P2å’ŒP3ï¼‰ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½å‘¨æœŸæ€§åœ°è®¿é—®èµ„æºRã€‚è€ƒè™‘è¿™ç§æƒ…å†µï¼ŒP1æ‹¥æœ‰èµ„æºï¼ŒP2å’ŒP3éƒ½è¢«å»¶è¿Ÿï¼Œç­‰å¾…è¿™ä¸ªèµ„æºã€‚å½“P1é€€å‡ºå®ƒçš„ä¸´ç•ŒåŒºæ—¶ï¼ŒP2å’ŒP3éƒ½è¢«å…è®¸è®¿é—®Rã€‚å‡è®¾æ“ä½œç³»ç»ŸæŠŠè®¿é—®æƒæˆäºˆP3ï¼Œå¹¶ä¸”åœ¨P3å®Œæˆä¸´ç•ŒåŒºä¹‹å‰P1åˆéœ€è¦è®¿é—®è¯¥ä¸´ç•ŒåŒºã€‚å¦‚æœåœ¨P3ç»“æŸåæ“ä½œç³»ç»ŸåˆæŠŠè®¿é—®æƒæˆäºˆP1ï¼Œå¹¶ä¸”æ¥ä¸‹æ¥æŠŠè®¿é—®æƒè½®æµæˆäºˆP1å’ŒP3ï¼Œé‚£ä¹ˆå³ä½¿æ²¡æœ‰æ­»é”ï¼ŒP2ä¹Ÿå¯èƒ½è¢«æ— é™æœŸåœ°æ‹’ç»è®¿é—®èµ„æºã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E9%A5%A5%E9%A5%BF.png"></p>
</li>
</ul>
<blockquote>
<p>ä¸‹å›¾ç”¨æŠ½è±¡æœ¯è¯­ç»™å‡ºäº†äº’æ–¥æœºåˆ¶ã€‚å‡è®¾æœ‰nä¸ªè¿›ç¨‹å¹¶å‘æ‰§è¡Œï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½åŒ…æ‹¬äº†åœ¨æŸèµ„æºRaä¸Šæ“ä½œçš„ä¸´ç•ŒåŒºä»¥åŠä¸æ¶‰åŠèµ„æºRaçš„æ›¿å®ƒä»£ç ã€‚å› ä¸ºæ‰€æœ‰çš„è¿›ç¨‹éƒ½éœ€è¦è®¿é—®åŒä¸€ä¸ªèµ„æºRaï¼Œå› æ­¤åœ¨æŸä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨ä¸´ç•ŒåŒºæ˜¯å¾ˆé‡è¦çš„ã€‚</p>
<p>ä¸ºå®æ–½äº’æ–¥ï¼Œéœ€è¦ä¸¤ä¸ªå‡½æ•°ï¼š<code>entercritical</code>å’Œ<code>exitcritical</code>ã€‚æ¯ä¸ªå‡½æ•°çš„å‚æ•°éƒ½æ˜¯ç«äº‰ä½¿ç”¨çš„èµ„æºåã€‚å¦‚æœä¸€ä¸ªè¿›ç¨‹åœ¨å®ƒçš„ä¸´ç•ŒåŒºä¸­ï¼Œé‚£ä¹ˆå…¶ä»–ä»»ä½•è¯•å›¾è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹éƒ½å¿…é¡»ç­‰å¾…ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E7%AB%9E%E4%BA%892.png"></p>
</blockquote>
<h4 id="è¿›ç¨‹é—´é€šè¿‡å…±äº«åˆä½œ"><a href="#è¿›ç¨‹é—´é€šè¿‡å…±äº«åˆä½œ" class="headerlink" title="è¿›ç¨‹é—´é€šè¿‡å…±äº«åˆä½œ"></a>è¿›ç¨‹é—´é€šè¿‡å…±äº«åˆä½œ</h4><p>é€šè¿‡å…±äº«è¿›è¡Œåˆä½œçš„æƒ…å†µï¼ŒåŒ…æ‹¬è¿›ç¨‹é—´åœ¨äº’ç›¸å¹¶ä¸ç¡®åˆ‡çŸ¥é“å¯¹æ–¹çš„æƒ…å†µä¸‹è¿›è¡Œäº¤äº’ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¤šä¸ªè¿›ç¨‹å¯èƒ½è®¿é—®ä¸€ä¸ªå…±äº«å˜é‡ã€å…±äº«æ–‡ä»¶æˆ–æ•°æ®åº“ï¼Œè¿›ç¨‹å¯èƒ½ä½¿ç”¨å¹¶ä¿®æ”¹å…±äº«å˜é‡è€Œä¸æ¶‰åŠå…¶ä»–è¿›ç¨‹ï¼Œä½†å´çŸ¥é“å…¶ä»–è¿›ç¨‹ä¹Ÿå¯èƒ½è®¿é—®åŒä¸€ä¸ªæ•°æ®ã€‚å› æ­¤ï¼Œè¿™äº›è¿›ç¨‹å¿…é¡»åˆä½œï¼Œä»¥ç¡®ä¿å®ƒä»¬å…±äº«çš„æ•°æ®å¾—åˆ°æ­£ç¡®çš„ç®¡ç†ã€‚æ§åˆ¶æœºåˆ¶å¿…é¡»å¿…é¡»ç¡®ä¿å…±äº«æ•°æ®çš„å®Œæ•´æ€§ã€‚</p>
<h4 id="è¿›ç¨‹é—´é€šè¿‡é€šä¿¡åˆä½œ"><a href="#è¿›ç¨‹é—´é€šè¿‡é€šä¿¡åˆä½œ" class="headerlink" title="è¿›ç¨‹é—´é€šè¿‡é€šä¿¡åˆä½œ"></a>è¿›ç¨‹é—´é€šè¿‡é€šä¿¡åˆä½œ</h4><p>å½“è¿›ç¨‹é€šè¿‡é€šä¿¡è¿›è¡Œåˆä½œæ—¶ï¼Œå„ä¸ªè¿›ç¨‹éƒ½ä¸å…¶ä»–è¿›ç¨‹è¿›è¡Œè¿æ¥ï¼Œé€šä¿¡æä¾›äº†åŒæ­¥å’Œåè°ƒå„ç§æ´»åŠ¨çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>åœ¨å…¸å‹æƒ…å†µä¸‹ï¼Œé€šä¿¡å¯ç”±å„ç§ç±»å‹çš„æ¶ˆæ¯ç»„æˆï¼Œå‘é€æ¶ˆæ¯å’Œæ¥æ”¶æ¶ˆæ¯çš„åŸè¯­ç”±ç¨‹åºè®¾è®¡è¯­è¨€æä¾›ï¼Œæˆ–è€…ç”±æ“ä½œç³»ç»Ÿçš„å†…æ ¸æä¾›ã€‚</p>
<p>ç”±äºåœ¨ä¼ é€’æ¶ˆæ¯çš„è¿‡ç¨‹ä¸­è¿›ç¨‹é—´æ²¡æœ‰å…±äº«ä»»ä½•å¯¹è±¡ï¼Œå› è€Œè¿™ç±»åˆä½œä¸éœ€è¦äº’æ–¥ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨æ­»é”å’Œé¥¥é¥¿çš„é—®é¢˜ã€‚</p>
</blockquote>
<h3 id="äº’æ–¥çš„è¦æ±‚"><a href="#äº’æ–¥çš„è¦æ±‚" class="headerlink" title="äº’æ–¥çš„è¦æ±‚"></a>äº’æ–¥çš„è¦æ±‚</h3><p>ä¸ºäº†æä¾›å¯¹äº’æ–¥çš„æ”¯æŒï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼ˆåå…­å­—ç®€è®°ï¼‰ï¼š</p>
<ul>
<li><p>ç©ºé—²è®©è¿›ï¼šå¦‚æœæ²¡æœ‰è¿›ç¨‹è®¿é—®ä¸´ç•Œèµ„æºï¼Œå¦‚æœæ²¡æœ‰è¿›ç¨‹è®¿é—®ï¼Œå¯ä»¥å…è®¸è®¿é—®ï¼›</p>
</li>
<li><p>å¿™åˆ™ç­‰å¾…ï¼šå¦‚æœæœ‰è¿›ç¨‹è®¿é—®ï¼Œåˆ™ç”³è¯·è®¿èµ„æºçš„è¿›ç¨‹ä¿æŒç­‰å¾…ï¼›</p>
</li>
<li><p>æœ‰é™ç­‰å¾…ï¼šå¯¹äºç”³è¯·è®¿é—®ä¸´ç•Œèµ„æºçš„è¿›ç¨‹ï¼Œåº”è¯¥åœ¨æœ‰é™çš„æ—¶é—´å†…å®ç°å¯¹ä¸´ç•Œèµ„æºçš„è®¿é—®ï¼Œé¿å…æ­»é”å’Œé¥¥é¥¿çš„å‘ç”Ÿï¼›</p>
</li>
<li><p>è®©æƒç­‰å¾…ï¼šç”³è¯·ä¸´ç•Œèµ„æºçš„è¿›ç¨‹å¦‚æœä¸èƒ½é©¬ä¸Šè®¿é—®ä¸´ç•Œèµ„æºï¼Œåº”è¯¥ç«‹å³é‡Šæ”¾CPUçš„ä½¿ç”¨æƒç»™å…¶ä»–è¿›ç¨‹ã€‚</p>
<blockquote>
<p>èƒ½è¿‡æ»¡è¶³ä»¥ä¸Šäº’æ–¥è¦æ±‚çš„æ–¹æ³•ä¸»è¦æœ‰ä¸‰ç±»ï¼š</p>
<ul>
<li><p>æ–¹æ³•ä¸€ï¼šè®©ç”±å¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹æ‹…è´Ÿè¿™ä¸ªè´£ä»»ã€‚ï¼ˆè½¯ä»¶æ–¹æ³•ï¼‰</p>
<p>è¿™ç±»è¿›ç¨‹ï¼Œä¸è®ºæ˜¯ç³»ç»Ÿç¨‹åºè¿˜æ˜¯åº”ç”¨ç¨‹åºï¼Œéƒ½éœ€è¦ä¸å¦ä¸€ä¸ªè¿›ç¨‹åˆä½œï¼Œè€Œä¸éœ€è¦ç¨‹åºè®¾è®¡è¯­è¨€æˆ–æ“ä½œç³»ç»Ÿæä¾›ä»»ä½•æ”¯æŒæ¥å®æ–½äº’æ–¥ã€‚ï¼ˆè¯¥æ–¹æ³•å·²è¢«è¯æ˜ä¼šå¢åŠ å¼€é”€å’Œç¼ºé™·ï¼‰</p>
</li>
<li><p>æ–¹æ³•äºŒï¼šä¸“ç”¨çš„æœºå™¨æŒ‡ä»¤ï¼Œä¿è¯åŸå­æ“ä½œå®ç°äº’æ–¥ã€‚ï¼ˆç¡¬ä»¶æ–¹æ³•ï¼‰</p>
<p>è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å‡å°‘å¼€é”€ï¼Œä½†å´å¾ˆéš¾æˆä¸ºä¸€ç§é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚</p>
</li>
<li><p>æ–¹æ³•ä¸‰ï¼šç”±æ“ä½œç³»ç»Ÿæˆ–ç¼–è¯‘å™¨æä¾›å·¥å…·æˆ–æ–¹æ³•å®ç°ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼šä¿¡å·é‡ï¼Œç®¡ç¨‹å’Œæ¶ˆæ¯ã€‚</p>
</li>
</ul>
</blockquote>
</li>
</ul>
<h2 id="äº’æ–¥ï¼šç¡¬ä»¶çš„æ”¯æŒ"><a href="#äº’æ–¥ï¼šç¡¬ä»¶çš„æ”¯æŒ" class="headerlink" title="äº’æ–¥ï¼šç¡¬ä»¶çš„æ”¯æŒ"></a>äº’æ–¥ï¼šç¡¬ä»¶çš„æ”¯æŒ</h2><p>è®¸å¤šå¢å¼ºäº’æ–¥çš„è½¯ä»¶ç®—æ³•å·²ç»å¼€å‘å‡ºæ¥äº†ã€‚è½¯ä»¶æ–¹æ³•ä¼šå¸¦æ¥é«˜å¼€é”€å¹¶ä¸”å¾ˆå®¹æ˜“äº§ç”Ÿé€»è¾‘é”™è¯¯ã€‚è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬æ¥è®¨è®ºæä¾›äº’æ–¥çš„ç¡¬ä»¶æ”¯æŒã€‚</p>
<h3 id="ä¸­æ–­ç¦ç”¨"><a href="#ä¸­æ–­ç¦ç”¨" class="headerlink" title="ä¸­æ–­ç¦ç”¨"></a>ä¸­æ–­ç¦ç”¨</h3><p>å‰æ–‡ä»‹ç»è¿‡ï¼Œåœ¨å•å¤„ç†æœºå™¨ä¸­ï¼Œå¹¶å‘è¿›ç¨‹ä¸èƒ½é‡å ï¼Œåªèƒ½äº¤æ›¿ã€‚ä¸€ä¸ªè¿›ç¨‹ç›´åˆ°å®ƒè°ƒç”¨äº†ä¸€ä¸ªæ“ä½œç³»ç»ŸæœåŠ¡æˆ–è€…è¢«ä¸­æ–­ï¼Œå®ƒå°†ä¸€ç›´è¿è¡Œã€‚å› æ­¤ä¸ºäº†ä¿è¯äº’æ–¥ï¼Œåªéœ€è¦ä¿è¯ä¸€ä¸ªè¿›ç¨‹ä¸è¢«ä¸­æ–­å°±å¯ä»¥äº†ã€‚</p>
<blockquote>
<p>æ€è·¯ï¼š</p>
<ol>
<li>è¿›å…¥è®¿é—®ä¸´ç•Œèµ„æºä¹‹å‰ï¼Œè®©ä¸­æ–­å¤±æ•ˆï¼›</li>
<li>è®¿é—®å®Œä¸´ç•Œèµ„æºä¹‹åï¼Œä½¿èƒ½ä¸­æ–­ï¼›</li>
</ol>
</blockquote>
<p>è¿™ç§èƒ½åŠ›å¯ä»¥é€šè¿‡ç³»ç»Ÿå†…æ ¸ä¸ºå¯ç”¨å’Œç¦ç”¨ä¸­æ–­å®šä¹‰çš„åŸè¯­æ¥æä¾›ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•å®æ–½äº’æ–¥ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">/*disable interruptsï¼ˆç¦ç”¨ä¸­æ–­ï¼‰*/</span></span><br><span class="line">	<span class="comment">/*critical sectionï¼ˆä¸´ç•ŒåŒºï¼‰*/</span></span><br><span class="line">	<span class="comment">/*enable interruptsï¼ˆå¯ç”¨ä¸­æ–­ï¼‰*/</span></span><br><span class="line">	<span class="comment">/*remainderï¼ˆå…¶ä½™éƒ¨åˆ†ï¼‰*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸­æ–­ç¦ç”¨çš„æ–¹æ³•ä½¿å¾—ç¨‹åºæ‰§è¡Œåˆ°ä¸´ç•ŒåŒºä¹‹å‰ä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹æ‰“æ–­ï¼Œå› æ­¤å¯ä»¥ä¿è¯äº’æ–¥ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•ä¹Ÿæœ‰ä¸¤ç§ç¼ºé™·ï¼š</p>
<ul>
<li>é™åˆ¶äº†è¿›ç¨‹çš„å¹¶å‘æ‰§è¡Œï¼šè¿™ä¼šå¯¼è‡´è®¡ç®—æœºç³»ç»Ÿçš„æ‰§è¡Œæ•ˆç‡æœ‰æ˜æ˜¾çš„é™ä½ã€‚ï¼ˆä¸åŸæœ¬å¹¶å‘çš„åˆè¡·ç›¸æ‚–ï¼‰</li>
<li>åœ¨å¤šæ ¸è®¡ç®—æœºæˆ–åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½å¤±æ•ˆï¼Œå› ä¸ºå±è”½ä¸­æ–­éœ€è¦å‘å¤šä¸ªCPUåŒæ—¶å‘èµ·ï¼Œå±è”½ä¸­æ–­ä¿¡å·çš„å‘é€æœ‰ä¸€ä¸ªæ—¶å»¶ï¼Œè¿™ä¸ªæ—¶å»¶å¯èƒ½å¯¼è‡´äº’æ–¥çš„å¤±æ•ˆï¼›</li>
</ul>
<h3 id="ä¸“ç”¨æœºå™¨æŒ‡ä»¤"><a href="#ä¸“ç”¨æœºå™¨æŒ‡ä»¤" class="headerlink" title="ä¸“ç”¨æœºå™¨æŒ‡ä»¤"></a>ä¸“ç”¨æœºå™¨æŒ‡ä»¤</h3><p>åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œå¤šä¸ªå¤„ç†å™¨å…±äº«å†…å­˜ï¼Œè¿™ç§æƒ…å†µå¤„ç†å™¨ä¹‹é—´çš„è¡Œä¸ºæ˜¯æ— å…³çš„ï¼Œå®ƒä»¬ä¹‹é—´ä¹Ÿæ²¡æœ‰æ”¯æŒäº’æ–¥çš„ä¸­æ–­æœºåˆ¶ã€‚ä½†æ˜¯åœ¨ç¡¬ä»¶çº§åˆ«ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¿½æ±‚å¯¹å­˜å‚¨å•å…ƒçš„è®¿é—®æ’æ–¥å¯¹ç›¸åŒå•å…ƒçš„å…¶ä»–è®¿é—®ã€‚åŸºäºè¿™ä¸€ç‚¹ï¼Œå¤„ç†å™¨çš„è®¾è®¡è€…æå‡ºäº†ä¸€äº›æœºå™¨æŒ‡ä»¤ï¼Œç”¨äºä¿è¯ä¸¤ä¸ªåŠ¨ä½œçš„åŸå­æ€§ã€‚</p>
<blockquote>
<p>åŸå­æ€§ï¼šâ€œåŸå­â€è¡¨ç¤ºä¸èƒ½è¢«ä¸­æ–­çš„å•ä¸ªæ­¥éª¤çš„æŒ‡ä»¤ã€‚</p>
<p>ä¾‹å¦‚åœ¨ä¸€ä¸ªå–æŒ‡ä»¤å‘¨æœŸä¸­å¯¹ä¸€ä¸ªå­˜å‚¨å™¨å•å…ƒçš„è¯»å’Œå†™æˆ–è€…è¯»å’Œæµ‹è¯•ã€‚åœ¨è¯¥æŒ‡ä»¤æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä»»ä½•å…¶ä»–çš„æŒ‡ä»¤è®¿é—®å†…å­˜å°†è¢«é˜»æ­¢ã€‚è€Œè¿™äº›åŠ¨ä½œåœ¨ä¸€ä¸ªæŒ‡ä»¤å‘¨æœŸä¸­å®Œæˆã€‚</p>
</blockquote>
<p>æ¥ä¸‹æ¥ä¼šä»‹ç»ä¸¤ç§å¸¸è§çš„æŒ‡ä»¤ï¼š</p>
<h4 id="compare-and-swapï¼ˆæ¯”è¾ƒå’Œäº¤æ¢æŒ‡ä»¤ï¼‰"><a href="#compare-and-swapï¼ˆæ¯”è¾ƒå’Œäº¤æ¢æŒ‡ä»¤ï¼‰" class="headerlink" title="compare_and_swapï¼ˆæ¯”è¾ƒå’Œäº¤æ¢æŒ‡ä»¤ï¼‰"></a>compare_and_swapï¼ˆæ¯”è¾ƒå’Œäº¤æ¢æŒ‡ä»¤ï¼‰</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compare_and_swap</span> <span class="params">(<span class="keyword">int</span> *word, <span class="keyword">int</span> testval, <span class="keyword">int</span> newval)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> oldval;</span><br><span class="line">    oldval = *word;</span><br><span class="line">    <span class="keyword">if</span> (oldval == testval) *word = newval;</span><br><span class="line">    <span class="keyword">return</span> oldval;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä»¥ä¸Šä»£ç ä¸º<code>æ¯”è¾ƒå’Œäº¤æ¢</code>æŒ‡ä»¤çš„ä¸€ä¸ªç‰ˆæœ¬ï¼š</p>
<ul>
<li>ç”¨ä¸€ä¸ªæµ‹è¯•å€¼ï¼ˆteatvalï¼‰æ£€æŸ¥ä¸€ä¸ªå†…å­˜å•å…ƒï¼ˆ*wordï¼‰ã€‚å¦‚æœè¯¥å†…å­˜å•å…ƒçš„å½“å‰å€¼æ˜¯testvalï¼Œå°±ç”¨newvalå–ä»£è¯¥å€¼ï¼›å¦åˆ™ä¿æŒä¸å˜ã€‚</li>
<li>è¯¥æŒ‡ä»¤æ€»æ˜¯è¿”å›æ—§å†…å­˜å€¼ï¼›å› æ­¤ï¼Œå¦‚æœè¿”å›å€¼ä¸æµ‹è¯•å€¼ç›¸åŒï¼Œåˆ™è¡¨ç¤ºè¯¥å†…å­˜å•å…ƒå·²è¢«æ›´æ–°ã€‚</li>
<li>ï¼ˆè¿™ä¸ªåŸå­æŒ‡ä»¤ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼šæ¯”è¾ƒå†…å­˜å•å…ƒå€¼å’Œæµ‹è¯•å€¼ï¼›å¦‚æœå€¼æœ‰å·®å¼‚ï¼Œåˆ™äº§ç”Ÿäº¤æ¢ã€‚æ•´ä¸ªæ¯”è¾ƒå’Œäº¤æ¢åŠŸèƒ½æŒ‰åŸå­æ“ä½œæ‰§è¡Œï¼Œå³å®ƒä¸æ¥å—ä¸­æ–­ã€‚ï¼‰</li>
</ul>
<p>è¯¥æŒ‡ä»¤çš„å¦ä¸€ä¸ªç‰ˆæœ¬è¿”å›ä¸€ä¸ªå¸ƒå°”ï¼ˆBooleanï¼‰å€¼ï¼šäº¤æ¢å‘ç”Ÿæ—¶ä¸ºçœŸï¼ˆtrueï¼‰ï¼›å¦åˆ™ä¸ºå‡ï¼ˆfalseï¼‰ã€‚</p>
<p>ï¼ˆå‡ ä¹æ‰€æœ‰å¤„ç†å™¨å®¶æ—ï¼ˆx86ã€IA64ã€sparcã€/390ç­‰ï¼‰ä¸­éƒ½æ”¯æŒè¯¥æŒ‡ä»¤çš„æŸä¸ªç‰ˆæœ¬ï¼Œè€Œä¸”å¤šæ•°æ“ä½œç³»ç»Ÿéƒ½åˆ©ç”¨è¯¥æŒ‡ä»¤æ”¯æŒå¹¶å‘ã€‚ï¼‰</p>
</blockquote>
<p>ä¸‹é¢çš„ä»£ç å°†å±•ç¤ºåŸºäºä½¿ç”¨<code>æ¯”è¾ƒå’Œäº¤æ¢</code>æŒ‡ä»¤çš„äº’æ–¥è§„ç¨‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*program mutualexclusion*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> n = <span class="comment">/*è¿›ç¨‹ä¸ªæ•°*/</span>;</span><br><span class="line"><span class="keyword">int</span> bolt; <span class="comment">/*å…±äº«å˜é‡*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">p</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">while</span> (compare_and_swap(bolt,<span class="number">0</span>,<span class="number">1</span>) == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">/*ä¸åšä»»ä½•äº‹*/</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*ä¸´ç•ŒåŒº*/</span>;</span><br><span class="line">        bolt = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/*å…¶ä½™éƒ¨åˆ†*/</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    bolt = o; <span class="comment">/*åˆå§‹åŒ–å…±äº«å˜é‡*/</span></span><br><span class="line">    parbegin (P(<span class="number">1</span>), P(<span class="number">2</span>),...,P(n)); <span class="comment">/*å¤šä¸ªè¿›ç¨‹å¹¶å‘*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…±äº«å˜é‡boltè¢«åˆå§‹åŒ–ä¸º0ã€‚å”¯ä¸€å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹æ˜¯å‘ç°boltç­‰äº0çš„é‚£ä¸ªè¿›ç¨‹ã€‚æ‰€æœ‰è¯•å›¾è¿›å…¥ä¸´ç•ŒåŒºçš„å…¶ä»–è¿›ç¨‹è¿›å…¥å¿™ç­‰å¾…æ¨¡å¼ã€‚</p>
<p>å¿™ç­‰å¾…ï¼ˆbusy waitingï¼‰/è‡ªæ—‹ç­‰å¾…ï¼ˆspin waitingï¼‰ï¼š</p>
<p>è¿›ç¨‹åœ¨å¾—åˆ°ä¸´ç•ŒåŒºè®¿é—®æƒä¹‹å‰ï¼Œå®ƒåªèƒ½ç»§ç»­æ‰§è¡Œæµ‹è¯•å˜é‡çš„æŒ‡ä»¤æ¥å¾—åˆ°è®¿é—®æƒï¼Œé™¤æ­¤ä¹‹å¤–ä¸èƒ½åšå…¶ä»–äº‹æƒ…ã€‚</p>
<p>å½“ä¸€ä¸ªè¿›ç¨‹ç¦»å¼€ä¸´ç•ŒåŒºæ—¶ï¼Œå®ƒæŠŠbolté‡ç½®ä¸º0ï¼Œæ­¤æ—¶åªæœ‰ä¸€ä¸ªç­‰å¾…è¿›ç¨‹è¢«å…è®¸è¿›å…¥ä¸´ç•ŒåŒºã€‚è¿›ç¨‹çš„é€‰æ‹©å–å†³äºå“ªä¸ªè¿›ç¨‹æ­£å¥½æ‰§è¡Œç´§æ¥ç€çš„<code>æ¯”è¾ƒå’Œäº¤æ¢</code>æŒ‡ä»¤ã€‚</p>
</blockquote>
<h4 id="exchangeï¼ˆäº¤æ¢æŒ‡ä»¤ï¼‰"><a href="#exchangeï¼ˆäº¤æ¢æŒ‡ä»¤ï¼‰" class="headerlink" title="exchangeï¼ˆäº¤æ¢æŒ‡ä»¤ï¼‰"></a>exchangeï¼ˆäº¤æ¢æŒ‡ä»¤ï¼‰</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exchange</span><span class="params">(<span class="keyword">int</span> <span class="keyword">register</span>, <span class="keyword">int</span> memory)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    temp = memory;</span><br><span class="line">    memory = <span class="keyword">register</span>;</span><br><span class="line">    <span class="keyword">register</span> = temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯¥æŒ‡ä»¤äº¤æ¢ä¸€ä¸ªå¯„å­˜å™¨çš„å†…å®¹å’Œä¸€ä¸ªå­˜å‚¨å•å…ƒçš„å†…å®¹ã€‚</p>
</blockquote>
<p>ä¸‹é¢çš„ä»£ç å°†å±•ç¤ºåŸºäº<code>exchange</code>æŒ‡ä»¤çš„äº’æ–¥åè®®ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*program mutualexclusion*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> n = <span class="comment">/*è¿›ç¨‹ä¸ªæ•°*/</span>;</span><br><span class="line"><span class="keyword">int</span> bolt; <span class="comment">/*å…±äº«å˜é‡*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">p</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> keyi = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="function"><span class="keyword">do</span> <span class="title">exchange</span> <span class="params">(keyi, bolt)</span></span></span><br><span class="line"><span class="function">        <span class="title">while</span> <span class="params">(keyi != <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="comment">/*ä¸´ç•ŒåŒº*/</span>;</span><br><span class="line">        bolt = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/*å…¶ä½™éƒ¨åˆ†*/</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    bolt = o; <span class="comment">/*åˆå§‹åŒ–å…±äº«å˜é‡*/</span></span><br><span class="line">    parbegin (P(<span class="number">1</span>), P(<span class="number">2</span>),...,P(n)); <span class="comment">/*å¤šä¸ªè¿›ç¨‹å¹¶å‘*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…±äº«å˜é‡boltè¢«åˆå§‹åŒ–ä¸º0ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½ä½¿ç”¨ä¸€ä¸ªå±€éƒ¨å˜é‡keyä¸”åˆå§‹åŒ–ä¸º1ã€‚å”¯ä¸€å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹æ˜¯å‘ç°boltç­‰äº0çš„é‚£ä¸ªè¿›ç¨‹ã€‚å®ƒé€šè¿‡æŠŠboltç½®ä¸º1æ’æ–¥æ‰€æœ‰å…¶ä»–è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºã€‚å½“ä¸€ä¸ªè¿›ç¨‹ç¦»å¼€ä¸´ç•ŒåŒºæ—¶ï¼Œå®ƒæŠŠbolté‡ç½®ä¸º0ï¼Œå…è®¸å¦ä¸€ä¸ªè¿›ç¨‹è¿›å…¥å®ƒçš„ä¸´ç•ŒåŒºã€‚</p>
</blockquote>
<p>æœºå™¨æŒ‡ä»¤æ–¹æ³•çš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>é€‚ç”¨äºåœ¨å•å¤„ç†å™¨æˆ–å…±äº«å†…å­˜çš„å¤šå¤„ç†å™¨ä¸Šçš„ä»»ä½•æ•°ç›®çš„è¿›ç¨‹ã€‚</li>
<li>éå¸¸ç®€å•ä¸”æ˜“äºå®ç°ã€‚</li>
<li>å¯ç”¨äºæ”¯æŒå¤šä¸ªä¸´ç•ŒåŒºï¼Œæ¯ä¸ªä¸´ç•ŒåŒºå¯ä»¥ç”¨å®ƒè‡ªå·±çš„å˜é‡å®šä¹‰ã€‚</li>
</ul>
<p>æœºå™¨æŒ‡ä»¤æ–¹æ³•çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li><p>ä½¿ç”¨äº†å¿™ç­‰å¾…ï¼š</p>
<p>å½“ä¸€ä¸ªè¿›ç¨‹æ­£åœ¨ç­‰å¾…è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œå®ƒä¼šç»§ç»­æ¶ˆè€—å¤„ç†å™¨æ—¶é—´ã€‚</p>
</li>
<li><p>å¯èƒ½å¯¼è‡´é¥¥é¥¿ï¼š</p>
<p>å½“ä¸€ä¸ªè¿›ç¨‹ç¦»å¼€ä¸€ä¸ªä¸´ç•ŒåŒºå¹¶ä¸”æœ‰å¤šä¸ªè¿›ç¨‹æ­£åœ¨ç­‰å¾…æ—¶ï¼Œé€‰æ‹©å“ªä¸€ä¸ªç­‰å¾…è¿›ç¨‹æ˜¯ä»»æ„çš„ï¼Œå› æ­¤ï¼ŒæŸäº›è¿›ç¨‹å¯èƒ½è¢«æ— é™æœŸåœ°æ‹’ç»è¿›å…¥ã€‚</p>
</li>
<li><p>å¯èƒ½å¯¼è‡´æ­»é”ï¼š</p>
<p>è€ƒè™‘å•å¤„ç†å™¨ä¸­çš„ä¸‹åˆ—æƒ…å†µã€‚è¿›ç¨‹P1æ‰§è¡Œä¸“é—¨æŒ‡ä»¤ï¼ˆå¦‚compare&amp;swapã€exchangeï¼‰å¹¶è¿›å…¥ä¸´ç•ŒåŒºï¼Œç„¶åP1è¢«ä¸­æ–­å¹¶æŠŠå¤„ç†å™¨è®©ç»™å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„P2ã€‚å¦‚æœP2è¯•å›¾ä½¿ç”¨åŒä¸€èµ„æºï¼Œç”±äºäº’æ–¥æœºåˆ¶ï¼Œå®ƒå°†è¢«æ‹’ç»è®¿é—®ã€‚å› æ­¤ï¼Œå®ƒä¼šè¿›å…¥å¿™ç­‰å¾…å¾ªç¯ã€‚ä½†æ˜¯ï¼Œç”±äºP1æ¯”P2çš„ä¼˜å…ˆçº§ä½ï¼Œå®ƒå°†æ°¸è¿œä¸ä¼šè¢«è°ƒåº¦æ‰§è¡Œã€‚</p>
</li>
</ul>
<h2 id="ä¿¡å·é‡"><a href="#ä¿¡å·é‡" class="headerlink" title="ä¿¡å·é‡"></a>ä¿¡å·é‡</h2><p><em>æ•²é»‘æ¿ï¼ï¼ï¼ï¼ï¼ˆé‡ç‚¹æ¥å•¦ï¼ï¼ï¼ï¼</em></p>
<p>ä¿¡å·é‡æ˜¯1965å¹´ç”±è·å…°ç§‘å­¦å®¶è¿ªæ°æ–¯ç‰¹æ‹‰æå‡ºæ¥çš„ï¼ˆæ•°æ®ç»“æ„æœ€çŸ­è·¯å¾„ç®—æ³•çš„æå‡ºè€…ï¼‰ï¼Œä¿¡å·é‡çš„æœ¬è´¨æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨æ¥å¤„ç†å¹¶å‘è¿›ç¨‹ä¹‹é—´çš„äº’æ–¥ä¸åŒæ­¥çš„ã€‚</p>
<blockquote>
<p>åœ¨è¯¦ç»†ä»‹ç»ä¿¡å·é‡ä¹‹å‰æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å¸¸ç”¨çš„å¹¶å‘æœºåˆ¶ï¼š</p>
<table>
<thead>
<tr>
<th>å¹¶å‘æœºåˆ¶</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>ä¿¡å·é‡ï¼ˆSemaphoreï¼‰</td>
<td>ç”¨äºè¿›ç¨‹é—´ä¼ é€’ä¿¡å·çš„ä¸€ä¸ªæ•´æ•°å€¼ã€‚åœ¨ä¿¡å·é‡ä¸Šåªæœ‰ä¸‰ç§æ“ä½œå¯ä»¥è¿›è¡Œï¼Œ<strong>åˆå§‹åŒ–</strong>ã€<strong>é€’å‡</strong>å’Œ<strong>å¢åŠ </strong>ï¼Œè¿™ä¸‰ç§æ“ä½œéƒ½æ˜¯åŸå­æ“ä½œã€‚é€’å‡æ“ä½œå¯ä»¥ç”¨äºé˜»å¡ä¸€ä¸ªè¿›ç¨‹ï¼Œå¢åŠ æ“ä½œå¯ä»¥ç”¨äºè§£é™¤é˜»å¡ä¸€ä¸ªè¿›ç¨‹ã€‚ä¹Ÿç§°ä¸º<strong>è®¡æ•°ä¿¡å·é‡</strong>æˆ–<strong>ä¸€èˆ¬ä¿¡å·é‡</strong></td>
</tr>
<tr>
<td>äºŒå…ƒä¿¡å·é‡ï¼ˆBinary semaphoreï¼‰</td>
<td>åªå–0å€¼å’Œ1å€¼çš„ä¿¡å·é‡</td>
</tr>
<tr>
<td>äº’æ–¥é‡ï¼ˆMutexï¼‰</td>
<td>ç±»ä¼¼äºäºŒå…ƒä¿¡å·é‡ã€‚å…³é”®åŒºåˆ«åœ¨äºä¸ºå…¶åŠ é”ï¼ˆè®¾å®šå€¼ä¸º0ï¼‰çš„è¿›ç¨‹å’Œä¸ºå…¶è§£é”ï¼ˆè®¾å®šå€¼ä¸º1ï¼‰çš„è¿›ç¨‹å¿…é¡»ä¸ºåŒä¸€ä¸ªè¿›ç¨‹</td>
</tr>
<tr>
<td>æ¡ä»¶å˜é‡ï¼ˆCondition variableï¼‰</td>
<td>ä¸€ç§æ•°æ®ç±»å‹ã€‚ç”¨äºé˜»å¡è¿›ç¨‹æˆ–è€…çº¿ç¨‹ï¼Œç›´åˆ°ç‰¹å®šçš„æ¡ä»¶ä¸ºçœŸ</td>
</tr>
<tr>
<td>ç®¡ç¨‹ï¼ˆMonitorï¼‰</td>
<td>ä¸€ç§ç¼–ç¨‹è¯­è¨€ç»“æ„ï¼Œåœ¨ä¸€ä¸ªæŠ½è±¡æ•°æ®ç±»å‹ä¸­å°è£…äº†å˜é‡ã€è®¿é—®è¿‡ç¨‹å’Œåˆå§‹åŒ–ä»£ç ã€‚ç®¡ç¨‹çš„å˜é‡åªèƒ½ç”±ç®¡ç¨‹è‡ªå·±çš„è®¿é—®è¿‡ç¨‹æ¥è®¿é—®ï¼Œæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨å…¶ä¸­æ‰§è¡Œã€‚è®¿é—®è¿‡ç¨‹å³ä¸´ç•ŒåŒºã€‚ç®¡ç¨‹å¯ä»¥æœ‰ä¸€ä¸ªç­‰å¾…è¿›ç¨‹é˜Ÿåˆ—</td>
</tr>
<tr>
<td>äº‹ä»¶æ ‡å¿—ï¼ˆEvent flagsï¼‰</td>
<td>ä½œä¸ºåŒæ­¥æœºåˆ¶çš„ä¸€ä¸ªå†…å­˜å­—ã€‚åº”ç”¨ç¨‹åºä»£ç å¯ä»¥ä¸ºæ ‡å¿—ä¸­çš„æ¯ä¸ªä½å…³è”ä¸åŒçš„äº‹ä»¶ã€‚é€šè¿‡æµ‹è¯•ç›¸å…³çš„ä¸€ä¸ªæˆ–å¤šä¸ªä½ï¼Œçº¿ç¨‹å¯ä»¥ç­‰å¾…ä¸€ä¸ªäº‹ä»¶æˆ–å¤šä¸ªäº‹ä»¶ã€‚åœ¨å…¨éƒ¨çš„æ‰€éœ€ä½éƒ½è¢«è®¾å®šï¼ˆANDï¼‰æˆ–è€…è‡³å°‘ä¸€ä¸ªä½è¢«è®¾å®šï¼ˆORï¼‰ä¹‹å‰çº¿ç¨‹ä¼šä¸€ç›´è¢«é˜»å¡</td>
</tr>
<tr>
<td>ä¿¡ç®±/æ¶ˆæ¯ï¼ˆMailboxes/messagesï¼‰</td>
<td>ä¸¤ä¸ªè¿›ç¨‹äº¤æ¢ä¿¡æ¯çš„ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç”¨äºåŒæ­¥</td>
</tr>
<tr>
<td>è‡ªæ—‹é”ï¼ˆSpinlocksï¼‰</td>
<td>ä¸€ç§äº’æ–¥æœºåˆ¶ï¼Œè¿›ç¨‹åœ¨ä¸€ä¸ªæ— æ¡ä»¶å¾ªç¯ä¸­æ‰§è¡Œï¼Œç­‰å¾…é”å˜é‡çš„å€¼å˜ä¸ºå¯ç”¨</td>
</tr>
</tbody></table>
</blockquote>
<h3 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h3><p>ä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹å¯ä»¥é€šè¿‡ç®€å•çš„ä¿¡å·è¿›è¡Œåˆä½œï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¢«è¿«åœ¨æŸä¸€ä½ç½®åœæ­¢ï¼Œç›´åˆ°å®ƒæ¥æ”¶åˆ°ä¸€ä¸ªç‰¹å®šçš„ä¿¡å·ã€‚ï¼ˆä»»ä½•å¤æ‚çš„åˆä½œéœ€æ±‚éƒ½å¯ä»¥é€šè¿‡é€‚å½“çš„ä¿¡å·ç»“æ„å¾—åˆ°æ»¡è¶³ï¼‰</p>
<h3 id="ä¿¡å·é‡çš„ç»“æ„"><a href="#ä¿¡å·é‡çš„ç»“æ„" class="headerlink" title="ä¿¡å·é‡çš„ç»“æ„"></a>ä¿¡å·é‡çš„ç»“æ„</h3><p>ä¿¡å·é‡çš„ç»“æ„åŒ…æ‹¬ä¸¤ä¸ªæˆå‘˜å’Œä¸¤ä¸ªåŸå­æ“ä½œï¼š</p>
<ul>
<li><p>ä¸¤ä¸ªæˆå‘˜ï¼š</p>
<ul>
<li>æ•´å½¢å˜é‡countï¼šæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªä¿¡å·é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œç”¨æ¥è¡¨æ˜å…±äº«èµ„æºçš„æ•°ç›®æˆ–è€…æ˜¯è¿›ç¨‹æ‰§è¡Œçš„çŠ¶æ€ã€‚</li>
<li>é˜Ÿåˆ—ï¼šç”¨æ¥å­˜æ”¾å› ä¸ºä½¿ç”¨äº†æŸç§æ“ä½œå¯¼è‡´è¿›ç¨‹é˜»å¡åœ¨è¯¥ä¿¡å·é‡çš„è¿›ç¨‹ã€‚</li>
</ul>
</li>
<li><p>ä¸¤ä¸ªåŸå­æ“ä½œï¼š</p>
<ul>
<li><code>semWait(x)</code>: semWait å¯¹ count è¿›è¡Œ<strong>å‡ä¸€</strong>æ“ä½œï¼Œå¦‚æœæ“ä½œç»“æœä¸ºè´Ÿæ•°ï¼ˆ<strong>å°äºé›¶</strong>)ï¼Œæ‰§è¡ŒsemWait çš„è¿›ç¨‹ä¼šè¢«é˜»å¡åˆ°é˜Ÿåˆ—ä¸Šï¼›</li>
<li><code>semSingal(x)</code>:semsignalå¯¹countè¿›è¡Œ<strong>åŠ ä¸€</strong>æ“ä½œï¼Œå¦‚æœæ‰§è¡Œåçš„ç»“æœ<strong>å°äºç­‰äºé›¶</strong>ï¼Œä¼šä»é˜»å¡é˜Ÿåˆ—çš„é˜Ÿé¦–çš„è¿›ç¨‹å‡ºé˜Ÿï¼Œå¹¶å˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚</li>
</ul>
<blockquote>
<p>ä¸Šé¢çš„æ¦‚å¿µå®šä¹‰äº†ä¸€èˆ¬ä¿¡å·é‡çš„æ¦‚å¿µï¼Œä¸‹é¢è¿˜æœ‰å‡ ä¸ªè¡ç”Ÿçš„æ¦‚å¿µï¼š</p>
<ul>
<li>è®¡æ•°ä¿¡å·é‡ï¼šå¦‚æœcountçš„å–å€¼æ˜¯æ•´ä¸ªæ•´æ•°ç©ºé—´ï¼›</li>
<li>äºŒå…ƒä¿¡å·é‡ï¼šå¦‚æœcountçš„å–å€¼ä»…é™äº0å’Œ1ï¼›</li>
<li>äº’æ–¥ä¿¡å·é‡ï¼šå¦‚æœä¿¡å·é‡ä¸­çš„semWaitå’ŒsemSignalæ“ä½œåœ¨ä¸€ä¸ªè¿›ç¨‹ä¹‹å†…ï¼›</li>
<li>å¼ºä¿¡å·é‡ï¼šä¿¡å·é‡ä¸­é˜»å¡çš„è¿›ç¨‹æ‹¥æœ‰æ˜ç¡®çš„å‡ºé˜Ÿé˜Ÿåˆ—ï¼›</li>
<li>å¼±ä¿¡å·é‡ï¼šé˜»å¡è¿›ç¨‹çš„å‡ºé˜Ÿç­–ç•¥ä¸æ˜ç¡®ï¼ˆä¸€ä¼šFIFOï¼Œä¸€ä¼šåŸºäºä¼˜å…ˆçº§ï¼‰</li>
</ul>
</blockquote>
</li>
</ul>
<p>è¯´æ˜ï¼š</p>
<p>å¯¹ä»¥ä¸Šæ“ä½œçš„è§£é‡Šå¦‚ä¸‹ï¼š</p>
<ul>
<li><p>å¼€å§‹æ—¶ï¼Œä¿¡å·é‡çš„å€¼ä¸ºé›¶æˆ–è€…æ˜¯æ­£æ•°ï¼›</p>
</li>
<li><p>å¦‚æœè¯¥å€¼ä¸ºæ­£æ•°ï¼Œåˆ™è¯¥å€¼ç­‰äºå‘å‡ºsemWaitæ“ä½œåå¯ç«‹å³ç»§ç»­æ‰§è¡Œçš„è¿›ç¨‹çš„æ•°é‡ï¼›</p>
</li>
<li><p>å¦‚æœè¯¥å€¼ä¸ºé›¶ï¼ˆæˆ–è€…ç”±äºåˆå§‹åŒ–ï¼Œæˆ–è€…ç”±äºæœ‰ç­‰äºä¿¡å·é‡åˆå€¼çš„è¿›ç¨‹å·²ç»ç­‰å¾…ï¼‰ï¼Œåˆ™å‘å‡ºsemWaitæ“ä½œçš„ä¸‹ä¸€ä¸ªè¿›ç¨‹ä¼šè¢«é˜»å¡ï¼Œæ­¤æ—¶è¯¥ä¿¡å·é‡çš„å€¼å˜ä¸ºè´Ÿå€¼ã€‚ï¼ˆä¹‹åï¼Œæ¯ä¸ªåç»­çš„semWaitæ“ä½œéƒ½ä¼šä½¿ä¿¡å·é‡çš„è´Ÿå€¼æ›´å¤§ï¼Œï¼‰è¯¥è´Ÿå€¼ç­‰äºæ­£åœ¨ç­‰å¾…è§£é™¤é˜»å¡çš„è¿›ç¨‹çš„æ•°é‡ï¼›</p>
</li>
<li><p>åœ¨ä¿¡å·é‡ä¸ºè´Ÿå€¼çš„æƒ…å½¢ä¸‹ï¼Œæ¯ä¸€ä¸ªsemSignalæ“ä½œéƒ½ä¼šå°†ç­‰å¾…è¿›ç¨‹ä¸­çš„ä¸€ä¸ªè¿›ç¨‹è§£é™¤é˜»å¡ã€‚</p>
<blockquote>
<p>å…³äºä¿¡å·é‡å®šä¹‰çš„ç»“è®ºï¼š</p>
<ul>
<li>é€šå¸¸ï¼Œåœ¨è¿›ç¨‹å¯¹ä¿¡å·é‡å‡1ä¹‹å‰ï¼Œæ— æ³•æå‰çŸ¥é“è¯¥ä¿¡å·é‡æ˜¯å¦ä¼šè¢«é˜»å¡ã€‚</li>
<li>å½“è¿›ç¨‹å¯¹ä¸€ä¸ªä¿¡å·é‡åŠ 1ä¹‹åï¼Œå¦ä¸€ä¸ªè¿›ç¨‹ä¼šè¢«å”¤é†’ï¼Œä¸¤ä¸ªè¿›ç¨‹ç»§ç»­å¹¶å‘è¿è¡Œã€‚è€Œåœ¨ä¸€ä¸ªå•å¤„ç†å™¨ç³»ç»Ÿä¸­ï¼ŒåŒæ ·æ— æ³•çŸ¥é“å“ªä¸€ä¸ªè¿›ç¨‹ä¼šç«‹å³ç»§ç»­è¿è¡Œã€‚</li>
<li>åœ¨å‘ä¿¡å·é‡å‘å‡ºä¿¡å·åï¼Œä¸éœ€è¦çŸ¥é“æ˜¯å¦æœ‰å¦ä¸€ä¸ªè¿›ç¨‹æ­£åœ¨ç­‰å¾…ï¼Œè¢«è§£é™¤é˜»å¡çš„è¿›ç¨‹æ•°é‡æˆ–è€…æ²¡æœ‰æˆ–è€…æ˜¯1ä¸ªã€‚</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="ä¿¡å·é‡çš„ä½¿ç”¨"><a href="#ä¿¡å·é‡çš„ä½¿ç”¨" class="headerlink" title="ä¿¡å·é‡çš„ä½¿ç”¨"></a>ä¿¡å·é‡çš„ä½¿ç”¨</h3><p>å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œå¼•å…¥ä¿¡å·é‡çš„çš„ç›®çš„æ˜¯å®ç°åŒæ­¥äº’æ–¥çš„ï¼Œä½¿ç”¨ä¿¡å·é‡çš„æ“ä½œä¸€èˆ¬åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>åˆ†æé—®é¢˜ä¹‹é—´è¿›ç¨‹çš„å…³ç³»å’Œç§ç±»ï¼›</li>
<li>æ ¹æ®è¿›ç¨‹çš„å…³ç³»å®šä¹‰ä¿¡å·é‡å¹¶å®ç°ï¼›</li>
</ol>
<p>å¯¹äºä¸åŒçš„å…³ç³»ï¼Œæ“ä½œæ–¹æ³•ä¸åŒï¼š</p>
<ul>
<li>å¯¹äºäº’æ–¥å…³ç³»ï¼š<ol>
<li>æœ‰å‡ ä¸ªä¸´ç•Œèµ„æºï¼Œå°±å®šä¹‰å‡ ä¸ªä¿¡å·é‡ï¼›</li>
<li>æ ¹æ®é—®é¢˜å¯¹ä¿¡å·è¿›è¡Œåˆå§‹åŒ–ï¼›</li>
<li>ä½¿ç”¨semWaitå’ŒsemSignalå®ç°å¯¹ä¿¡å·é‡çš„äº’æ–¥è®¿é—®ï¼›</li>
</ol>
</li>
<li>å¯¹äºåŒæ­¥å…³ç³»ï¼ˆä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œæ˜¯å¦å¤–ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œçš„å…ˆå†³æ¡ä»¶ï¼‰ï¼š<ol>
<li>åˆ†æè¿›ç¨‹ä¹‹é—´çš„åŒæ­¥å…³ç³»ï¼Œæœ‰å‡ ç§å…³ç³»å°±å®šä¹‰å‡ ä¸ªä¿¡å·é‡ï¼›</li>
<li>æ ¹æ®é—®é¢˜çš„æ¡ä»¶å¯¹ä¿¡å·é‡è¿›è¡Œåˆå§‹åŒ–ï¼›</li>
<li>è°ƒç”¨semwaitå’Œsemsinalå®ç°åŒæ­¥ï¼›ï¼ˆä¸€èˆ¬ä¸¤ä¸ªæ“ä½œä¸åœ¨ç›¸åŒçš„è¿›ç¨‹å†…ï¼‰</li>
</ol>
</li>
</ul>
<h3 id="ä¿¡å·é‡åŸè¯­çš„å®šä¹‰"><a href="#ä¿¡å·é‡åŸè¯­çš„å®šä¹‰" class="headerlink" title="ä¿¡å·é‡åŸè¯­çš„å®šä¹‰"></a>ä¿¡å·é‡åŸè¯­çš„å®šä¹‰</h3><p>ä»¥ä¸‹ä»£ç ç»™å‡ºäº†å…³äºä¿¡å·åŸè¯­æ›´è§„èŒƒçš„å®šä¹‰ã€‚ï¼ˆsemWaitå’ŒsemsignalåŸè¯­è¢«å‡è®¾æ˜¯åŸå­æ“ä½œï¼‰</p>
<p>ï¼ˆéäºŒå…ƒä¿¡å·é‡å¸¸å¸¸ä¹Ÿç§°ä¸º<strong>è®¡æ•°ä¿¡å·é‡</strong>æˆ–è€…<strong>ä¸€èˆ¬ä¿¡å·é‡</strong>ï¼‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*semaphore*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">semaphore</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line">    queueType <span class="built_in">queue</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*semWait*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">semWait</span><span class="params">(semaphore s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    s.count--;</span><br><span class="line">    <span class="keyword">if</span> (s.count &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">/*æŠŠå½“å‰è¿›ç¨‹æ’å…¥åˆ°é˜»å¡é˜Ÿåˆ—å½“ä¸­*/</span>;</span><br><span class="line">        <span class="comment">/*é˜»å¡å½“å‰è¿›ç¨‹*/</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*semSignal*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">semSignal</span><span class="params">(semaphore s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    s.count++;</span><br><span class="line">    <span class="keyword">if</span> (s.count &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">/*æŠŠè¿›ç¨‹pä»é˜»å¡é˜Ÿåˆ—å½“ä¸­ç§»é™¤*/</span>;</span><br><span class="line">        <span class="comment">/*æŠŠè¿›ç¨‹pæ’å…¥åˆ°å°±ç»ªé˜Ÿåˆ—*/</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒå…ƒä¿¡å·é‡"><a href="#äºŒå…ƒä¿¡å·é‡" class="headerlink" title="äºŒå…ƒä¿¡å·é‡"></a>äºŒå…ƒä¿¡å·é‡</h3><p>ä»¥ä¸‹ä»£ç å®šä¹‰äº†ä¿¡å·é‡æ›´ä¸ºä¸¥æ ¼çš„å½¢å¼ï¼Œä¿¡å·é‡çš„å€¼åªèƒ½ä¸º0æˆ–1ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*binary_semaphore*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">binary_semaphore</span>&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span>zero, one&#125; value;</span><br><span class="line">    queueType <span class="built_in">queue</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*semWaitB*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">semWaitB</span><span class="params">(binary_semaphore s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s.value == one)&#123;</span><br><span class="line">        s.value = zero;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/*æŠŠå½“å‰è¿›ç¨‹æ’å…¥åˆ°é˜»å¡é˜Ÿåˆ—å½“ä¸­*/</span>;</span><br><span class="line">        <span class="comment">/*é˜»å¡å½“å‰è¿›ç¨‹*/</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*semSignalB*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">semSignalB</span><span class="params">(semaphore s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">queue</span> is empty())&#123;</span><br><span class="line">        s.value = one;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/*æŠŠè¿›ç¨‹pä»é˜»å¡é˜Ÿåˆ—ä¸­ç§»é™¤*/</span>;</span><br><span class="line">        <span class="comment">/*æŠŠè¿›ç¨‹pæ’å…¥åˆ°å°±ç»ªé˜Ÿåˆ—*/</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>ä¸€ä¸ªäºŒå…ƒä¿¡å·é‡å¯ä»¥åˆå§‹åŒ–æˆ0æˆ–1ã€‚</li>
<li>semWaitBæ“ä½œæ£€æŸ¥ä¿¡å·çš„å€¼ï¼Œå¦‚æœå€¼ä¸º0ï¼Œé‚£ä¹ˆè¿›ç¨‹æ‰§è¡ŒaemwaitBå°±ä¼šå—é˜»ã€‚å¦‚æœå€¼ä¸º1ï¼Œé‚£ä¹ˆå°†å€¼æ”¹å˜ä¸º0ï¼Œå¹¶ä¸”ç»§ç»­æ‰§è¡Œè¯¥è¿›ç¨‹ã€‚</li>
<li>semSignalBæ“ä½œæ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•è¿›ç¨‹åœ¨è¯¥ä¿¡å·ä¸Šå—é˜»ï¼Œå¦‚æœæœ‰ï¼Œé‚£ä¹ˆé€šè¿‡semWaitBæ“ä½œï¼Œå—é˜»çš„è¿›ç¨‹å°±ä¼šè¢«å”¤é†’ï¼Œå¦‚æœæ²¡æœ‰è¿›ç¨‹å—é˜»ï¼Œé‚£ä¹ˆå€¼è¢«è®¾ç½®ä¸º1ã€‚</li>
</ul>
</blockquote>
<h3 id="å¼ºã€å¼±ä¿¡å·é‡"><a href="#å¼ºã€å¼±ä¿¡å·é‡" class="headerlink" title="å¼ºã€å¼±ä¿¡å·é‡"></a>å¼ºã€å¼±ä¿¡å·é‡</h3><p>ä¸è®ºæ˜¯å“ªä¸€ç§ä¿¡å·é‡ï¼Œéƒ½éœ€è¦ä½¿ç”¨é˜Ÿåˆ—æ¥ä¿å­˜åœ¨ä¿¡å·é‡ä¸Šç­‰å¾…çš„è¿›ç¨‹ã€‚è¿™å°±ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼šè¿›ç¨‹æŒ‰ç…§ä»€ä¹ˆé¡ºåºä»é˜Ÿåˆ—ä¸­ç§»å‡ºï¼Ÿ</p>
<ul>
<li><p>å¼ºä¿¡å·é‡ï¼š</p>
<p>æœ€å…¬å¹³çš„ç­–ç•¥æ˜¯å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰ï¼šè¢«é˜»å¡æ—¶é—´æœ€ä¹…çš„è¿›ç¨‹æœ€å…ˆä»é˜Ÿåˆ—é‡Šæ”¾ã€‚é‡‡ç”¨è¿™ä¸ªç­–ç•¥å®šä¹‰çš„ä¿¡å·é‡ç§°ä¸ºå¼ºä¿¡å·é‡ï¼ˆstrong semaphoreï¼‰ã€‚</p>
</li>
<li><p>å¼±ä¿¡å·é‡ï¼š</p>
<p>æ²¡æœ‰è§„å®šè¿›ç¨‹ä»é˜Ÿåˆ—ä¸­ç§»å‡ºé¡ºåºçš„ä¿¡å·é‡ç§°ä¸ºå¼±ä¿¡å·é‡ï¼ˆweak semaphoreï¼‰ã€‚</p>
</li>
</ul>
<p>ä¸‹å›¾å°†å±•ç¤ºï¼ˆå¼ºï¼‰ä¿¡å·é‡æœºåˆ¶çš„ä¸€ä¸ªä¾‹å­ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E5%BC%BA%E4%BF%A1%E5%8F%B7%E9%87%8F.png"></p>
<blockquote>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>åˆå§‹æ—¶åˆ»â‘ ï¼ŒAæ­£åœ¨è¿è¡Œï¼ŒBã€Då’ŒCå°±ç»ªï¼Œä¿¡å·é‡ä¸º1ã€‚å½“Aæ‰§è¡Œä¸€æ¡semWaitæŒ‡ä»¤åï¼Œä¿¡å·é‡å‡ä¸º0ï¼ŒAèƒ½ç»§ç»­æ‰§è¡Œï¼Œéšåå®ƒåŠ å…¥å°±ç»ªé˜Ÿåˆ—ã€‚</li>
<li>ç„¶ååœ¨æ—¶åˆ»â‘¡æ—¶ï¼ŒBæ­£åœ¨è¿è¡Œï¼Œæœ€ç»ˆæ‰§è¡Œä¸€æ¡semWaitæŒ‡ä»¤ï¼Œå¹¶è¢«æŒ‚èµ·ï¼ˆæ­¤æ—¶ä¿¡å·é‡ä¸º-1ï¼‰ã€‚</li>
<li>åœ¨æ—¶åˆ»â‘¢æ—¶ï¼ŒDè¢«å…è®¸è¿è¡Œã€‚</li>
<li>åœ¨æ—¶åˆ»â‘£æ—¶ï¼Œå½“Då®Œæˆä¸€ä¸ªæ–°ç»“æœåï¼Œå®ƒæ‰§è¡Œä¸€æ¡semSignalæŒ‡ä»¤ï¼Œå…è®¸Bç§»åˆ°å°±ç»ªé˜Ÿåˆ—ä¸­ã€‚</li>
<li>åœ¨æ—¶åˆ»â‘¤æ—¶ï¼ŒDåŠ å…¥å°±ç»ªé˜Ÿåˆ—ï¼ŒCå¼€å§‹è¿è¡Œï¼Œå½“å®ƒæ‰§è¡ŒsemWaitæŒ‡ä»¤æ—¶è¢«æŒ‚èµ·ã€‚</li>
<li>ç±»ä¼¼åœ°ï¼Œåœ¨æ—¶åˆ»â‘¥ï¼ŒAå’ŒBè¿è¡Œï¼Œä¸”è¢«æŒ‚èµ·åœ¨è¿™ä¸ªä¿¡å·é‡ä¸Šï¼Œå…è®¸Dæ¢å¤æ‰§è¡Œã€‚</li>
<li>åœ¨æ—¶åˆ»â‘¦ï¼Œå½“Dæœ‰ä¸€ä¸ªç»“æœåï¼Œæ‰§è¡Œä¸€æ¡semSlgnalæŒ‡ä»¤ï¼ŒæŠŠCç§»åˆ°å°±ç»ªé˜Ÿåˆ—ä¸­ã€‚</li>
</ul>
</blockquote>
<h3 id="äº’æ–¥"><a href="#äº’æ–¥" class="headerlink" title="äº’æ–¥"></a>äº’æ–¥</h3><p>ä»¥ä¸‹ä»£ç ç»™å‡ºäº†ä¸€ç§ä½¿ç”¨ä¿¡å·é‡sè§£å†³äº’æ–¥é—®é¢˜çš„æ–¹æ³•ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*program mutualexclusion*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> n = <span class="comment">/*è¿›ç¨‹æ•°*/</span>;</span><br><span class="line">semaphore s = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">P</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        semWait(s);</span><br><span class="line">        <span class="comment">/*ä¸´ç•ŒåŒº*/</span>;</span><br><span class="line">        semSignal(s);</span><br><span class="line">        <span class="comment">/*å…¶ä»–éƒ¨åˆ†*/</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    parbegin (P(<span class="number">1</span>), P(<span class="number">2</span>),...,P(n)); <span class="comment">/*å¤šè¿›ç¨‹å¹¶å‘æ‰§è¡Œ*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>è®¾æœ‰nä¸ªè¿›ç¨‹ï¼Œç”¨æ•°ç»„P(i)è¡¨ç¤ºï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½éœ€è¦è®¿é—®å…±äº«èµ„æºã€‚æ¯ä¸ªè¿›ç¨‹ä¸­è¿›å…¥ä¸´ç•ŒåŒºå‰æ‰§è¡ŒsemWait(s)ï¼Œå¦‚æœsçš„å€¼ä¸ºè´Ÿï¼Œåˆ™è¿›ç¨‹è¢«æŒ‚èµ·ï¼›å¦‚æœå€¼ä¸º1ï¼Œåˆ™sè¢«å‡ä¸º0ï¼Œè¿›ç¨‹ç«‹å³è¿›äººä¸´ç•ŒåŒºï¼›ç”±äºsä¸å†ä¸ºæ­£ï¼Œå› è€Œå…¶ä»–ä»»ä½•è¿›ç¨‹éƒ½ä¸èƒ½è¿›å…¥ä¸´ç•ŒåŒºã€‚</p>
<p>å¯ä»¥è¿™æ ·ç†è§£ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹æƒ³è¦è°ƒç”¨å…¬å…±èµ„æºæ—¶ï¼Œå°±è¦å‘å‡º<code>semWait(s)</code>æŒ‡ä»¤ï¼Œä»¥è·å–èµ„æºï¼Œå¦‚æœè·å–ä¸åˆ°ï¼Œåˆ™ä¸€ç›´è°ƒç”¨è¯¥æŒ‡ä»¤ï¼›ä¸€æ—¦è·å–äº†è¯¥èµ„æºï¼Œåˆ™å…¶ä»–è¿›ç¨‹æ— æ³•ä½¿ç”¨ï¼›ç­‰åˆ°è¯¥è¿›ç¨‹ä½¿ç”¨å®Œèµ„æºåï¼Œå°±ä¼šè°ƒç”¨<code>semSignal(s)</code>æŒ‡ä»¤ï¼Œå‘Šè¯‰å…¶å®ƒè¿›ç¨‹ï¼šâ€œæˆ‘ç”¨å®Œå•¦ï¼Œå¹¶ä¸”æŠŠèµ„æºäº¤è¿˜å›å…¬å…±åŒºåŸŸå•¦ã€‚â€</p>
<ul>
<li><code>s.count â‰¥ 0</code>ï¼šs.countæ˜¯å¯ä»¥æ‰§è¡ŒsemWait(s)è€Œä¸è¢«æŒ‚èµ·çš„è¿›ç¨‹æ•°ï¼ˆå¦‚æœå…¶é—´æ²¡æœ‰semSignal(a)è¢«æ‰§è¡Œï¼‰ã€‚è¿™ç§æƒ…å½¢å…è®¸ä¿¡å·é‡æ”¯æŒåŒæ­¥ä¸äº’æ–¥ã€‚</li>
<li><code>s.count&lt;0</code>ï¼šs.countçš„å¤§å°æ˜¯æŒ‚èµ·åœ¨s.queueé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹æ•°.</li>
</ul>
<p>ä¸‹å›¾ç»™å‡ºäº†ä¿¡å·é‡æœºåˆ¶æ‰§è¡Œè¿‡ç¨‹çš„å¦ä¸€ç§è¡¨è¿°ï¼Œè¿™é‡Œä¸å†è¯´æ˜ï¼ˆ<em>çœ‹å¾—æ‡‚ï¼Œåº”è¯¥çœ‹å¾—æ‡‚</em>ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E4%BF%A1%E5%8F%B7%E9%87%8F%E8%AF%B4%E6%98%8E.png"></p>
</blockquote>
<h3 id="ä¿¡å·é‡é—®é¢˜"><a href="#ä¿¡å·é‡é—®é¢˜" class="headerlink" title="ä¿¡å·é‡é—®é¢˜"></a>ä¿¡å·é‡é—®é¢˜</h3><p><em>ï¼ˆä¸ºäº†ä½¿å¾—æ–‡ç« æ•´ä½“ç»“æ„çœ‹èµ·æ¥ä¸é‚£ä¹ˆæ··ä¹±ï¼Œè¿™é‡Œç”¨å¦ä¸€ç¯‡æ–‡ç« å»ç»¼åˆä¸€äº›å…³äºä¿¡å·é‡çš„é—®é¢˜ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è·³è½¬ï¼‰</em></p>
<div class="btn-center">
<a class="btn" href="/next/2021/04/25/æ“ä½œç³»ç»Ÿ/æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-ä¿¡å·é‡ç›¸å…³é—®é¢˜/"><i class="far fa-hand-point-right"></i>ç‚¹å‡»è·³è½¬ è‡³ ã€Šä¿¡å·é‡ç›¸å…³é—®é¢˜ã€‹</a>
</div>

<h3 id="ä¿¡å·é‡çš„å®ç°"><a href="#ä¿¡å·é‡çš„å®ç°" class="headerlink" title="ä¿¡å·é‡çš„å®ç°"></a>ä¿¡å·é‡çš„å®ç°</h3><p><code>semWait</code>å’Œ<code>semSignal</code>æ“ä½œå¿…é¡»ä½œä¸ºåŸå­åŸè¯­å®ç°ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š</p>
<ul>
<li>é€šè¿‡ç¡¬ä»¶æˆ–å›ºä»¶å®ç°ã€‚</li>
<li>é€šè¿‡è½¯ä»¶æ–¹æ¡ˆå®ç°ã€‚ï¼ˆè¿™ä¼šä¼´éšå¤„ç†å¼€é”€ï¼‰</li>
<li>å¯¹äºå•å¤„ç†å™¨ç³»ç»Ÿï¼Œå¯ä»¥é€šè¿‡ç¦ç”¨ä¸­æ–­çš„æ–¹å¼å®ç°ã€‚</li>
</ul>
<h2 id="ç®¡ç¨‹"><a href="#ç®¡ç¨‹" class="headerlink" title="ç®¡ç¨‹"></a>ç®¡ç¨‹</h2><p>ä»ä¸Šè¿°å†…å®¹å¯ä»¥çœ‹å‡ºä¿¡å·é‡æœ‰æ•ˆåœ°æä¾›äº†è¿›ç¨‹é—´äº’æ–¥ä¸åˆä½œçš„æ”¯æŒï¼Œä½†å®é™…ä¸Šä¿¡å·é‡å¯¹äºç¼–å†™è€…æ¥è¯´æ˜¯å¾ˆå›°éš¾çš„ï¼Œç”¨ä¿¡å·é‡è®¾è®¡ä¸€ä¸ªæ­£ç¡®çš„ç¨‹åºå¹¶éæ˜“äº‹ï¼šç”±äºä¿¡å·é‡åˆ†å¸ƒåœ¨æ•´ä¸ªç¨‹åºä¸­ï¼Œä½¿ç”¨ä¸å½“ï¼Œå¯èƒ½é€ æˆç¨‹åºé”™è¯¯ï¼Œç”šè‡³æ­»é”ã€‚ä¸‹é¢æ¥çœ‹ä¸‰ä¸ªé”™è¯¯æ¡ˆä¾‹ï¼š</p>
<ul>
<li><p>é”™è¯¯ä¸€ï¼šåœ¨åˆ©ç”¨ä¿¡å·é‡äº’æ–¥æ—¶ï¼Œè¯¯å°† semWaitä¸semSignalçš„é¡ºåºé¢ å€’ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">semSignal(mutex)</span><br><span class="line"> <span class="function">critical area</span></span><br><span class="line"><span class="function"><span class="title">semWait</span><span class="params">(mutex)</span></span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¼šå¯¼è‡´ä¸´ç•Œè®¿é—®å¤±æ•ˆã€‚</p>
</li>
<li><p>é”™è¯¯äºŒï¼šåœ¨å®ç°äº’æ–¥æ—¶ï¼Œè¯¯å°†semSigal å†™æˆsemWait, æˆ–è¯¯å°†semWaitå†™æˆsemSigal, å¯¼è‡´ä¸´ç•ŒåŒºæ— æ³•è®¿é—®ï¼Œæˆ–è€…ä¸´ç•ŒåŒºè¢«å¤šæ¬¡è®¿é—®ï¼›</p>
</li>
<li><p>é”™è¯¯ä¸‰: å®ç°äº’æ–¥è®¿é—®çš„æ—¶å€™ï¼Œç¨‹åºé—æ¼äº†semWaitï¼Œæ“ä½œä¸´ç•ŒåŒºå¤±æ•ˆï¼›</p>
</li>
</ul>
<p>åŸºäºè¿™ç§æƒ…å†µï¼ŒDJstraåœ¨1971å¹´æå‡ºä¸ºæ¯ä¸€ä¸ªå…±äº«çš„èµ„æºè®¾ç«‹ä¸€ä¸ªç§˜ä¹¦ç®¡ç†ä»–çš„è®¿é—®çš„æ€æƒ³ã€‚å³ï¼šä¸€åˆ‡è¿›ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œå¿…é¡»é€šè¿‡è®¾ç«‹çš„ç§˜ä¹¦ï¼Œç§˜ä¹¦ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®å…±äº«èµ„æºï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå³å®ç°äº†èµ„æºçš„å…±äº«ï¼ŒåŒæ—¶ä¹Ÿä¿è¯äº†èµ„æºçš„äº’æ–¥è®¿é—®ä¸åŒæ­¥ã€‚1973å¹´ï¼Œæ±‰æ£®å’Œéœå°”åˆå°†ç§˜ä¹¦çš„æ¦‚å¿µå‘å±•æˆä¸ºç®¡ç¨‹ã€‚</p>
<p>ç®¡ç¨‹å®šä¹‰äº†ä¸€ç»„å±€éƒ¨æ•°æ®å’Œå†…éƒ¨æ“ä½œï¼Œåªæœ‰å†…éƒ¨æ“ä½œæ‰èƒ½ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œè®¿é—®ç®¡ç¨‹çš„è¿›ç¨‹é€šè¿‡å†…éƒ¨æ“ä½œè®¿é—®æˆ–ä¿®æ”¹å†…å®¹æ•°æ®ï¼Œä»è€Œå®ç°è¿›ç¨‹é—´çš„äº’æ–¥ä¸è®¿é—®ã€‚</p>
<blockquote>
<p>ç®¡ç¨‹å…è®¸ç¨‹åºå‘˜ç”¨å…¶é”å®šä»»ä½•å¯¹è±¡ï¼ˆå¯¹ç±»ä¼¼äºé“¾è¡¨ä¹‹ç±»çš„å¯¹è±¡ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªé”é”ä½æ•´ä¸ªé“¾è¡¨ï¼Œä¹Ÿå¯ä»¥æ¯ä¸ªè¡¨ç”¨ä¸€ä¸ªé”ï¼Œè¿˜å¯ä»¥ä¸ºè¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ç”¨ä¸€ä¸ªé”ï¼‰ã€‚</p>
<p>ç®¡ç¨‹å¤©ç”Ÿå…·æœ‰æ’ä»–æ€§ï¼ˆäº’æ–¥ï¼‰ã€‚å› æ­¤ç¨‹åºå‘˜åªéœ€è¦åœ¨ç®¡ç¨‹å½“ä¸­è§£å†³å¥½åŒæ­¥é—®é¢˜ï¼Œäº’æ–¥çš„å·¥ä½œå¯ä»¥å®Œå…¨äº¤ç”±ç¼–è¯‘å™¨å¤„ç†ã€‚</p>
<p>å…³äºå®ç°ç®¡ç¨‹çš„åŒæ­¥çš„æªæ–½ï¼š</p>
<ol>
<li>ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨ç®¡ç¨‹å†…çš„å†…éƒ¨æ“ä½œè¿›å…¥ç®¡ç¨‹åï¼Œåœ¨ç®¡ç¨‹é©»ç•™æœŸé—´ï¼Œå¦‚æœè¯¥è¿›ç¨‹è¦æ±‚çš„å…±äº«èµ„æºä¸æ»¡è¶³è¿›ç¨‹æ‰§è¡Œçš„æ¡ä»¶ï¼Œéœ€è¦å°†è¿›ç¨‹é˜»å¡åœ¨é˜»å¡é˜Ÿåˆ—ä¸Šï¼Œå¹¶é‡Šæ”¾ç®¡ç¨‹çš„ä½¿ç”¨æƒï¼›</li>
<li>å½“é˜»å¡è¿›ç¨‹ç­‰å¾…çš„æ¡ä»¶æ»¡è¶³æ—¶ï¼Œéœ€è¦å°†è¯¥è¿›ç¨‹ä»é˜»å¡é˜Ÿåˆ—ä¸­ç§»é™¤åˆ°å°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œå…è®¸è¯¥è¿›ç¨‹èƒ½å¤Ÿå†æ¬¡è¿›å…¥ç®¡ç¨‹æ‰§è¡Œã€‚</li>
</ol>
<p>ä¸Šè¿°ä¸¤ç§æœºåˆ¶çš„å®ç°æ—¶é€šè¿‡æ¡ä»¶å˜é‡å’Œä¸¤ä¸ªå†…éƒ¨æ“ä½œ<code>cwait</code> å’Œ<code>csignal</code>å®ç°çš„ï¼ˆä¸‹æ–‡å°†è¯¦ç»†ä»‹ç»ï¼‰ï¼š</p>
<ol>
<li>åœ¨ç®¡ç¨‹å†…è®¾ç½®è‹¥å¹²æ¡ä»¶å˜é‡ç”¨æ¥åŒºåˆ†ä¸åŒçš„æ¡ä»¶ï¼›</li>
<li>é’ˆå¯¹æ¡ä»¶å˜é‡çš„ä¸¤ä¸ªæ“ä½œ cwaitå’Œcsignal,cwait æ˜¯ç”¨æ¥å°†è¿›ç¨‹é˜»å¡åˆ°å¯¹åº”çš„æ¡ä»¶å˜é‡é˜»å¡é˜Ÿåˆ—ä¸­ï¼Œcsignalæ˜¯ç”¨æ¥å°†è¿›ç¨‹ä»å¯¹åº”çš„é˜»å¡é˜Ÿåˆ—ä¸­æ¢å¤åˆ°å°±ç»ªé˜Ÿåˆ—ã€‚</li>
</ol>
</blockquote>
<p>ç®¡ç¨‹æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼ŒåŒ…å«5ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li>å±€éƒ¨å˜é‡</li>
<li>å†…éƒ¨è¿‡ç¨‹</li>
<li>åˆå§‹åŒ–æ“ä½œ</li>
<li>æ¡ä»¶å˜é‡</li>
<li>é˜»å¡é˜Ÿåˆ—</li>
</ol>
<p>ç®¡ç¨‹å…·æœ‰ä¸‰ä¸ªç‰¹æ€§ï¼š</p>
<ol>
<li>ç®¡ç¨‹çš„å†…éƒ¨æ•°æ®åªèƒ½è¢«ç®¡ç¨‹å†…éƒ¨çš„æ“ä½œè®¿é—®ï¼›</li>
<li>ä¸€ä¸ªè¿›ç¨‹åªèƒ½é€šè¿‡ç®¡ç¨‹çš„å†…éƒ¨è¿‡ç¨‹å¯¹ç®¡ç¨‹è¿›è¡Œè®¿é—®ï¼›</li>
<li>æ¯æ¬¡æœ€å¤šå…è®¸ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ç®¡ç¨‹çš„å†…éƒ¨æ“ä½œï¼Œå³è¿›ç¨‹äº’æ–¥çš„è°ƒç”¨å†…éƒ¨è¿‡ç¨‹è¿›å…¥ç®¡ç¨‹ï¼Œå…¶ä»–æƒ³è¿›å…¥ç®¡ç¨‹çš„è¿›ç¨‹å¿…é¡»åœ¨é˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</li>
</ol>
<h3 id="ä½¿ç”¨ä¿¡å·çš„ç®¡ç¨‹"><a href="#ä½¿ç”¨ä¿¡å·çš„ç®¡ç¨‹" class="headerlink" title="ä½¿ç”¨ä¿¡å·çš„ç®¡ç¨‹"></a>ä½¿ç”¨ä¿¡å·çš„ç®¡ç¨‹</h3><p>ç®¡ç¨‹æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªè¿‡ç¨‹ã€ä¸€ä¸ªåˆå§‹åŒ–åºåˆ—å’Œå±€éƒ¨æ•°æ®ç»„æˆçš„è½¯ä»¶æ¨¡å—ï¼Œå…¶ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>å±€éƒ¨æ•°æ®å˜é‡åªèƒ½è¢«ç®¡ç¨‹çš„è¿‡ç¨‹è®¿é—®ï¼Œä»»ä½•å¤–éƒ¨è¿‡ç¨‹éƒ½ä¸èƒ½è®¿é—®ã€‚</li>
<li>ä¸€ä¸ªè¿›ç¨‹é€šè¿‡è°ƒç”¨ç®¡ç¨‹çš„ä¸€ä¸ªè¿‡ç¨‹è¿›å…¥ç®¡ç¨‹ã€‚</li>
<li>åœ¨ä»»ä½•æ—¶å€™ï¼Œåªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨ç®¡ç¨‹ä¸­æ‰§è¡Œï¼Œè°ƒç”¨ç®¡ç¨‹çš„ä»»ä½•å…¶ä»–è¿›ç¨‹éƒ½è¢«é˜»å¡ï¼Œä»¥ç­‰å¾…ç®¡ç¨‹å¯ç”¨ã€‚</li>
</ul>
<p>ä¸ºäº†è¿›è¡Œå¹¶å‘å¤„ç†ï¼Œç®¡ç¨‹å¿…é¡»åŒ…å«åŒæ­¥å·¥å…·ã€‚</p>
<blockquote>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨äº†ç®¡ç¨‹ï¼Œå¹¶ä¸”å½“å®ƒåœ¨ç®¡ç¨‹ä¸­æ—¶å¿…é¡»è¢«æŒ‚èµ·ï¼Œç›´åˆ°æ»¡è¶³æŸäº›æ¡ä»¶ã€‚è¿™å°±éœ€è¦ä¸€ç§æœºåˆ¶ï¼Œä½¿å¾—è¯¥è¿›ç¨‹ä¸ä»…è¢«æŒ‚èµ·ï¼Œè€Œä¸”èƒ½é‡Šæ”¾è¿™ä¸ªç®¡ç¨‹ï¼Œä»¥ä¾¿æŸäº›å…¶ä»–çš„è¿›ç¨‹å¯ä»¥è¿›å…¥ã€‚ä»¥åï¼Œå½“æ¡ä»¶æ»¡è¶³å¹¶ä¸”ç®¡ç¨‹å†æ¬¡å¯ç”¨æ—¶ï¼Œéœ€è¦æ¢å¤è¯¥è¿›ç¨‹å¹¶å…è®¸å®ƒåœ¨æŒ‚èµ·ç‚¹é‡æ–°è¿›å…¥ç®¡ç¨‹ã€‚</p>
</blockquote>
<p>ç®¡ç¨‹é€šè¿‡ä½¿ç”¨æ¡ä»¶å˜é‡æä¾›å¯¹åŒæ­¥çš„æ”¯æŒï¼Œè¿™äº›æ¡ä»¶å˜é‡åŒ…å«åœ¨ç®¡ç¨‹ä¸­ï¼Œå¹¶ä¸”åªæœ‰åœ¨ç®¡ç¨‹ä¸­æ‰èƒ½è¢«è®¿é—®ã€‚æœ‰ä¸¤ä¸ªå‡½æ•°å¯ä»¥æ“ä½œæ¡ä»¶å˜é‡ï¼š</p>
<ul>
<li><p><code>cwait(c)</code>ï¼šè°ƒç”¨è¿›ç¨‹çš„æ‰§è¡Œåœ¨æ¡ä»¶cä¸ŠæŒ‚èµ·ï¼Œç®¡ç¨‹ç°åœ¨å¯è¢«å¦ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚</p>
</li>
<li><p><code>csignal(c)</code>ï¼šæ¢å¤æ‰§è¡Œåœ¨cwaitä¹‹åå› ä¸ºæŸäº›æ¡ä»¶è€ŒæŒ‚èµ·çš„è¿›ç¨‹ã€‚å¦‚æœæœ‰å¤šä¸ªè¿™æ ·çš„è¿›ç¨‹ï¼Œé€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼›å¦‚æœæ²¡æœ‰è¿™æ ·çš„è¿›ç¨‹ï¼Œä»€ä¹ˆä¹Ÿä¸åšã€‚</p>
<blockquote>
<p>æ³¨æ„ç®¡ç¨‹çš„<code>wait</code>å’Œ<code>signal</code>æ“ä½œä¸ä¿¡å·é‡ä¸åŒï¼š</p>
<p>å¦‚æœåœ¨ç®¡ç¨‹ä¸­çš„ä¸€ä¸ªè¿›ç¨‹å‘ä¿¡å·ï¼Œä½†æ²¡æœ‰åœ¨è¿™ä¸ªæ¡ä»¶å˜é‡ä¸Šç­‰å¾…çš„ä»»åŠ¡ï¼Œåˆ™ä¸¢å¼ƒè¿™ä¸ªä¿¡å·ã€‚</p>
</blockquote>
</li>
</ul>
<p>ä¸‹å›¾ç»™å‡ºäº†ä¸€ä¸ªç®¡ç¨‹çš„ç»“æ„ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E7%AE%A1%E7%A8%8B.png"></p>
<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>å°½ç®¡ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é€šè¿‡è°ƒç”¨ç®¡ç¨‹çš„ä»»ä½•ä¸€ä¸ªè¿‡ç¨‹è¿›å…¥ç®¡ç¨‹ï¼Œä½†æˆ‘ä»¬ä»å¯ä»¥æŠŠç®¡ç¨‹æƒ³åƒæˆå…·æœ‰ä¸€ä¸ªå…¥å£ç‚¹ï¼Œå¹¶ä¿è¯ä¸€æ¬¡åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿›å…¥ã€‚å…¶ä»–è¯•å›¾è¿›å…¥ç®¡ç¨‹çš„è¿›ç¨‹è¢«é˜»å¡å¹¶åŠ å…¥ç­‰å¾…ç®¡ç¨‹å¯ç”¨çš„è¿›ç¨‹é˜Ÿåˆ—ä¸­ã€‚å½“ä¸€ä¸ªè¿›ç¨‹åœ¨ç®¡ç¨‹ä¸­æ—¶ï¼Œå®ƒå¯èƒ½ä¼šé€šè¿‡å‘é€cwalt(x)<br>æŠŠè‡ªå·±æš‚æ—¶é˜»å¡åœ¨æ¡ä»¶xä¸Šï¼Œéšåå®ƒè¢«æ”¾å…¥ç­‰å¾…æ¡ä»¶æ”¹å˜ä»¥é‡æ–°è¿›å…¥ç®¡ç¨‹çš„è¿›ç¨‹é˜Ÿåˆ—ä¸­ï¼Œåœ¨cwalt(x)è°ƒç”¨çš„ä¸‹ä¸€æ¡æŒ‡ä»¤å¼€å§‹æ¢å¤æ‰§è¡Œã€‚</p>
<p>å¦‚æœåœ¨ç®¡ç¨‹ä¸­æ‰§è¡Œçš„ä¸€ä¸ªè¿›ç¨‹å‘ç°æ¡ä»¶å˜é‡xå‘ç”Ÿäº†å˜åŒ–ï¼Œå®ƒå‘é€csignal(x)ï¼Œé€šçŸ¥ç›¸åº”çš„æ¡ä»¶é˜Ÿåˆ—æ¡ä»¶å·²æ”¹å˜ã€‚</p>
</blockquote>
<p>ä»¥ä¸‹ä»£ç ç»™å‡ºäº†ä¸€ä¸ªä½¿ç”¨ç®¡ç¨‹çš„ä¾‹å­ï¼Œå†æ¬¡è€ƒè™‘ç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*program producerconsumer*/</span></span><br><span class="line">monitor boundedbuffer;          </span><br><span class="line"><span class="keyword">char</span> buffer [N];          <span class="comment">/*åˆ†é…Nä¸ªæ•°æ®é¡¹ç©ºé—´*/</span></span><br><span class="line"><span class="keyword">int</span> nextin, nextout;          <span class="comment">/*ç¼“å†²åŒºæŒ‡é’ˆ*/</span></span><br><span class="line"><span class="keyword">int</span> count;          <span class="comment">/*ç¼“å†²åŒºä¸­æ•°æ®é¡¹ä¸ªæ•°*/</span></span><br><span class="line">cond notfull, notempty;          <span class="comment">/*ä¸ºåŒæ­¥è®¾ç½®çš„æ¡ä»¶å˜é‡*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">append</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (count == N)&#123;</span><br><span class="line">        cwait(notfull);          <span class="comment">/*ç¼“å†²åŒºæ»¡ï¼Œé˜²æ­¢æº¢å‡º*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    buffer[nextin] = x;</span><br><span class="line">    nextin = (nextin + <span class="number">1</span>) % N;</span><br><span class="line">    count++;</span><br><span class="line">    <span class="comment">/*ç¼“å†²åŒºä¸­æ•°æ®é¡¹ä¸ªæ•°åŠ ä¸€*/</span></span><br><span class="line">    csignal(nonempty);          <span class="comment">/*é‡Šæ”¾ä»»ä½•ä¸€ä¸ªç­‰å¾…çš„è¿›ç¨‹*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">take</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (count == <span class="number">0</span>)&#123;</span><br><span class="line">        cwait(notempty);          <span class="comment">/*ç¼“å†²åŒºç©ºï¼Œé˜²æ­¢ä¸‹æº¢*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    x = buffer[nextout];</span><br><span class="line">    nextout = (nextout + <span class="number">1</span>) % N;</span><br><span class="line">    count--;          <span class="comment">/*ç¼“å†²åŒºä¸­æ•°æ®é¡¹ä¸ªæ•°å‡ä¸€*/</span></span><br><span class="line">    csignal(notfull);          <span class="comment">/*é‡Šæ”¾ä»»ä½•ä¸€ä¸ªç­‰å¾…çš„è¿›ç¨‹*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;          <span class="comment">/*ç®¡ç¨‹ä½“*/</span></span><br><span class="line">    nextin = <span class="number">0</span>; nextout = <span class="number">0</span>; count = <span class="number">0</span>;          <span class="comment">/*ç¼“å†²åŒºåˆå§‹åŒ–ä¸ºç©º*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*producer*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">producer</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> x;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        produce(x);</span><br><span class="line">        append(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*consumer*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">consumer</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> x;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        take(x);</span><br><span class="line">        consume(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    parbegin(producer, consumer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>ç®¡ç¨‹æ¨¡å—boundedbufferæ§åˆ¶ç€ç”¨äºä¿å­˜å’Œå–å›å­—ç¬¦çš„ç¼“å†²åŒºï¼Œç®¡ç¨‹ä¸­æœ‰ä¸¤ä¸ªæ¡ä»¶å˜é‡ï¼ˆä½¿ç”¨ç»“æ„condå£°æ˜ï¼‰ï¼šå½“ç¼“å†²åŒºä¸­è‡³å°‘æœ‰å¢åŠ ä¸€ä¸ªå­—ç¬¦çš„ç©ºé—´æ—¶ï¼Œnotfullä¸ºçœŸï¼›å½“ç¼“å†²åŒºä¸­è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œnotemptyä¸ºçœŸã€‚</p>
<p>ç”Ÿäº§è€…å¯ä»¥é€šè¿‡ç®¡ç¨‹ä¸­çš„è¿‡ç¨‹appendå¾€ç¼“å†²åŒºä¸­å¢åŠ å­—ç¬¦ï¼Œå®ƒä¸èƒ½ç›´æ¥è®¿é—®bufferã€‚è¯¥è¿‡ç¨‹é¦–å…ˆæ£€æŸ¥æ¡ä»¶notfiullï¼Œä»¥ç¡®å®šç¼“å†²åŒºæ˜¯å¦è¿˜æœ‰å¯ç”¨ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰ï¼Œæ‰§è¡Œç®¡ç¨‹çš„è¿›ç¨‹åœ¨è¿™ä¸ªæ¡ä»¶ä¸Šè¢«é˜»å¡ã€‚å…¶ä»–æŸä¸ªè¿›ç¨‹ï¼ˆç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…ï¼‰ç°åœ¨å¯ä»¥è¿›å…¥ç®¡ç¨‹ã€‚ç„¶åï¼Œå½“ç¼“å†²åŒºä¸å†æ»¡æ—¶ï¼Œè¢«é˜»å¡è¿›ç¨‹å¯ä»¥ä»é˜Ÿåˆ—ä¸­ç§»å‡ºï¼Œé‡æ–°è¢«æ¿€æ´»ï¼Œå¹¶æ¢å¤å¤„ç†ã€‚åœ¨å¾€ç¼“å†²åŒºä¸­æ”¾ç½®äº†ä¸€ä¸ªå­—ç¬¦åï¼Œè¯¥è¿›ç¨‹å‘é€notemptyæ¡ä»¶ä¿¡å·ã€‚å¯¹æ¶ˆè´¹è€…å‡½æ•°ä¹Ÿå¯ä»¥è¿›è¡Œç±»ä¼¼çš„æè¿°ã€‚</p>
</blockquote>
<h3 id="ä½¿ç”¨é€šçŸ¥å’Œå¹¿æ’­çš„ç®¡ç¨‹"><a href="#ä½¿ç”¨é€šçŸ¥å’Œå¹¿æ’­çš„ç®¡ç¨‹" class="headerlink" title="ä½¿ç”¨é€šçŸ¥å’Œå¹¿æ’­çš„ç®¡ç¨‹"></a>ä½¿ç”¨é€šçŸ¥å’Œå¹¿æ’­çš„ç®¡ç¨‹</h3><p>Hoareå…³äºç®¡ç¨‹çš„å®šä¹‰[HOAR74]è¦æ±‚åœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œå½“å¦ä¸€ä¸ªè¿›ç¨‹ä¸ºè¯¥æ¡ä»¶äº§ç”Ÿcaigna1æ—¶ï¼Œè¯¥é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªè¿›ç¨‹ç«‹å³è¿è¡Œã€‚å› æ­¤ï¼Œäº§ç”Ÿcaigna1çš„è¿›ç¨‹å¿…é¡»ç«‹å³é€€å‡ºç®¡ç¨‹ï¼Œæˆ–è€…é˜»å¡åœ¨ç®¡ç¨‹ä¸Šã€‚</p>
<p>è¿™ç§æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºé™·ï¼š</p>
<ul>
<li>å¦‚æœäº§ç”Ÿcsignalçš„è¿›ç¨‹åœ¨ç®¡ç¨‹å†…è¿˜æ²¡æœ‰ç»“æŸï¼Œåˆ™éœ€è¦ä¸¤ä¸ªé¢å¤–çš„è¿›ç¨‹åˆ‡æ¢ï¼šé˜»å¡è¿™ä¸ªè¿›ç¨‹éœ€è¦ä¸€æ¬¡åˆ‡æ¢ï¼Œå½“ç®¡ç¨‹å¯ç”¨æ—¶æ¢å¤è¿™ä¸ªè¿›ç¨‹åˆéœ€è¦ä¸€æ¬¡åˆ‡æ¢ã€‚</li>
<li>ä¸ä¿¡å·ç›¸å…³çš„è¿›ç¨‹è°ƒåº¦å¿…é¡»éå¸¸å¯é ã€‚å½“äº§ç”Ÿä¸€ä¸ªcsignalæ—¶ï¼Œæ¥è‡ªç›¸åº”æ¡ä»¶é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªè¿›ç¨‹å¿…é¡»ç«‹å³è¢«æ¿€æ´»ï¼Œè°ƒåº¦ç¨‹åºå¿…é¡»ç¡®ä¿åœ¨æ¿€æ´»å‰æ²¡æœ‰å…¶ä»–è¿›ç¨‹è¿›å…¥ç®¡ç¨‹ï¼Œå¦åˆ™ï¼Œè¿›ç¨‹è¢«æ¿€æ´»çš„æ¡ä»¶åˆä¼šæ”¹å˜ã€‚</li>
</ul>
<p>å› æ­¤åˆå¼€å‘å‡ºäº†ä¸€ç§ä¸åŒçš„ç®¡ç¨‹ä»¥è§£å†³ä»¥ä¸Šé—®é¢˜ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">append</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (count == N)&#123;</span><br><span class="line">        cwait(notfull);          <span class="comment">/*ç¼“å†²åŒºæ»¡ï¼Œé˜²æ­¢æº¢å‡º*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    buffer[nextin] = x;</span><br><span class="line">    nextin = (nextin + <span class="number">1</span>) % N;</span><br><span class="line">    count++;          <span class="comment">/*ç¼“å†²åŒºä¸­æ•°æ®é¡¹ä¸ªæ•°åŠ ä¸€*/</span></span><br><span class="line">    cnotify(notempty);          <span class="comment">/*é€šçŸ¥æ­£åœ¨ç­‰å¾…çš„è¿›ç¨‹*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">take</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (count == <span class="number">0</span>)&#123;</span><br><span class="line">        cwait(notempty);          <span class="comment">/*ç¼“å†²åŒºç©ºï¼Œé˜²æ­¢ä¸‹æº¢*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    x = buffer[nextout];</span><br><span class="line">    nextout = (nextout + <span class="number">1</span>) % N;</span><br><span class="line">    count--;          <span class="comment">/*ç¼“å†²åŒºä¸­æ•°æ®é¡¹ä¸ªæ•°å‡ä¸€*/</span></span><br><span class="line">    cnotify(notfull);          <span class="comment">/*é€šçŸ¥æ­£åœ¨ç­‰å¾…çš„è¿›ç¨‹*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>csignalåŸè¯­è¢« cnotifyå–ä»£ã€‚å½“ä¸€ä¸ªæ­£åœ¨ç®¡ç¨‹ä¸­çš„è¿›ç¨‹æ‰§è¡Œcnotify(x)æ—¶ï¼Œå®ƒä½¿å¾—xæ¡ä»¶é˜Ÿåˆ—å¾—åˆ°é€šçŸ¥ï¼Œä½†å‘ä¿¡å·çš„è¿›ç¨‹ç»§ç»­æ‰§è¡Œã€‚é€šçŸ¥çš„ç»“æœæ˜¯ä½¿å¾—ä½äºæ¡ä»¶é˜Ÿåˆ—å¤´çš„è¿›ç¨‹åœ¨å°†æ¥åˆé€‚çš„æ—¶å€™ä¸”å½“å¤„ç†å™¨å¯ç”¨æ—¶è¢«æ¢å¤æ‰§è¡Œã€‚ä½†æ˜¯ï¼Œç”±äºä¸èƒ½ä¿è¯åœ¨å®ƒä¹‹å‰æ²¡æœ‰å…¶ä»–è¿›ç¨‹è¿›å…¥ç®¡ç¨‹ï¼Œå› è€Œè¿™ä¸ªç­‰å¾…è¿›ç¨‹å¿…é¡»é‡æ–°æ£€æŸ¥æ¡ä»¶ã€‚</p>
<p>ifè¯­å¥è¢« whileå¾ªç¯å–ä»£ï¼Œå› æ­¤ï¼Œè¿™ä¸ªæ–¹æ¡ˆå¯¼è‡´å¯¹æ¡ä»¶å˜é‡è‡³å°‘å¤šä¸€æ¬¡é¢å¤–çš„æ£€æµ‹ã€‚ä½œä¸ºå›æŠ¥ï¼Œå®ƒä¸å†æœ‰é¢å¤–çš„è¿›ç¨‹åˆ‡æ¢ï¼Œå¹¶ä¸”å¯¹ç­‰å¾…è¿›ç¨‹åœ¨cnotifyä¹‹åä»€ä¹ˆæ—¶å€™è¿è¡Œæ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚</p>
</blockquote>
<h2 id="æ¶ˆæ¯ä¼ é€’"><a href="#æ¶ˆæ¯ä¼ é€’" class="headerlink" title="æ¶ˆæ¯ä¼ é€’"></a>æ¶ˆæ¯ä¼ é€’</h2><p>è¿›ç¨‹äº¤äº’å¼ï¼Œå¿…é¡»æ»¡è¶³ä¸¤ä¸ªåŸºæœ¬è¦æ±‚ï¼šåŒæ­¥å’Œé€šä¿¡ã€‚ä¸ºå®æ–½äº’æ–¥ï¼Œè¿›ç¨‹é—´éœ€è¦åŒæ­¥ï¼›ä¸ºäº†åˆä½œï¼Œè¿›ç¨‹é—´éœ€è¦äº¤æ¢ä¿¡æ¯ã€‚ä¹‹å‰ä»‹ç»çš„ä¸¤ç§æœºåˆ¶ï¼ˆä¿¡å·é‡ä»¥åŠç®¡ç¨‹ï¼‰å¯ä»¥åœ¨å•å¤„ç†å™¨ç³»ç»Ÿä»¥åŠå¤šå¤„ç†å™¨ç³»ç»Ÿä¸­å®ç°ï¼Œä½†æ˜¯å¯¹äºåˆ†å¸ƒå¼ç³»ç»Ÿè€Œè¨€ï¼Œæ²¡æœ‰åŠæ³•æä¾›æ”¯æŒã€‚æ­¤å¤–ï¼Œç®¡ç¨‹å¯¹ç¼–è¯‘å™¨æœ‰ä¾èµ–ï¼Œè€Œå¾ˆå¤šç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘å™¨å¹¶æ²¡æœ‰æä¾›å¯¹ç®¡ç¨‹çš„æ”¯æŒï¼ˆæ¯”å¦‚gccï¼‰ã€‚ä¸ºæ­¤ï¼Œå¼•å…¥äº†æ¶ˆæ¯ä¼ é€’ã€‚</p>
<p>æ¶ˆæ¯ä¼ é€’çš„å®é™…åŠŸèƒ½ä»¥ä¸€å¯¹åŸè¯­çš„å½¢å¼æä¾›ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">send(destination, message)</span><br><span class="line">receive(source, message)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>è¿™æ˜¯è¿›ç¨‹é—´è¿›è¡Œæ¶ˆæ¯ä¼ é€’æ‰€éœ€è¦çš„æœ€å°æ“ä½œé›†ã€‚ä¸€ä¸ªè¿›ç¨‹ä»¥æ¶ˆæ¯(message)çš„å½¢å¼ç»™å¦ä¸€ä¸ªæŒ‡å®šçš„ç›®æ ‡(destination)è¿›ç¨‹å‘é€ä¿¡æ¯ï¼›è¿›ç¨‹é€šè¿‡æ‰§è¡ŒreceiveåŸè¯­æ¥æ”¶ä¿¡æ¯ï¼ŒreceiveåŸè¯­ä¸­æŒ‡æ˜å‘é€æ¶ˆæ¯çš„æºè¿›ç¨‹(source)å’Œæ¶ˆæ¯ã€‚</p>
<p>sendä¸receiveæ“ä½œæ—¢å¯ä»¥æ˜¯é˜»å¡æ“ä½œä¹Ÿå¯ä»¥æ˜¯éé˜»å¡æ“ä½œï¼š</p>
<ul>
<li><p>é˜»å¡æ“ä½œï¼šåœ¨æ‰§è¡Œä¸€ä¸ªæŒ‡ä»¤æ—¶ï¼Œåœ¨è·å¾—è¿™ä¸ªæŒ‡ä»¤çš„ç»“æœä¹‹å‰ï¼Œç¨‹åºä¸å¾—å‘ä¸‹æ¨è¿›ï¼›</p>
</li>
<li><p>éé˜»å¡æ“ä½œï¼šåœ¨æ‰§è¡Œä¸€ä¸ªæŒ‡ä»¤æ—¶ï¼Œåœ¨è°ƒç”¨è¿™æ¡æŒ‡ä»¤åï¼Œä¸å¾…æŒ‡ä»¤çš„ç»“æœè¿”å›ï¼Œç¨‹åºå¯ä»¥ç«‹å³æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤çš„æ“ä½œæ–¹å¼æˆä¸ºéé˜»å¡æ–¹ã€‚</p>
</li>
</ul>
<blockquote>
<p>å› æ­¤å¯¹äºé˜»å¡send è€Œè¨€ï¼Œå½“ç¨‹åºè°ƒç”¨äº†è¿™æ¡æŒ‡ä»¤åï¼Œåœ¨sendä¸­çš„æ¶ˆæ¯ä¼ é€ç»™æŒ‡å®šè¿›ç¨‹ä¹‹å‰ï¼Œç¨‹åºå§‹ç»ˆåœç•™åœ¨sendæŒ‡ä»¤ä¸Šï¼Œä¸å‘åæ¨è¿›ï¼›</p>
<p>è€Œå¯¹äºéé˜»å¡send,å½“ç¨‹åºè°ƒç”¨è¿™æ¡æŒ‡ä»¤åï¼ŒæŒ‡ä»¤é©¬ä¸Šè¿”å›ï¼Œç«‹å³æ‰§è¡Œåé¢çš„æŒ‡ä»¤ï¼›</p>
<p>åŒç†ï¼Œå¯¹äºreceiveä¹Ÿæ˜¯å¦‚æ­¤ï¼Œé˜»å¡çš„receiveåœ¨æ”¶åˆ°æ¶ˆæ¯ä¹‹å‰ï¼Œç¨‹åºåœç•™åœ¨è¿™æ¡æŒ‡ä»¤ä¹‹ä¸Šä¸ä¼šå‘ä¸‹æ‰§è¡Œï¼Œéé˜»å¡receiveåˆ™æ˜¯è°ƒç”¨æŒ‡ä»¤åï¼Œç«‹å³å‘ä¸‹æ‰§è¡Œã€‚</p>
</blockquote>
</blockquote>
<h3 id="åŒæ­¥ï¼ˆSynchronizationï¼‰"><a href="#åŒæ­¥ï¼ˆSynchronizationï¼‰" class="headerlink" title="åŒæ­¥ï¼ˆSynchronizationï¼‰"></a>åŒæ­¥ï¼ˆSynchronizationï¼‰</h3><p>ä¸¤ä¸ªè¿›ç¨‹é—´çš„æ¶ˆæ¯é€šä¿¡éšå«ç€æŸç§åŒæ­¥çš„ä¿¡æ¯ï¼šåªæœ‰å½“ä¸€ä¸ªè¿›ç¨‹å‘é€æ¶ˆæ¯ä¹‹åï¼Œæ¥æ”¶è€…æ‰èƒ½æ¥æ”¶æ¶ˆæ¯ã€‚</p>
<p>å½“ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œæ—¶ï¼Œåœ¨å®ƒå‘é€<code>send</code>æˆ–<code>receive</code>åŸè¯­æ—¶ï¼Œéƒ½æœ‰é˜»å¡æˆ–ä¸é˜»å¡ä¸¤ç§çŠ¶æ€ï¼Œå› æ­¤ä¼šæœ‰å¦‚ä¸‹å››ç§ç»„åˆï¼š</p>
<ul>
<li><p>æ— é˜»å¡sendï¼Œæ— é˜»å¡receiveï¼š</p>
<p>ç­‰å¾…æ¶ˆæ¯æ¥æ”¶ï¼Œæ”¶åˆ°æ¶ˆæ¯åç»§ç»­æ‰§è¡Œã€‚</p>
</li>
<li><p>é˜»å¡sendï¼Œé˜»å¡receiveï¼š</p>
<p>å‘é€è€…å’Œæ¥æ”¶è€…éƒ½è¢«é˜»å¡ï¼Œç›´åˆ°ä¿¡æ¯è¢«é€è¾¾ã€‚ï¼ˆè¿™ç§æƒ…å†µæœ‰æ—¶ä¹Ÿç§°åšä¼šåˆ(rendezvous)ï¼Œå®ƒè€ƒè™‘åˆ°äº†è¿›ç¨‹é—´çš„ç´§å¯†åŒæ­¥ã€‚ï¼‰</p>
</li>
<li><p>æ— é˜»å¡sendï¼Œé˜»å¡receiveï¼š</p>
<p>å‘é€è€…å¯ä»¥ç»§ç»­ï¼Œä½†æ¥æ”¶è€…è¢«é˜»å¡ç›´åˆ°è¯·æ±‚çš„æ¶ˆæ¯åˆ°è¾¾ã€‚</p>
<blockquote>
<p>è¿™å¯èƒ½æ˜¯æœ€æœ‰ç”¨çš„ä¸€ç§ç»„åˆï¼Œå®ƒå…è®¸ä¸€ä¸ªè¿›ç¨‹ç»™å„ä¸ªç›®æ ‡è¿›ç¨‹å°½å¿«åœ°å‘é€ä¸€æ¡æˆ–å¤šæ¡æ¶ˆæ¯ã€‚åœ¨ç»§ç»­å·¥ä½œå‰å¿…é¡»æ¥æ”¶åˆ°æ¶ˆæ¯çš„è¿›ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°è¿™ä¸ªæ¶ˆæ¯åˆ°è¾¾ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæœåŠ¡å™¨è¿›ç¨‹ç»™å…¶ä»–è¿›ç¨‹æä¾›æœåŠ¡æˆ–èµ„æºã€‚</p>
</blockquote>
</li>
<li><p>é˜»å¡sendï¼Œæ— é˜»å¡receiveï¼š</p>
<p>ä¸è¦æ±‚ä»»ä½•ä¸€æ–¹ç­‰å¾…ã€‚</p>
</li>
</ul>
<p>å¯¹äºå¤§å¤šæ•°å¹¶å‘ç¨‹åºè®¾è®¡ä»»åŠ¡æ¥è¯´ï¼š</p>
<ul>
<li><p>æ— é˜»å¡sendæ˜¯æœ€è‡ªç„¶çš„ï¼š</p>
<blockquote>
<p>ä¾‹å¦‚ï¼Œæ— é˜»å¡sendç”¨äºè¯·æ±‚ä¸€ä¸ªè¾“å‡ºæ“ä½œï¼Œå¦‚æ‰“å°ï¼Œå®ƒå…è®¸è¯·æ±‚è¿›ç¨‹ä»¥æ¶ˆæ¯çš„å½¢å¼å‘å‡ºè¯·æ±‚ï¼Œç„¶åç»§ç»­ã€‚æ— é˜»å¡sendå­˜åœ¨ä¸€ä¸ªæ½œåœ¨çš„å±é™©ï¼šé”™è¯¯ä¼šå¯¼è‡´è¿›ç¨‹é‡å¤åœ°äº§ç”Ÿæ¶ˆæ¯ã€‚ç”±äºå¯¹è¿›ç¨‹æ²¡æœ‰é˜»å¡çš„è¦æ±‚ï¼Œè¿™äº›æ¶ˆæ¯å¯èƒ½ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼ŒåŒ…æ‹¬å¤„ç†å™¨æ—¶é—´å’Œç¼“å†²åŒºç©ºé—´ï¼Œä»è€ŒæŸå®³å…¶ä»–è¿›ç¨‹å’Œæ“ä½œç³»ç»Ÿã€‚åŒæ—¶ï¼Œæ— é˜»å¡sendç»™ç¨‹åºå‘˜å¢åŠ äº†è´Ÿæ‹…ï¼Œç”±äºå¿…é¡»ç¡®å®šæ¶ˆæ¯æ˜¯å¦æ”¶åˆ°ï¼Œå› è€Œè¿›ç¨‹å¿…é¡»ä½¿ç”¨åº”ç­”æ¶ˆæ¯ï¼Œä»¥è¯å®æ”¶åˆ°äº†æ¶ˆæ¯ã€‚</p>
</blockquote>
</li>
<li><p>é˜»å¡receiveæ˜¯æœ€è‡ªç„¶çš„ï¼š</p>
<blockquote>
<p>é€šå¸¸ï¼Œè¯·æ±‚ä¸€ä¸ªæ¶ˆæ¯çš„è¿›ç¨‹éƒ½éœ€è¦è¿™ä¸ªæœŸæœ›çš„ä¿¡æ¯æ‰èƒ½ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œä½†æ˜¯ï¼Œå¦‚æœæ¶ˆæ¯ä¸¢å¤±äº†ï¼ˆè¿™åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¾ˆå¯èƒ½å‘ç”Ÿï¼‰ï¼Œæˆ–è€…ä¸€ä¸ªè¿›ç¨‹åœ¨å‘é€é¢„æœŸçš„æ¶ˆæ¯ä¹‹å‰å¤±è´¥äº†ï¼Œé‚£ä¹ˆæ¥æ”¶è¿›ç¨‹å°†ä¼šæ— é™æœŸåœ°è¢«é˜»å¡ä¸‹å»ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ä½¿ç”¨æ— é˜»å¡receiveæ¥è§£å†³ã€‚ä½†æ˜¯ï¼Œè¯¥æ–¹æ³•çš„å±é™©æ˜¯ï¼Œå¦‚æœæ¶ˆæ¯çš„å‘é€åœ¨ä¸€ä¸ªè¿›ç¨‹å·²ç»æ‰§è¡Œäº†ä¸ä¹‹ç›¸åŒ¹é…çš„receiveä¹‹åï¼Œè¯¥æ¶ˆæ¯å°†è¢«ä¸¢å¤±ã€‚å…¶ä»–å¯èƒ½çš„æ–¹æ³•æ˜¯å…è®¸ä¸€ä¸ªè¿›ç¨‹åœ¨å‘å‡ºreceiveä¹‹å‰æ£€æµ‹æ˜¯å¦æœ‰æ¶ˆæ¯æ­£åœ¨ç­‰å¾…ï¼Œæˆ–è€…å…è®¸è¿›ç¨‹åœ¨receiveåŸè¯­ä¸­ç¡®å®šå¤šä¸ªæºè¿›ç¨‹ã€‚å¦‚æœä¸€ä¸ªè¿›ç¨‹æ­£åœ¨ç­‰å¾…ä»å¤šä¸ªæºè¿›ç¨‹å‘é€æ¥çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”åªè¦æœ‰ä¸€ä¸ªæ¶ˆæ¯åˆ°è¾¾å°±å¯ä»¥ç»§ç»­ä¸‹å»æ—¶ï¼Œåä¸€ç§æ–¹æ³•æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p>
</blockquote>
</li>
</ul>
<h3 id="å¯»å€ï¼ˆAddressingï¼‰"><a href="#å¯»å€ï¼ˆAddressingï¼‰" class="headerlink" title="å¯»å€ï¼ˆAddressingï¼‰"></a>å¯»å€ï¼ˆAddressingï¼‰</h3><p>æ˜¾ç„¶ï¼Œåœ¨sendåŸè¯­ä¸­ç¡®å®šå“ªä¸ªè¿›ç¨‹æ¥æ”¶æ¶ˆæ¯æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚åŒæ ·ï¼Œå¤§å¤šæ•°å®ç°å…è®¸æ¥æ”¶è¿›ç¨‹æŒ‡æ˜æ¶ˆæ¯çš„æ¥æºã€‚</p>
<p>åœ¨sendå’ŒreceiveåŸè¯­ä¸­ç¡®å®šç›®æ ‡æˆ–æºè¿›ç¨‹çš„æ–¹æ¡ˆå¯åˆ†ä¸ºä¸¤ç±»ï¼š<strong>ç›´æ¥å¯»å€</strong>ï¼ˆdirect addressingï¼‰å’Œ<strong>é—´æ¥å¯»å€</strong>ï¼ˆindirect addressingï¼‰ã€‚</p>
<ul>
<li><p>ç›´æ¥å¯»å€ï¼š</p>
<p>sendåŸè¯­åŒ…å«ç›®æ ‡è¿›ç¨‹çš„æ ‡è¯†ç¬¦ï¼Œè€ŒreceiveåŸè¯­æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š</p>
<ul>
<li>æ˜¾ç¤ºå¯»å€ï¼šä¸€ä¸ªè¿›ç¨‹å¿…é¡»äº‹å…ˆçŸ¥é“å¸Œæœ›å¾—åˆ°æ¥è‡ªå“ªä¸ªæºè¿›ç¨‹çš„æ¶ˆæ¯ï¼Œè¿™ç§æ–¹å¼å¯¹äºå¤„ç†å¹¶å‘è¿›ç¨‹é—´çš„åˆä½œæ˜¯éå¸¸æœ‰æ•ˆçš„ã€‚</li>
<li>éšå¼å¯»å€ï¼šä¾‹å¦‚æ‰“å°æœºæœåŠ¡å™¨è¿›ç¨‹å°†æ¥å—æ¥è‡ªå„ä¸ªè¿›ç¨‹çš„æ‰“å°è¯·æ±‚ï¼Œå¯¹è¿™ç±»åº”ç”¨ä½¿ç”¨éšå¼å¯»å€æ›´ä¸ºæœ‰æ•ˆã€‚ï¼ˆä¸å¯èƒ½æŒ‡å®šæ‰€æœŸæœ›çš„æºè¿›ç¨‹ï¼‰</li>
</ul>
</li>
<li><p>é—´æ¥å¯»å€ï¼š</p>
<p>åœ¨è¿™ç§æƒ…å†µï¼Œæ¶ˆæ¯ä¸æ˜¯ç›´æ¥ä»å‘é€è€…å‘é€åˆ°æ¥æ”¶è€…ï¼Œè€Œæ˜¯å‘é€åˆ°ä¸€ä¸ªå…±äº«æ•°æ®ç»“æ„ï¼Œè¯¥ç»“æ„ç”±ä¸´æ—¶ä¿å­˜æ¶ˆæ¯çš„é˜Ÿåˆ—ç»„æˆï¼Œè¿™äº›é˜Ÿåˆ—é€šå¸¸ç§°ä¸º**é‚®ç®±(mailbox)**ã€‚å› æ­¤ï¼Œå¯¹ä¸¤ä¸ªé€šä¿¡è¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹ç»™åˆé€‚çš„é‚®ç®±å‘é€æ¶ˆæ¯ï¼Œå¦ä¸€ä¸ªä»é‚®ç®±ä¸­è·å¾—è¿™äº›æ¶ˆæ¯ã€‚</p>
<blockquote>
<p>é—´æ¥å¯»å€é€šè¿‡è§£é™¤å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œåœ¨æ¶ˆæ¯çš„ä½¿ç”¨ä¸Šå…è®¸æ›´å¤§çš„çµæ´»æ€§ã€‚å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„å…³ç³»å¯ä»¥æ˜¯ä¸€å¯¹ä¸€ã€å¤šå¯¹ä¸€ã€ä¸€å¯¹å¤šæˆ–å¤šå¯¹å¤šï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OSAddressing.png"></p>
<ul>
<li>ä¸€å¯¹ä¸€çš„å…³ç³»å…è®¸åœ¨ä¸¤ä¸ªè¿›ç¨‹é—´å»ºç«‹ä¸“ç”¨çš„é€šä¿¡é“¾æ¥ï¼Œè¿™å¯ä»¥æŠŠå®ƒä»¬ä¹‹é—´çš„äº¤äº’éš”ç¦»èµ·æ¥ï¼Œé¿å…å…¶ä»–è¿›ç¨‹çš„é”™è¯¯å¹²æ‰°ï¼›</li>
<li>å¤šå¯¹ä¸€çš„å…³ç³»å¯¹å®¢æˆ·/æœåŠ¡å™¨é—´çš„äº¤äº’éå¸¸æœ‰ç”¨ï¼Œä¸€ä¸ªè¿›ç¨‹ç»™è®¸å¤šåˆ«çš„è¿›ç¨‹æä¾›æœåŠ¡ï¼Œè¿™æ—¶ï¼Œä¿¡ç®±å¸¸å¸¸ç§°ä¸ºä¸€ä¸ªç«¯å£ï¼ˆportï¼‰ï¼›</li>
<li>ä¸€å¯¹å¤šçš„å…³ç³»é€‚ç”¨äºä¸€ä¸ªå‘é€è€…å’Œå¤šä¸ªæ¥æ”¶è€…ï¼Œå®ƒå¯¹äºåœ¨ä¸€ç»„è¿›ç¨‹é—´å¹¿æ’­ä¸€æ¡æ¶ˆæ¯æˆ–æŸäº›ä¿¡æ¯çš„åº”ç”¨ç¨‹åºéå¸¸æœ‰ç”¨ï¼›</li>
<li>å¤šå¯¹å¤šçš„å…³ç³»ä½¿å¾—å¤šä¸ªæœåŠ¡è¿›ç¨‹å¯ä»¥å¯¹å¤šä¸ªå®¢æˆ·è¿›ç¨‹æä¾›æœåŠ¡ã€‚</li>
</ul>
<p>è¿›ç¨‹å’Œä¿¡ç®±çš„å…³è”å¯ä»¥æ˜¯é™æ€çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åŠ¨æ€çš„ã€‚ç«¯å£å¸¸å¸¸æ˜¯é™æ€åœ°å…³è”åˆ°ä¸€ä¸ªç‰¹å®šçš„è¿›ç¨‹ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç«¯å£æ˜¯è¢«æ°¸ä¹…åœ°åˆ›å»ºå¹¶æŒ‡å®šåˆ°è¯¥è¿›ç¨‹ã€‚ï¼ˆåœ¨ä¸€å¯¹ä¸€çš„å…³ç³»ä¸­å°±æ˜¯å…¸å‹çš„é™æ€å’Œæ°¸ä¹…æ€§çš„å…³ç³»ï¼‰</p>
</blockquote>
</li>
</ul>
<h3 id="æ¶ˆæ¯æ ¼å¼"><a href="#æ¶ˆæ¯æ ¼å¼" class="headerlink" title="æ¶ˆæ¯æ ¼å¼"></a>æ¶ˆæ¯æ ¼å¼</h3><p>æ¶ˆæ¯çš„æ ¼å¼å–å†³äºæ¶ˆæ¯æœºåˆ¶çš„ç›®æ ‡ä»¥åŠè¯¥æœºåˆ¶æ˜¯è¿è¡Œåœ¨ä¸€å°è®¡ç®—æœºä¸Šè¿˜æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ã€‚</p>
<blockquote>
<p>å¯¹æŸäº›æ“ä½œç³»ç»Ÿï¼Œè®¾è®¡è€…ä¼˜å…ˆé€‰ç”¨çŸ­çš„ã€å›ºå®šé•¿åº¦çš„æ¶ˆæ¯ï¼Œä»¥å‡å°‘å¤„ç†å’Œå­˜å‚¨çš„å¼€é”€ã€‚å¦‚æœéœ€è¦ä¼ é€’å¤§é‡çš„æ•°æ®ï¼Œæ•°æ®å¯ä»¥æ”¾ç½®åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¶ˆæ¯å¯ä»¥ç®€å•åœ°å¼•ç”¨è¯¥æ–‡ä»¶ã€‚ä¸€ç§æ›´çµæ´»çš„æ–¹æ³•æ˜¯å…è®¸å¯å˜é•¿åº¦çš„æ¶ˆæ¯ã€‚</p>
</blockquote>
<p>ä¸‹å›¾ç»™å‡ºäº†ä¸€ç§æ“ä½œç³»ç»Ÿçš„æ”¯æŒå¯å˜é•¿åº¦æ¶ˆæ¯çš„å…¸å‹æ¶ˆæ¯æ ¼å¼ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F.png"></p>
<blockquote>
<p>è¯¥æ¶ˆæ¯è¢«åˆ’åˆ†æˆä¸¤éƒ¨åˆ†ï¼šåŒ…å«ç›¸å…³ä¿¡æ¯çš„æ¶ˆæ¯å¤´å’ŒåŒ…å«å®é™…å†…å®¹çš„æ¶ˆæ¯ä½“ã€‚</p>
<ul>
<li>æ¶ˆæ¯å¤´ç”¨æ¥å­˜æ”¾ç”¨äºæ§åˆ¶æ¶ˆæ¯ä¼ é€’çš„ä¿¡æ¯ã€‚</li>
<li>æ¶ˆæ¯ä½“ç”¨æ¥å­˜æ”¾è¿›ç¨‹é—´è¿›ç¨‹é—´é€šè®¯çš„å†…å®¹ã€‚</li>
</ul>
<p>æ¶ˆæ¯å¤´å¯ä»¥åŒ…å«æ¶ˆæ¯çš„æºå’Œç›®æ ‡çš„æ ‡è¯†ç¬¦ã€é•¿åº¦åŸŸå’Œåˆ¤å®šå„ç§æ¶ˆæ¯ç±»å‹çš„ç±»å‹åŸŸï¼Œè¿˜å¯èƒ½å«æœ‰ä¸€äº›é¢å¤–çš„æ§åˆ¶ä¿¡æ¯ã€‚ï¼ˆä¾‹å¦‚ç”¨äºåˆ›å»ºæ¶ˆæ¯é“¾è¡¨çš„æŒ‡é’ˆåŸŸã€è®°å½•æºå’Œç›®æ ‡ä¹‹é—´ä¼ é€’çš„æ¶ˆæ¯çš„æ•°ç›®ã€é¡ºåºå’Œåºå·ï¼Œä»¥åŠä¸€ä¸ªä¼˜å…ˆçº§åŸŸï¼‰</p>
</blockquote>
<h3 id="æ’é˜ŸåŸåˆ™"><a href="#æ’é˜ŸåŸåˆ™" class="headerlink" title="æ’é˜ŸåŸåˆ™"></a>æ’é˜ŸåŸåˆ™</h3><p>æœ€ç®€å•çš„æ’é˜ŸåŸåˆ™æ˜¯å…ˆè¿›å…ˆå‡ºåŸåˆ™ï¼Œä½†æ˜¯å½“æŸäº›æ¶ˆæ¯æ¯”å…¶ä»–æ¶ˆæ¯æ›´ç´§æ€¥æ—¶ï¼Œä»…æœ‰è¿™ç§åŸåˆ™æ˜¯ä¸å¤Ÿçš„ã€‚ä¸€ä¸ªå¯é€‰çš„åŸåˆ™æ˜¯å…è®¸æŒ‡å®šæ¶ˆæ¯çš„ä¼˜å…ˆçº§ï¼Œè¿™å¯ä»¥åŸºäºæ¶ˆæ¯çš„ç±»å‹æˆ–è€…ç”±å‘é€è€…æŒ‡å®šï¼Œå¦ä¸€ç§é€‰æ‹©æ˜¯å…è®¸æ¥æ”¶è€…æ£€æŸ¥æ¶ˆæ¯é˜Ÿåˆ—å¹¶é€‰æ‹©ä¸‹ä¸€æ¬¡æ¥æ”¶å“ªä¸ªæ¶ˆæ¯ã€‚</p>
<h3 id="äº’æ–¥-1"><a href="#äº’æ–¥-1" class="headerlink" title="äº’æ–¥"></a>äº’æ–¥</h3><p>ä»¥ä¸‹ä»£ç ç»™å‡ºäº†å¯ç”¨äºå®æ–½äº’æ–¥çš„æ¶ˆæ¯ä¼ é€’æ–¹å¼ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*program mutualexclusion*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> n = <span class="comment">/*è¿›ç¨‹æ•°*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> p(<span class="keyword">int</span> i)</span><br><span class="line">&#123;</span><br><span class="line">    message msg;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        receive (box, msg);</span><br><span class="line">        <span class="comment">/*ä¸´ç•ŒåŒº*/</span>;</span><br><span class="line">        send (box, msg);</span><br><span class="line">        <span class="comment">/*å…¶ä»–éƒ¨åˆ†*/</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">creat <span class="title">mailbox</span> <span class="params">(box)</span></span>;</span><br><span class="line">    send (box, null);</span><br><span class="line">    prabeginc(P(<span class="number">1</span>), P(<span class="number">2</span>),...,P(n));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>å‡è®¾ä½¿ç”¨é˜»å¡ receiveåŸè¯­å’Œæ— é˜»å¡ sendåŸè¯­ï¼Œä¸€ç»„å¹¶å‘è¿›ç¨‹å…±äº«ä¸€ä¸ªä¿¡ç®±boxï¼Œå®ƒå¯ä¾›æ‰€æœ‰è¿›ç¨‹åœ¨å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ—¶ä½¿ç”¨ï¼Œè¯¥ä¿¡ç®±è¢«åˆå§‹åŒ–æˆä¸€ä¸ªæ— å†…å®¹çš„æ¶ˆæ¯ã€‚å¸Œæœ›è¿›äººä¸´ç•ŒåŒºçš„è¿›ç¨‹é¦–å…ˆè¯•å›¾æ¥æ”¶ä¸€æ¡æ¶ˆæ¯ï¼Œå¦‚æœä¿¡ç®±ä¸ºç©ºï¼Œåˆ™è¯¥è¿›ç¨‹è¢«é˜»å¡ï¼›ä¸€æ—¦è¿›ç¨‹è·å¾—æ¶ˆæ¯ï¼Œå®ƒæ‰§è¡Œå®ƒçš„ä¸´ç•ŒåŒºï¼Œç„¶åæŠŠè¯¥æ¶ˆæ¯æ”¾å›ä¿¡ç®±ã€‚å› æ­¤ï¼Œæ¶ˆæ¯å‡½æ•°å¯ä»¥çœ‹åšæ˜¯åœ¨è¿›ç¨‹ä¹‹é—´ä¼ é€’çš„ä¸€ä¸ªä»¤ç‰Œã€‚</p>
<p>ä¸Šé¢çš„è§£å†³æ–¹æ¡ˆå‡è®¾æœ‰å¤šä¸ªè¿›ç¨‹å¹¶å‘åœ°æ‰§è¡Œæ¥æ”¶æ“ä½œï¼Œåˆ™ï¼š</p>
<ul>
<li>å¦‚æœæœ‰ä¸€æ¡æ¶ˆæ¯ï¼Œå®ƒä»…ä»…è¢«ä¼ é€’ç»™ä¸€ä¸ªè¿›ç¨‹ï¼Œå…¶ä»–è¿›ç¨‹è¢«é˜»å¡ã€‚</li>
<li>å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—ä¸ºç©ºï¼Œæ‰€æœ‰è¿›ç¨‹è¢«é˜»å¡ï¼›å½“æœ‰ä¸€æ¡æ¶ˆæ¯å¯ç”¨æ—¶ï¼Œåªæœ‰ä¸€ä¸ªé˜»å¡è¿›ç¨‹è¢«æ¿€æ´»ï¼Œå¹¶å¾—åˆ°è¿™æ¡æ¶ˆæ¯ã€‚</li>
</ul>
</blockquote>
<p>ä½œä¸ºä½¿ç”¨æ¶ˆæ¯ä¼ é€’çš„å¦ä¸€ä¸ªä¾‹å­ï¼Œä»¥ä¸‹ä»£ç æ˜¯è§£å†³æœ‰ç•Œç¼“å†²åŒºç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜çš„ä¸€ç§æ–¹æ³•ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span></span><br><span class="line">    capacity = <span class="comment">/*ç¼“å†²åŒºå®¹é‡*/</span></span><br><span class="line">    null = <span class="comment">/*ç©ºæ¶ˆæ¯*/</span></span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*producer*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">producer</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    message pmsg;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        receive (mayproduce, pmsg);</span><br><span class="line">        pmsg = produce();</span><br><span class="line">        send (mayconsume, pmsg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*consumer*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">consumer</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    message cmsg;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        receive (mayconsume, cmsg);</span><br><span class="line">        consume (cmsg);</span><br><span class="line">        send (mayproduce, null);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    create_mailbox (mayproduce);</span><br><span class="line">    create_mailbox (mayconsume);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= capacity; i++)&#123;</span><br><span class="line">        send (mayproduce, null);</span><br><span class="line">    &#125;</span><br><span class="line">    parbegin (producer, consumer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>å®ƒä½¿ç”¨äº†ä¸¤ä¸ªä¿¡ç®±ã€‚å½“ç”Ÿäº§è€…äº§ç”Ÿäº†æ•°æ®ï¼Œå®ƒä½œä¸ºæ¶ˆæ¯è¢«å‘é€åˆ°ä¿¡ç®±mayconsumeï¼Œåªè¦è¯¥ä¿¡ç®±ä¸­æœ‰ä¸€æ¡æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…å°±å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ä»æ­¤ä¹‹åmayconsumeä½œä¸ºç¼“å†²åŒºï¼Œç¼“å†²åŒºä¸­çš„æ•°æ®è¢«ç»„ç»‡æˆæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç¼“å†²åŒºçš„å¤§å°ç”±å…¨å±€å˜é‡capacityç¡®å®šã€‚ä¿¡ç®±mayproduceæœ€åˆå¡«æ»¡äº†ç©ºæ¶ˆæ¯ï¼Œç©ºæ¶ˆæ¯çš„æ•°é‡ç­‰äºä¿¡ç®±çš„å®¹é‡ï¼Œæ¯æ¬¡ç”Ÿäº§ä½¿å¾—mayproduceä¸­çš„æ¶ˆæ¯æ•°ç¼©å°ï¼Œæ¯æ¬¡æ¶ˆè´¹ä½¿å¾—mayproduceä¸­çš„æ¶ˆæ¯æ•°å¢é•¿ã€‚</p>
<p>è¿™ç§æ–¹æ³•éå¸¸çµæ´»ï¼Œå¯ä»¥æœ‰å¤šä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œåªè¦å®ƒä»¬éƒ½è®¿é—®è¿™ä¸¤ä¸ªä¿¡ç®±å³å¯ã€‚ç³»ç»Ÿç”šè‡³å¯ä»¥æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæ‰€æœ‰ç”Ÿäº§è€…è¿›ç¨‹å’Œmayproduceä¿¡ç®±åœ¨ä¸€ä¸ªç«™ç‚¹ä¸Šï¼Œæ‰€æœ‰æ¶ˆè´¹è€…è¿›ç¨‹å’Œmayconsumeä¿¡ç®±åœ¨å¦ä¸€ä¸ªç«™ç‚¹ä¸Šã€‚</p>
</blockquote>
<hr>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>æœ¬ç¯‡å·²å®Œç»“</p>
<p>ï¼ˆå¦‚æœ‰ä¿®æ”¹æˆ–è¡¥å……æ¬¢è¿è¯„è®ºï¼‰</p>

    </div>

    
    
    
      
  <div class="popular-posts-header">ç›¸å…³æ–‡ç« </div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\next\2021\03\28\æ“ä½œç³»ç»Ÿ\æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°\" rel="bookmark">æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\next\2021\06\09\æ“ä½œç³»ç»Ÿ\æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-æ–‡ä»¶ç®¡ç†\" rel="bookmark">æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-æ–‡ä»¶ç®¡ç†</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\next\2021\06\02\æ“ä½œç³»ç»Ÿ\æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-I-Oç®¡ç†å’Œç£ç›˜è°ƒåº¦\" rel="bookmark">æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-I/Oç®¡ç†å’Œç£ç›˜è°ƒåº¦</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\next\2021\05\30\æ“ä½œç³»ç»Ÿ\æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å•å¤„ç†å™¨è°ƒåº¦\" rel="bookmark">æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-å•å¤„ç†å™¨è°ƒåº¦</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\next\2021\05\24\æ“ä½œç³»ç»Ÿ\æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-è™šæ‹Ÿå†…å­˜\" rel="bookmark">æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-è™šæ‹Ÿå†…å­˜</a></div>
    </li>
  </ul>


    <footer class="post-footer">
          <div class="reward-container">
  <div></div>
  <button>
    èµèµ
  </button>
  <div class="post-reward">
      <div>
        <img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/wechat.png" alt="èŠ±çŒª å¾®ä¿¡">
        <span>å¾®ä¿¡</span>
      </div>
      <div>
        <img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/alipay.jpg" alt="èŠ±çŒª æ”¯ä»˜å®">
        <span>æ”¯ä»˜å®</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/next/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag"><i class="fa fa-tag"></i> æ“ä½œç³»ç»Ÿ</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/next/2021/04/09/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%BA%BF%E7%A8%8B%E3%80%81%E5%AF%B9%E7%A7%B0%E5%A4%9A%E5%A4%84%E7%90%86%EF%BC%88SMP%EF%BC%89%E5%92%8C%E5%BE%AE%E5%86%85%E6%A0%B8/" rel="prev" title="æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-çº¿ç¨‹ã€å¯¹ç§°å¤šå¤„ç†ï¼ˆSMPï¼‰å’Œå¾®å†…æ ¸">
                  <i class="fa fa-chevron-left"></i> æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-çº¿ç¨‹ã€å¯¹ç§°å¤šå¤„ç†ï¼ˆSMPï¼‰å’Œå¾®å†…æ ¸
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/next/2021/04/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BF%A1%E5%8F%B7%E9%87%8F%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/" rel="next" title="æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-ä¿¡å·é‡ç›¸å…³é—®é¢˜">
                  æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°-ä¿¡å·é‡ç›¸å…³é—®é¢˜ <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments"><div id="twikoo-comments"></div></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">èŠ±çŒª</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">356k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">5:23</span>
  </span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener external nofollow noreferrer" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/next/js/comments.js"></script><script src="/next/js/utils.js"></script><script src="/next/js/motion.js"></script><script src="/next/js/schemes/muse.js"></script><script src="/next/js/next-boot.js"></script><script src="/next/js/pjax.js"></script>

  
<script src="/next/js/third-party/search/local-search.js"></script>




  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"dh8GVAcIwU1TN4zhA5y63iW1-gzGzoHsz","app_key":"hzyAqDKjG4OBGrdPS7mKaOa7","server_url":null,"security":true}</script>
  <script src="/next/js/third-party/statistics/lean-analytics.js"></script>


  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/next/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="twikoo" type="application/json">{"enable":true,"visitor":true,"envId":"hexo-1g41404w9f800e94","el":"#twikoo-comments"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.twikoo.el)
    .then(() => NexT.utils.getScript(
      'https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js',
      { condition: window.twikoo }
    ))
    .then(() => {
      twikoo.init(CONFIG.twikoo);
    });
});
</script>

<!-- hexo injector body_end start --><script data-pjax>
                        function butterfly_swiper_injector_config(){
                          var parent_div_git = document.getElementById('recent-posts');
                          var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/03/28/Hexoé­”æ”¹/Hexoé­”æ”¹è®°å½•/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage4.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-03-28</span><a class="blog-slider__title" href="2021/03/28/Hexoé­”æ”¹/Hexoé­”æ”¹è®°å½•/" alt="">Hexoé­”æ”¹è®°å½•</a><div class="blog-slider__text">Hexoé­”æ”¹è®°å½•</div><a class="blog-slider__button" href="2021/03/28/Hexoé­”æ”¹/Hexoé­”æ”¹è®°å½•/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/08/02/Vue/Vueå­¦ä¹ ç¬”è®°/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage5.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-08-02</span><a class="blog-slider__title" href="2021/08/02/Vue/Vueå­¦ä¹ ç¬”è®°/" alt="">Vueå­¦ä¹ ç¬”è®°</a><div class="blog-slider__text">æœ¬æ–‡å°†ä»‹ç»Vueçš„åŸºç¡€è¯­æ³•</div><a class="blog-slider__button" href="2021/08/02/Vue/Vueå­¦ä¹ ç¬”è®°/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/03/28/Java/Javaå­¦ä¹ è®°å½•/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage8.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-03-28</span><a class="blog-slider__title" href="2021/03/28/Java/Javaå­¦ä¹ è®°å½•/" alt="">Javaå­¦ä¹ è®°å½•</a><div class="blog-slider__text">Javaå­¦ä¹ è®°å½•</div><a class="blog-slider__button" href="2021/03/28/Java/Javaå­¦ä¹ è®°å½•/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/03/28/æ“ä½œç³»ç»Ÿ/æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage7.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-03-28</span><a class="blog-slider__title" href="2021/03/28/æ“ä½œç³»ç»Ÿ/æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°/" alt="">æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°</a><div class="blog-slider__text">è®°å½•æ“ä½œç³»ç»Ÿå­¦ä¹ å†ç¨‹</div><a class="blog-slider__button" href="2021/03/28/æ“ä½œç³»ç»Ÿ/æ“ä½œç³»ç»Ÿå­¦ä¹ ç¬”è®°/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/03/28/è®¡ç®—æœºç½‘ç»œ/è®¡ç®—æœºç½‘ç»œå­¦ä¹ ç¬”è®°/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage3.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-03-28</span><a class="blog-slider__title" href="2021/03/28/è®¡ç®—æœºç½‘ç»œ/è®¡ç®—æœºç½‘ç»œå­¦ä¹ ç¬”è®°/" alt="">è®¡ç®—æœºç½‘ç»œå­¦ä¹ ç¬”è®°</a><div class="blog-slider__text">è®°å½•è®¡ç®—æœºç½‘ç»œå­¦ä¹ å†ç¨‹</div><a class="blog-slider__button" href="2021/03/28/è®¡ç®—æœºç½‘ç»œ/è®¡ç®—æœºç½‘ç»œå­¦ä¹ ç¬”è®°/" alt="">è¯¦æƒ…   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
                          console.log('å·²æŒ‚è½½butterfly_swiper')
                          // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // æ— æŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨(æ”¯æŒpjaxè·³è½¬)
                          parent_div_git.insertAdjacentHTML("afterbegin",item_html) // æœ‰æŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨(æ”¯æŒpjaxè·³è½¬)
                          }
                        if( document.getElementById('recent-posts') && (location.pathname ==='all'|| 'all' ==='all')){
                        butterfly_swiper_injector_config()
                        }
                      </script><script defer src="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body>
</html>
</div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div><div id="comment-switch"><span class="first-comment">Twikoo</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg" onerror="this.onerror=null;this.src='/butterfly/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">èŠ±çŒª</div><div class="author-info__description">å¯„ç»™ä½ ï¼Œè¿™ç‰‡å°å°çš„é“¶æå¶<br>å®ƒä»€ä¹ˆä¹Ÿä¸æš—ç¤ºï¼Œå› ä¸ºæ˜¯ç§‹å¤©äº†</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/butterfly/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">82</div></a></div><div class="card-info-data-item is-center"><a href="/butterfly/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a></div><div class="card-info-data-item is-center"><a href="/butterfly/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/CNhuazhu"><i class="fab fa-github"></i><span>æˆ‘çš„github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/CNhuazhu" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">èŠ±çŒªåœ¨æ­¤æ¬¢è¿æ‚¨å…‰ä¸´å°ç ´ç«™ (Õâ€¢ê™ªâ€¢Õ) <br><br>  <b><i>æœ¬ç«™å·²æ›´æ–°åŸŸå</i></b>ï¼š<a href="https://cnhuazhu.top">https://cnhuazhu.top</a> <br>  <b><i>ç äº‘åœ°å€ï¼ˆåŒæ­¥æ›´æ–°ï¼‰</i></b>ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://cnhuazhu.gitee.io">https://cnhuazhu.gitee.io</a> <br><br>  æœ¬ç«™ä¸»é¢˜ï¼šButterfly 3.7.8 <br> <img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/pig.gif"></div><timing></timing></div><div class="card-widget card-ip"><div class="card-content"></div><div class="item-headline"><i class="fa fa-user" aria-hidden="true"></i><span>å½“å‰è®¿é—®ç”¨æˆ·</span></div><div class="ip_content">æ¬¢è¿æ¥è‡ª <span class="p red">æœªçŸ¥åŒºåŸŸ</span> çš„å°ä¼™ä¼´<br/>è®¿é—®IPä¸ºï¼š <span class="p cyan">æœªçŸ¥IP</span><br/>æµè§ˆå™¨ç‰ˆæœ¬ï¼š<span class="p blue">æœªçŸ¥æµè§ˆå™¨</span></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/butterfly/2021/10/12/Hexo%E9%83%A8%E7%BD%B2%E8%87%B3%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88Ubuntu-20-04%EF%BC%89/" title="Hexoéƒ¨ç½²è‡³æœåŠ¡å™¨ï¼ˆUbuntu 20.04ï¼‰"><img src="https://gitee.com/CNhuazhu/tu-chuang1/raw/master/img-blog/Ubuntu_Server_cover.jpg" onerror="this.onerror=null;this.src='/butterfly/img/404.jpg'" alt="Hexoéƒ¨ç½²è‡³æœåŠ¡å™¨ï¼ˆUbuntu 20.04ï¼‰"/></a><div class="content"><a class="title" href="/butterfly/2021/10/12/Hexo%E9%83%A8%E7%BD%B2%E8%87%B3%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88Ubuntu-20-04%EF%BC%89/" title="Hexoéƒ¨ç½²è‡³æœåŠ¡å™¨ï¼ˆUbuntu 20.04ï¼‰">Hexoéƒ¨ç½²è‡³æœåŠ¡å™¨ï¼ˆUbuntu 20.04ï¼‰</a><time datetime="2021-10-12T07:13:40.000Z" title="å‘è¡¨äº 2021-10-12 15:13:40">2021-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/butterfly/2021/09/26/CSS/CSS%E9%80%89%E6%8B%A9%E5%99%A8/" title="CSSé€‰æ‹©å™¨"><img src="https://gitee.com/CNhuazhu/tu-chuang1/raw/master/img-blog/CSS3cover.jpg" onerror="this.onerror=null;this.src='/butterfly/img/404.jpg'" alt="CSSé€‰æ‹©å™¨"/></a><div class="content"><a class="title" href="/butterfly/2021/09/26/CSS/CSS%E9%80%89%E6%8B%A9%E5%99%A8/" title="CSSé€‰æ‹©å™¨">CSSé€‰æ‹©å™¨</a><time datetime="2021-09-26T09:08:37.000Z" title="å‘è¡¨äº 2021-09-26 17:08:37">2021-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/butterfly/2021/08/19/Vue/Vue%E5%AD%A6%E4%B9%A0-axios/" title="Vueå­¦ä¹ -axios"><img src="https://gitee.com/CNhuazhu/tu-chuang1/raw/master/img-blog/Vuecover.jpg" onerror="this.onerror=null;this.src='/butterfly/img/404.jpg'" alt="Vueå­¦ä¹ -axios"/></a><div class="content"><a class="title" href="/butterfly/2021/08/19/Vue/Vue%E5%AD%A6%E4%B9%A0-axios/" title="Vueå­¦ä¹ -axios">Vueå­¦ä¹ -axios</a><time datetime="2021-08-19T13:14:44.000Z" title="å‘è¡¨äº 2021-08-19 21:14:44">2021-08-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/butterfly/2021/08/19/Flask/Flask%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/" title="Flaskè§£å†³è·¨åŸŸé—®é¢˜"><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/Flaskcover1.jpg" onerror="this.onerror=null;this.src='/butterfly/img/404.jpg'" alt="Flaskè§£å†³è·¨åŸŸé—®é¢˜"/></a><div class="content"><a class="title" href="/butterfly/2021/08/19/Flask/Flask%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/" title="Flaskè§£å†³è·¨åŸŸé—®é¢˜">Flaskè§£å†³è·¨åŸŸé—®é¢˜</a><time datetime="2021-08-19T12:47:12.000Z" title="å‘è¡¨äº 2021-08-19 20:47:12">2021-08-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/butterfly/2021/08/17/Vue/Vue%E5%AD%A6%E4%B9%A0-Vuex/" title="Vueå­¦ä¹ -Vuex"><img src="https://gitee.com/CNhuazhu/tu-chuang1/raw/master/img-blog/Vuecover.jpg" onerror="this.onerror=null;this.src='/butterfly/img/404.jpg'" alt="Vueå­¦ä¹ -Vuex"/></a><div class="content"><a class="title" href="/butterfly/2021/08/17/Vue/Vue%E5%AD%A6%E4%B9%A0-Vuex/" title="Vueå­¦ä¹ -Vuex">Vueå­¦ä¹ -Vuex</a><time datetime="2021-08-17T12:02:53.000Z" title="å‘è¡¨äº 2021-08-17 20:02:53">2021-08-17</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-bolt"></i><span>æœ€æ–°è¯„è®º</span></div><div class="aside-list"><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>åˆ†ç±»</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/butterfly/categories/Python/"><span class="card-category-list-name">Python</span><span class="card-category-list-count">7</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/butterfly/categories/Python/%E9%94%99%E8%AF%AF/"><span class="card-category-list-name">é”™è¯¯</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/butterfly/categories/Vue/"><span class="card-category-list-name">Vue</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/butterfly/categories/Vue/%E9%94%99%E8%AF%AF/"><span class="card-category-list-name">é”™è¯¯</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/butterfly/categories/%E5%8D%9A%E5%AE%A2/"><span class="card-category-list-name">åšå®¢</span><span class="card-category-list-count">32</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/butterfly/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">å­¦ä¹ ç¬”è®°</span><span class="card-category-list-count">41</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/butterfly/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/"><span class="card-category-list-name">è™šæ‹Ÿæœº</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/butterfly/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E9%94%99%E8%AF%AF/"><span class="card-category-list-name">é”™è¯¯</span><span class="card-category-list-count">1</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>æ ‡ç­¾</span></div><div class="card-tag-cloud"><a href="/butterfly/tags/Hexo/" style="font-size: 1.45em; color: rgb(72, 95, 189)">Hexo</a><a href="/butterfly/tags/%E5%9B%BE%E5%BA%8A/" style="font-size: 1.15em; color: rgb(36, 143, 191)">å›¾åºŠ</a><a href="/butterfly/tags/Markdown/" style="font-size: 1.15em; color: rgb(13, 129, 193)">Markdown</a><a href="/butterfly/tags/phpStudy/" style="font-size: 1.15em; color: rgb(171, 148, 174)">phpStudy</a><a href="/butterfly/tags/Flask/" style="font-size: 1.24em; color: rgb(84, 6, 5)">Flask</a><a href="/butterfly/tags/Java/" style="font-size: 1.32em; color: rgb(65, 127, 45)">Java</a><a href="/butterfly/tags/Vue/" style="font-size: 1.36em; color: rgb(129, 31, 144)">Vue</a><a href="/butterfly/tags/Python%E9%94%99%E8%AF%AF/" style="font-size: 1.15em; color: rgb(87, 79, 112)">Pythoné”™è¯¯</a><a href="/butterfly/tags/Jupyter/" style="font-size: 1.19em; color: rgb(85, 106, 37)">Jupyter</a><a href="/butterfly/tags/Scrapy/" style="font-size: 1.15em; color: rgb(42, 133, 0)">Scrapy</a><a href="/butterfly/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.41em; color: rgb(156, 79, 86)">æ“ä½œç³»ç»Ÿ</a><a href="/butterfly/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 1.15em; color: rgb(91, 94, 96)">æ•°è®º</a><a href="/butterfly/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.15em; color: rgb(197, 181, 66)">æ•°æ®åº“</a><a href="/butterfly/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 1.28em; color: rgb(138, 129, 91)">è®¡ç®—æœºç½‘ç»œ</a><a href="/butterfly/tags/CSS/" style="font-size: 1.15em; color: rgb(93, 190, 37)">CSS</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>å½’æ¡£</span><a class="card-more-btn" href="/butterfly/archives/" title="æŸ¥çœ‹æ›´å¤š">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/butterfly/archives/2021/10/"><span class="card-archive-list-date">åæœˆ 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/butterfly/archives/2021/09/"><span class="card-archive-list-date">ä¹æœˆ 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/butterfly/archives/2021/08/"><span class="card-archive-list-date">å…«æœˆ 2021</span><span class="card-archive-list-count">12</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/butterfly/archives/2021/07/"><span class="card-archive-list-date">ä¸ƒæœˆ 2021</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/butterfly/archives/2021/06/"><span class="card-archive-list-date">å…­æœˆ 2021</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/butterfly/archives/2021/05/"><span class="card-archive-list-date">äº”æœˆ 2021</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/butterfly/archives/2021/04/"><span class="card-archive-list-date">å››æœˆ 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/butterfly/archives/2021/03/"><span class="card-archive-list-date">ä¸‰æœˆ 2021</span><span class="card-archive-list-count">19</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>ç½‘ç«™èµ„è®¯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">æ–‡ç« æ•°ç›® :</div><div class="item-count">82</div></div><div class="webinfo-item"><div class="item-name">å·²è¿è¡Œæ—¶é—´ :</div><div class="item-count" id="runtimeshow" data-publishDate="2021-01-19T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">æœ¬ç«™æ€»å­—æ•° :</div><div class="item-count">232.2k</div></div><div class="webinfo-item"><div class="item-name">æœ¬ç«™è®¿å®¢æ•° :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">æœ¬ç«™æ€»è®¿é—®é‡ :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">æœ€åæ›´æ–°æ—¶é—´ :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-10-13T13:32:00.327Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By èŠ±çŒª</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">æ„Ÿè°¢å…‰ä¸´<a target="_blank" rel="noopener external nofollow noreferrer" href="https://cnhuazhu.github.io/blog-LeadPage/" style="text-decoration:underline">å°ç ´ç«™</a>,æ¬¢è¿æ‚¨æå‡ºå®è´µçš„æ„è§ï¼</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="font-plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/butterfly/js/utils.js"></script><script src="/butterfly/js/main.js"></script><script src="/butterfly/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/butterfly/js/search/local-search.js"></script><div class="js-pjax"><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})
setTimeout(function(){preloader.endLoading();}, 3000);</script></div><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'hexo-1g41404w9f800e94',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'hexo-1g41404w9f800e94',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'VHoX95KsBQSMyzEc3TdpmBkF-MdYXbMMI',
      appKey: 'qnwObDMbgMEKnu1Gp8tk7PYJ',
      placeholder: 'æ¬¢è¿ç•™ä¸‹ä½ çš„è¯„è®ºï¼ˆæ˜µç§°å’Œé‚®ç®±ä¸ºå¿…å¡«é¡¹ï¼‰',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Twikoo' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[å›¾ç‰‡]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[é“¾æ¥]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[ä»£ç ]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'hexo-1g41404w9f800e94',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'æ²¡æœ‰è¯„è®º'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script src="/butterfly/js/ip_content.js"></script><script src="/butterfly/js/timing.js"></script><script src="https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fishes.js"></script><script src="/butterfly/js/footer.js"></script><script src="/butterfly/js/ginkgo-leaf.js"></script><script id="canvas_nest" defer="defer" color="0,0,0" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="pjax-reload"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__fadeInLeft');
    arr[i].setAttribute('data-wow-duration', '600ms');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__fadeInRightBig');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer="defer" src="https://cdn.jsdelivr.net/gh/graingert/wow@1.3.0/dist/wow.min.js"></script><script defer="defer" src="/butterfly/js/wow_init.js"></script></div><script src="/butterfly/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/butterfly/live2dw/assets/assets/tororo.model.json"},"display":{"superSample":2,"width":200,"height":400,"position":"left","hOffset":0,"vOffset":-105},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>