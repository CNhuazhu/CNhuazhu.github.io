<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>操作系统学习笔记-进程描述和控制 | 花猪のBlog</title><meta name="keywords" content="操作系统"><meta name="author" content="花猪,2296412185@qq.com"><meta name="copyright" content="花猪"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="记录操作系统学习历程">
<meta property="og:type" content="article">
<meta property="og:title" content="操作系统学习笔记-进程描述和控制">
<meta property="og:url" content="https://cnhuazhu.top/2021/03/30/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E8%BF%9B%E7%A8%8B%E6%8F%8F%E8%BF%B0%E5%92%8C%E6%8E%A7%E5%88%B6/index.html">
<meta property="og:site_name" content="花猪のBlog">
<meta property="og:description" content="记录操作系统学习历程">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OperatingSystemscover1.png">
<meta property="article:published_time" content="2021-03-30T14:48:49.000Z">
<meta property="article:modified_time" content="2021-06-23T02:58:10.240Z">
<meta property="article:author" content="花猪">
<meta property="article:tag" content="操作系统">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OperatingSystemscover1.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg"><link rel="canonical" href="https://cnhuazhu.top/2021/03/30/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E8%BF%9B%E7%A8%8B%E6%8F%8F%E8%BF%B0%E5%92%8C%E6%8E%A7%E5%88%B6/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":60,"languages":{"author":"作者: 花猪","link":"链接: ","source":"来源: 花猪のBlog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#ABADAC","bgDark":"#121212","position":"bottom-right"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '操作系统学习笔记-进程描述和控制',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-06-23 10:58:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/css/tag.css"><link rel="stylesheet" href="/css/pagelucency.css"><style>#article-container.post-content h1:before, h2:before, h3:before, h4:before, h5:before, h6:before { -webkit-animation: avatar_turn_around 1s linear infinite; -moz-animation: avatar_turn_around 1s linear infinite; -o-animation: avatar_turn_around 1s linear infinite; -ms-animation: avatar_turn_around 1s linear infinite; animation: avatar_turn_around 1s linear infinite; }</style><link rel="stylesheet" href="/css/avatarbg.css"><link rel="stylesheet" href="/css/footerlucency.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/macblack.css"><link rel="stylesheet" href="/css/mouse.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiper.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiperstyle.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="花猪のBlog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog-LeadPage/"><i class="fa-fw fas fa-gift"></i><span> 引导</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-sitemap"></i><span> 分站</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/next/"><i class="fa-fw fas fa-chevron-right"></i><span> Next</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fa fa-video"></i><span> 视频</span></a></li><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-quote-left"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/website/"><i class="fa-fw fas fa-globe"></i><span> 网站</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/Message/"><i class="fa-fw fas fa-comment"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background: transparent"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">花猪のBlog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog-LeadPage/"><i class="fa-fw fas fa-gift"></i><span> 引导</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-sitemap"></i><span> 分站</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/next/"><i class="fa-fw fas fa-chevron-right"></i><span> Next</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fa fa-video"></i><span> 视频</span></a></li><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-quote-left"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/website/"><i class="fa-fw fas fa-globe"></i><span> 网站</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/Message/"><i class="fa-fw fas fa-comment"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">操作系统学习笔记-进程描述和控制</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-03-30T14:48:49.000Z" title="发表于 2021-03-30 22:48:49">2021-03-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-23T02:58:10.240Z" title="更新于 2021-06-23 10:58:10">2021-06-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>26分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="操作系统学习笔记-进程描述和控制"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>前言</h1>
<p><em>正在学习操作系统，记录笔记。</em></p>
<blockquote>
<p>参考资料：</p>
<p>《操作系统（精髓与设计原理 第6版） 》</p>
</blockquote>
<hr>
<h1>第三章：进程描述和控制</h1>
<h2 id="什么是进程">什么是进程</h2>
<p>在给进程下定义之前，我们先回顾总结一下第一章和第二章的概念。</p>
<ul>
<li>
<p>计算机平台包括一组硬件资源。（如处理器、内存、I/O模块、定时器和磁盘驱动器等）</p>
</li>
<li>
<p>计算机程序是为执行某些任务而开发的。</p>
</li>
<li>
<p>直接根据给定的硬件平台写应用程序效率是低下的。</p>
<blockquote>
<p>原因如下：</p>
<ul>
<li>针对相同的平台可以开发出很多应用程序，所以开发出这些应用程序访问计算机资源的通用例程是很有意义的。</li>
<li>处理器本身只能对多道程序设计提供有限的支持，需要用软件去管理处理器和其他资源同时被多个程序共享。</li>
<li>如果多个程序在同一时间都是活跃的，那么需要保护每个程序的数据、I/O使用和其他资源不被其他程序占用。</li>
</ul>
</blockquote>
</li>
<li>
<p>开发操作系统是为了给应用程序提供一个方便、安全和一致的接口。</p>
</li>
<li>
<p>可以把操作系统想象为资源的统一抽象表示，可以被应用程序请求和访问。</p>
</li>
</ul>
<p>操作系统需要以一个有序的方式管理应用程序的执行，以达到以下目的：</p>
<ul>
<li>资源对多个应用程序是可用的。</li>
<li>物理处理器在多个应用程序间切换以保证所有程序都在执行中。</li>
<li>处理器和I/O设备能得到充分的利用。</li>
</ul>
<h2 id="进程和进程控制块">进程和进程控制块</h2>
<p>下面给出进程（process）的4个定义：</p>
<ol>
<li>正在执行的程序。</li>
<li>正在计算机上执行的程序实例。</li>
<li>能分配给处理器并由处理器执行的实体。</li>
<li>具有以下特征的活动单元：
<ul>
<li>一组指令序列的执行。</li>
<li>一个当前状态。</li>
<li>相关的系统资源集。</li>
</ul>
</li>
</ol>
<blockquote>
<p>进程的两个基本元素是<strong>程序代码</strong>（可能被执行相同程序的其他进程共享）和代码相关联的<strong>数据集</strong>。</p>
</blockquote>
<p>进程控制块（Process Control Block）</p>
<p>进程控制块是一种数据结构，该控制块由操作系统创建和管理。其中包含了以下信息：</p>
<ul>
<li>
<p>标识信息（Process Identification）/基本信息</p>
<p>系统给每个进程定义了一个唯一标识该进程的非负整数，称作<strong>进程标识符</strong>(PID:Process Identifier)</p>
</li>
<li>
<p>状态信息（Processor State Information）</p>
<p>其中包括以下内容：</p>
<ul>
<li>用户可见寄存器（User-Visible Registers）</li>
<li>控制和状态寄存器（Control and Status Registers）</li>
<li>堆栈指针（Stack Pointers）</li>
</ul>
</li>
<li>
<p>控制信息（Process Control information）</p>
<p>控制信息可以分为以下两类：</p>
<ol>
<li>调度信息（Scheduling Information）：其中包括
<ul>
<li>状态（state）/进程</li>
<li>优先级（Priority）</li>
<li>审计信息（ Accounting information）</li>
</ul>
</li>
<li>控制信息（Control Information）：其中包括
<ul>
<li>数据结构（Data Structuring）</li>
<li>内存管理（Memory Management）</li>
<li>进程间通讯（Interprocess Communication）</li>
<li>资源所有权和利用（Resource Ownership and Utilization）</li>
</ul>
</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E8%BF%9B%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%9D%97.jpg" alt=""></p>
</li>
</ul>
<blockquote>
<p>关于进程控制块的几点说明：</p>
<ul>
<li>包含了进程元素</li>
<li>由操作系统创建和管理</li>
<li>允许支持多个进程</li>
</ul>
<p>进程控制块包含了充分的信息，这样就可以中断一个进程的执行，并且在后来恢复执行进程时就好像进程未被中断过。进程控制块是操作系统能够支持多进程和提供多处理的关键工具。当进程被中断时，操作系统会把程序计数器和处理器寄存器（上下文数据）保存到进程控制块中的相应位置，进程状态也被改变为其他的值（例如阻塞状态或就绪状态）。</p>
</blockquote>
<blockquote>
<p>关于进程和程序的差异：</p>
<ul>
<li>进程是动态的，它的存在只是暂时的。</li>
<li>程序是静态的，它可以持久化存在。</li>
</ul>
</blockquote>
<blockquote>
<p>关于并行和并发：</p>
<ul>
<li>并发：同一个时间段有多个进程在执行。</li>
<li>并行：同一个时间点有多个进程在执行。</li>
</ul>
</blockquote>
<h2 id="进程状态（Process-States）">进程状态（Process States）</h2>
<p>进程轨迹（Trace of Process）</p>
<p>进程轨迹就是：进程执行的指令序列。</p>
<p>调度器（Dispatcher）/分派器可以使处理器从一个进程切换到另一个进程。</p>
<blockquote>
<p>对一个被执行的程序，操作系统会为该程序创建一个进程或任务。从处理器的角度看，它在指令序列中按某种顺序执行指令，这个顺序根据程序计数器寄存器中不断变化的值来指示，程序计数器可能指向不同进程中不同部分的程序代码；从程序自身的角度看，它的执行涉及程序中的一系列指令。</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E8%B0%83%E5%BA%A6%E5%99%A8.jpg" alt=""></p>
<p>上图给出了三个进程在内存中的布局，其中进程A和C执行12条指令，进程B执行4条指令（如下图）</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E8%B0%83%E5%BA%A6%E5%99%A82.jpg" alt=""></p>
<p>现在假设编号为8003的指令执行 后进程必须等待I/O操作，且操作系统仅允许一个进程最多连续执行6个指令周期。下图给出了最初的52个指令周期中交替的轨迹。</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E8%B0%83%E5%BA%A6%E5%99%A84.jpg" alt=""></p>
<p>（阴影部分表示调度器程序的执行）</p>
</blockquote>
<p>指令执行图并不实用，看起来过于繁杂，于是引入了进程模型。下面将会分别介绍两状态进程模型、五状态进程模型以及七状态进程模型。</p>
<h3 id="两状态进程模型（Two-State-Process-Model）">两状态进程模型（Two-State Process Model）</h3>
<p>该模型下的进程有两种状态：运行态（Running）以及非运行态（Not-running）</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E4%B8%A4%E7%8A%B6%E6%80%81%E5%9B%BE.jpg" alt=""></p>
<blockquote>
<p>四种状态：</p>
<ol>
<li>操作系统创建一个新进程（Enter）。</li>
<li>新进程被调度器转换为运行态（Dispatch）。</li>
<li>被中断的进程被调整为非运行态（Pause）。</li>
<li>进程结束运行（Exit）。</li>
</ol>
</blockquote>
<p>从上面这个简单的模型中进而可以分析道，必须通过某种方式来表示进程，从而使操作系统可以跟踪它们。未运行的进程必须保持在某种类型的队列中，并等待它们的执行时机。下图给出了一个队列结构，队列中的每一项都指向某个特定进程的指针。（队列也可以由数据块构成的链表组成，每个数据块表示一个进程）。</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E8%BF%9B%E7%A8%8B%E9%98%9F%E5%88%97.jpg" alt=""></p>
<blockquote>
<p>可以用该排队图描述分派器的行为。被中断的进程转移到等待进程队列中，或者，如果进程已经结束或取消，则被销毁（离开系统）。在任何一种情况下，分派器均从队列中选择一个进程来执行。</p>
</blockquote>
<h3 id="进程的创建和终止">进程的创建和终止</h3>
<p>导致进程创建的原因（4类）：</p>
<table>
<thead>
<tr>
<th>事件</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>新的批处理作业</td>
<td>通常位于磁带或磁盘中的批处理作业控制流被提供给操作系统。当操作系统准备接纳新工作时，它将读取下一个作业控制命令</td>
</tr>
<tr>
<td>交互登录</td>
<td>终端用户登录到系统</td>
</tr>
<tr>
<td>操作系统因为提供一项服务而创建</td>
<td>操作系统可以创建一个进程，代表用户程序执行一个功能，使用户无需等待（如控制打印的进程）</td>
</tr>
<tr>
<td>由现有的进程派生</td>
<td>基于模块化的考虑，或者为了开发并行性，用户程序可以指示创建多个进程</td>
</tr>
</tbody>
</table>
<blockquote>
<p>当操作系统位另一个进程的显示请求创建一个进程时，这个动作被称为<strong>进程派生</strong>。当一个进程派生另一个进程时，前一个称作<strong>父进程</strong>，被派生的叫做<strong>子进程</strong>。</p>
</blockquote>
<p>导致进程终止的事件（我们大致可以分为三类）：</p>
<ol>
<li>自然死亡：程序正常运行完毕。</li>
<li>异常死亡：由于程序在运行过程中本身出现问题，从而触发操作系统的保护机制，杀死进程。</li>
<li>他杀：又可以分为两种情况
<ul>
<li>CPU占用率达到100%，此时操作系统需要杀死一些进程保证计算机系统的运行效率。</li>
<li>用户进程可以杀死它创建的子进程。</li>
</ul>
</li>
</ol>
<p>还有一些具体导致进程终止的原因可见下表：</p>
<table>
<thead>
<tr>
<th>事件</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>正常完成</td>
<td>进程自行执行一个操作系统服务调用，表示它已经结束运行</td>
</tr>
<tr>
<td>超过时限</td>
<td>进程运行时间超过规定的时限。可以测量很多种类型的时间，包括总的运行时间（“挂钟时间”）、花费在执行上的时间以及对于交互进程从上一次用户输入到当前时刻的时间总量</td>
</tr>
<tr>
<td>无可用内存</td>
<td>系统无法满足进程需要的内存空间</td>
</tr>
<tr>
<td>越界</td>
<td>进程试图访问不允许访问的内存单元</td>
</tr>
<tr>
<td>保护错误</td>
<td>进程试图使用不允许使用的资源或文件，或者试图以一种不正确的方式使用，如往只读文件中写</td>
</tr>
<tr>
<td>算数错误</td>
<td>进程试图进行被禁止的计算，如除以零或者存储大于硬件可以接纳的数字</td>
</tr>
<tr>
<td>时间超出</td>
<td>进程等待某一事件发生的时间超过了规定的最大值</td>
</tr>
<tr>
<td>I/O失败</td>
<td>在输入或输出期间发生错误，如找不到文件、在超过规定的最多努力次数后仍然读/写失败（例如当遇到了磁带上的一个坏区时）或者无效操作（如从行式打印机中读）</td>
</tr>
<tr>
<td>无效指令</td>
<td>进程试图执行一个不存在的指令（通常是由于转移到了数据区并企图执行数据）</td>
</tr>
<tr>
<td>特权指令</td>
<td>进程试图使用为操作系统保留的指令</td>
</tr>
<tr>
<td>数据误用</td>
<td>错误类型或未初始化的一块数据</td>
</tr>
<tr>
<td>操作员或操作系统干涉</td>
<td>由于某些原因，操作员或操作系统终止进程（例如，如果存在死锁）</td>
</tr>
<tr>
<td>父进程终止</td>
<td>当一个父进程终止时，操作系统可能会自动终止该进程的所有后代进程</td>
</tr>
<tr>
<td>父进程请求</td>
<td>父进程通常具有终止其任何后代进程的权力</td>
</tr>
</tbody>
</table>
<h3 id="五状态模型">五状态模型</h3>
<p>引入五状态模型的原因：</p>
<p>对于之前介绍的两状态模型，处理器会对可运行的进程以一种轮转（round-robin）的方式操作（依次给队列中的每一个进程一定的执行时间，然后进程返回队列，阻塞情况除外）。但是这种方式存在两类问题：</p>
<ol>
<li>处于非运行状态的进程：
<ul>
<li>进程已经准备就绪，可以运行，但是由于CPU正在被其他占用，从而导致处于非运行态。</li>
<li>存在一些处于阻塞状态（blocked）等待I/O操作结束的进程。</li>
</ul>
</li>
<li>调度器不能只考虑选择队列中等待时间最长的进程，因为这些进程很有可能被阻塞。应该查找那些未被阻塞且在队列中时间最长的进程。</li>
</ol>
<p>解决上述问题的方法就是将非运行状态再细分为两种状态：就绪态（Ready）和阻塞态（Blocked）。因此就出现了如下图所示的五状态模型。</p>
<p>它分别有：</p>
<ul>
<li>
<p>运行态（Running）:该程序正在执行。</p>
</li>
<li>
<p>就绪态（Ready）:进程做好了准备，只要有机会就开始运行。</p>
</li>
<li>
<p>阻塞态（Blocked）:进程在某些事件发生前不能执行（如I/O操作完成）。</p>
</li>
<li>
<p>新建态（New）:新创建的进程，操作系统还未将其加入到可执行进程组中。（进程控制块已经创建但是还未被加载到内存中）</p>
</li>
<li>
<p>退出态（Exit）:操作系统从可执行进程组中释放出的进程（或者是因为它自身停止了，或者是因为某种原因被取消）。</p>
<blockquote>
<p>注意：</p>
<p>新建态：当进程处于新建态时，操作系统所需要的关于该进程的信息保存在内存中的进程表中，但进程自身还未进入内存（存在于外存中，通常是磁盘）。</p>
<p>退出态：指令和数据已经被释放，但是PCB还在内存中。</p>
</blockquote>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E4%BA%94%E7%8A%B6%E6%80%81%E5%9B%BE.jpg" alt=""></p>
<p>五状态模型中的9种事件类型：</p>
<ul>
<li>
<p>空→新建：创建执行一个程序的新进程。</p>
</li>
<li>
<p>新建→就绪（Admit）：操作系统准备好再接纳一个进程时，把一个进程从新建态转换到就绪态。</p>
</li>
<li>
<p>就绪→运行（Dispatch）：需要选择一个新进程运行时，调度器会选择一个处于就绪态的进程。</p>
</li>
<li>
<p>运行→退出（Release）：如果当前正在运行的进程表示自己已经完成或取消，则它将被操作系统终止。</p>
</li>
<li>
<p>运行→就绪（Timeout）：主要有以下几种情况：</p>
<ul>
<li>正在运行的进程达到了“最大运行时长”。（所有多道程序操作系统都有时长限定）</li>
<li>进程优先级导致的进程中断。</li>
<li>进程本身自愿释放对处理器的控制。（例如一个周期性地进行记账和维护的后台进程）</li>
</ul>
</li>
<li>
<p>运行→阻塞（Event Wait）：如果进程请求它必须等待的某些事件，则会进入阻塞态。（如等待I/O）</p>
</li>
<li>
<p>阻塞→就绪（Event Occurs）：当所等待的事件发生时，处于阻塞态的进程会转为就绪态。</p>
</li>
<li>
<p>就绪→退出：在某些系统中，父进程可以在任何时刻终止一个子进程。如果一个父进程终止，则与该父进程有关的所有子进程都将被终止。</p>
</li>
<li>
<p>阻塞→退出：原因同上一条。</p>
<blockquote>
<p>僵尸进程：父进程先于其子进程结束，这时子进程还在内存中，被称为僵尸进程。（如果僵尸进程数量过多会影响计算机系统的运行效率）</p>
</blockquote>
</li>
</ul>
<p>下图给出了进程在不同状态间转换时可能实现的排队规则：</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E8%BF%9B%E7%A8%8B%E9%98%9F%E5%88%972.jpg" alt=""></p>
<blockquote>
<p>有两个队列：就绪队列和阻塞队列。进入系统的每个进程被放置在就绪队列中，当操作系统选择另一个进程运行时，将从就绪队列中选择。当一个正在运行的进程被移出处理器时，它根据情况或者被终止，或者被放置在就绪或阻塞队列中。最后，当一个事件发生时，所有位于阻塞队列中等待这个事件的进程都被转换到就绪队列中。</p>
</blockquote>
<p>上述方案意味着当一个事件发生时，操作系统必须扫描整个阻塞队列，搜所那些等待该事件的进程。但是在大型操作系统中，队列中可能存在几百甚至上千个进程，所以拥有多个队列将会更有效，一个事件可以对应一个队列，这样在某事件发生时，相应队列中的所有进程都将转换到就绪态。</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E8%BF%9B%E7%A8%8B%E9%98%9F%E5%88%973.jpg" alt=""></p>
<p>最后还有一种改进：按照优先级方案分配进程，维护多个就绪队列（每个优先级一个队列）将会带来更多便利。操作系统就可以很容易地确定哪个就绪进程具有最高地优先级且等待事件最长。</p>
<h3 id="被挂起的进程（Suspended-Processes）">被挂起的进程（Suspended Processes）</h3>
<p>实际上，由于I/O活动比计算机速度慢得多，内存中可以保有多个进程，当一个进程在等待时（比如I/O），处理器可以转移到另一个进程。即便如此，上述方案可能导致的一种常见的情况是：内存中有很多进程都在等待I/O。多道程序设计并不能从根本解决问题，大多数时候处理器仍可能处于空闲状态。</p>
<p>一种解决办法就是扩大内存，使其能够载入更多的进程。但是这种办法有两个严重的问题：一是内存价格的问题，从第一章的内容可以看出，扩大内存需要付出很大经济代价。第二个问题是，内存的扩大更可能导致带来更大的进程，而非更多的进程。</p>
<p>所以就出现了第二种解决办法：<strong>交换（swapping）</strong></p>
<p><strong>交换：把内存中某个进程的一部分或者全部转移到外存（磁盘）中。</strong></p>
<blockquote>
<p>交换概念就带来了**挂起（suspend）**状态：当内存中没有处于就绪状态的进程时，操作系统就把被阻塞的进程换出到磁盘的“挂起队列”（suspend queue）中。此后，操作系统可以从挂起队列中取出另一个进程，或者接受一个新进程的请求，将其纳入内存运行。</p>
</blockquote>
<blockquote>
<p>交换是一个I/O操作，但是由于磁盘I/O一般是系统中最快的I/O（相对于磁带或打印机），所以交换通常会提高性能。</p>
</blockquote>
<p>由于交换的出现，又引入了<strong>七状态模型</strong>。</p>
<p>在原有五状态模型的基础上又新增了两个状态：</p>
<ul>
<li>阻塞/挂起态（Blocked/Suspend）：进程在外存中并等待一个事件。</li>
<li>就绪/挂起态（Ready/Suspend）：进程在外存中，但是只要被载入内存就可以执行。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E4%B8%83%E7%8A%B6%E6%80%81%E5%9B%BE.jpg" alt=""></p>
<p>同样的，在五状态模型的9种事件类型的基础上又新增了7种事件类型：</p>
<ul>
<li>
<p>阻塞→阻塞/挂起（Suspend）：如果没有就绪进程，则至少一个阻塞进程被换出，为另一个没有阻塞的进程让出空间。</p>
</li>
<li>
<p>阻塞/挂起→就绪/挂起（Event Suspend）：如果等待的事件发生了，则处于阻塞/挂起状态的进程可以转换到就绪/挂起状态。（注意，这要求操作系统必须能够得到挂起进程的状态信息。）</p>
</li>
<li>
<p>就绪/挂起→就绪（Activate）：如果内存中没有就绪态进程，操作系统需要调入一个进程继续执行。（此外，当处于就绪/挂起态的进程比处于就绪态的任何进程的优先级都要高时，也可以进行这种转换。）</p>
</li>
<li>
<p>就绪→就绪/挂起（Suspend）：通常，操作系统更倾向于挂起阻塞态进程而不是就绪态进程，因为就绪态进程可以立即执行，而阻塞态进程占用了内存空间但不能执行。但如果释放内存以得到足够空间的唯一方法是挂起一个就绪态进程，那么这种转换也是必需的。并且，如果操作系统确信高优先级的阻塞态进程很快将会就绪，那么它可能选择挂起一个低优先级的就绪态进程，而不是一个高优先级的阻塞态进程。</p>
</li>
<li>
<p>新建→就绪/挂起（Admit）：当创建一个新进程时，该进程或者加入到就绪队列，或者加入到就绪/挂起队列中。不论哪种情况，操作系统都必须建立一些表以管理进程，并为进程分配地址空间。（当内存中没有足够的空间分配给新建进程，就会采用此种策略）</p>
</li>
<li>
<p>阻塞/挂起→阻塞（Activate）：一个进程终止，释放了一些内存空间，阻塞/挂起队列中有一个进程比就绪/挂起队列中的任何进程的优先级都要高，并且操作系统有理由相信阻塞进程的事件很快就会发生，这时，把阻塞进程而不是就绪进程调入内存是合理的。</p>
</li>
<li>
<p>运行→就绪/挂起（Suspend）：通常当分配给一个运行进程的时间期满时，它将转换到就绪态。但是，如果由于位于阻塞/挂起队列的具有较高优先级的进程变得不再被阻塞，操作系统抢占这个进程，也可以直接把这个运行进程转换到就绪/挂起队形中，并释放一些内存空间。（这是可能但不是必须的转换）</p>
<blockquote>
<p>在某些操作系统中，允许一个进程可以被创建它的进程终止，所以在这样的情况下，进程在任何状态都可以转换到退出状态。</p>
</blockquote>
</li>
</ul>
<p>挂起的特点（重新理解并定义）：</p>
<ul>
<li>进程不能立即执行。</li>
<li>进程可能是或不是正在等待一个事件。如果是，阻塞条件不依赖于挂起条件，阻塞事件的发生不会使进程立即被执行。</li>
<li>为阻止进程执行，可以通过代理把这个进程置于挂起状态，代理可以是进程自己，也可以是父进程或操作系统。</li>
<li>除非代理显式地命令系统进行状态转换，否则进程无法从这个状态中转移。</li>
</ul>
<p>下表展示了导致进程挂起的原因：</p>
<table>
<thead>
<tr>
<th>事件</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>交换</td>
<td>操作系统需要释放足够的内存空间，以调入并执行处于就绪状态的进程</td>
</tr>
<tr>
<td>其他OS原因</td>
<td>操作系统可能挂起后台进程或工具程序进程，或者被怀疑导致问题的进程</td>
</tr>
<tr>
<td>交互式用户请求</td>
<td>用户可能希望挂起一个程序的执行，目的是为了调试或者与一个资源的使用进行连接</td>
</tr>
<tr>
<td>定时</td>
<td>一个进程可能会周期性地执行（例如记账或系统监视进程），而且可能在等待下一个时间间隔时被挂起</td>
</tr>
<tr>
<td>父进程请求</td>
<td>父进程可能会希望挂起后代进程的执行，以检查或修改挂起的进程，或者协调不同后代进程之间的行为</td>
</tr>
</tbody>
</table>
<h2 id="进程描述（Process-Description）">进程描述（Process Description）</h2>
<p>进程和资源（Processes and Resources）</p>
<p>在多道程序设计环境中，在虚拟内存中有许多已经创建了的进程（P<sub>1</sub>，…，P<sub>n</sub>），每个进程在执行期间，需要访问某些系统资源，包括处理器、I/O设备和内存。在图中，进程P<sub>1</sub>正在运行，该进程至少有一部分在内存中，并且还控制着两个I/O设备；进程P<sub>2</sub>也在内存中，但由于正在等待分配给P<sub>1</sub>的I/O设备而被阻塞；进程P<sub>n</sub>已经被换出，因此是挂起的。</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E8%BF%9B%E7%A8%8B%E6%8F%8F%E8%BF%B0.jpg" alt=""></p>
<p>操作系统的控制结构（Operating System Control Structures）</p>
<p>操作系统为了管理进程和资源，必须掌握关于每个进程和资源当前状态的信息。普遍使用的方法是：操作系统构造并维护它所管理的每个实体的信息表。在一般情况下，操作系统维护着4种不同类型的表：内存表（Memory Tables）、I/O表（I/O Tables）、文件表（File Tables）、进程表（Process Table）。</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E5%AE%9E%E4%BD%93%E4%BF%A1%E6%81%AF%E8%A1%A8.png" alt=""></p>
<ul>
<li>
<p>内存表：用于跟踪内（实）存和外存（虚拟内存）。</p>
<ul>
<li>分配给进程的主存（内存）</li>
<li>分配给进程的辅存（外存）</li>
<li>内存块或虚拟内存块的任何保护属性，如哪些进程可以访问某些共享内存区域。</li>
<li>管理虚拟内存所需要的任何信息</li>
</ul>
</li>
<li>
<p>I/O表：管理计算机系统中的I/O设备和通道。</p>
<ul>
<li>I/O设备或是可用的，或是已分配给某个特定的进程。</li>
<li>I/O操作的状态。</li>
<li>如果正在进行I/O操作，则操作系统需要知道I/O操作的状态和作为I/O传送的源和目标的内存单元。</li>
</ul>
</li>
<li>
<p>文件表：</p>
<ul>
<li>文件是否存在。</li>
<li>文件在外存中的位置。</li>
<li>当前状态。</li>
<li>其他属性。</li>
</ul>
</li>
<li>
<p>进程表：每个条目描述一个进程映像。</p>
<blockquote>
<p>进程表主要有四种类型（见下表）：用户数据、用户程序、系统栈以及进程控制块。这些表必须以某种方式链接起来或交叉引用。内存、I/O和文件是代表进程而被管理的，因此进程表中必须有对这些资源的直接或间接引用。文件表中的文件可以通过I/O设备访问，有时它们也位于内存中或虚拟内存中。这些表自身必须可以被操作系统访问到，因此它们受制于内存管理。</p>
</blockquote>
<p>进程映像（process image）</p>
<table>
<thead>
<tr>
<th>项目</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用户数据</td>
<td>用户空间中的可修改部分，可以包括程序数据、用户栈区域和可修改的程序</td>
</tr>
<tr>
<td>用户程序</td>
<td>将被执行的程序</td>
</tr>
<tr>
<td>系统栈</td>
<td>每个进程有一个或多个后进先出（LIFO）系统栈。栈用于保存参数、过程调用地址和系统调用地址</td>
</tr>
<tr>
<td>进程控制块</td>
<td>操作系统控制进程所需要的数据</td>
</tr>
</tbody>
</table>
</li>
</ul>
<blockquote>
<p>进程最少必须包括一个或一组被执行的程序，与这些程序相关联的是局部变量、全局变量和任何已定义常量的数据单元。程序的执行通常涉及用于跟踪过程调用和过程间参数传递的栈。与每个进程相关联的还有操作系统用于控制进程的许多属性，通常，属性的集合称为进程控制块（PCB）。</p>
</blockquote>
<blockquote>
<p>进程控制块信息可以分为以下三类：</p>
<ul>
<li>进程标识信息</li>
<li>处理器状态信息</li>
<li>进程控制信息</li>
</ul>
<p>进程控制块中的典型元素见下表：</p>
<p>进程标识信息</p>
<table>
<thead>
<tr>
<th>元素</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>标识符</td>
<td>存储在进程控制块中的数字标识符，包括<br/>· 此进程的标识符（Process ID，简称进程ID）<br/>· 创建这个进程的进程（父进程）标识符<br/>· 用户标识符（UserID，简称用户ID）</td>
</tr>
</tbody>
</table>
<p>处理器状态信息</p>
<table>
<thead>
<tr>
<th>元素</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用户可见寄存器</td>
<td>用户可见寄存器是处于用户态的处理器执行的机器语言可以访问的寄存器。通常有8到32个此类寄存器，而在一些RISC实现中有超过100个此类寄存器</td>
</tr>
<tr>
<td>控制和状态寄存器</td>
<td>用于控制处理器操作的各种处理器寄存器，包括：<br/>· 程序计数器：包含将要取的下一条指令的地址<br/>· 条件码：最近的算术或逻辑运算的结果（例如符号、零、进位、等于、溢出）<br/>· 状态信息：包括中断允许/禁用标志、异常模式</td>
</tr>
<tr>
<td>栈指针</td>
<td>每个进程有一个或多个与之相关联的后进先出（LIFO）系统栈。栈用于保存参数和过程调用或系统调用的地址，栈指针指向栈顶</td>
</tr>
</tbody>
</table>
<p>进程控制信息</p>
<table>
<thead>
<tr>
<th>元素</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>调度和状态信息</td>
<td>这是操作系统执行其调度功能所需要的信息，典型的信息项包括：<br/>· 进程状态：定义将被调度执行的进程的准备情况（例如运行态、就绪态、等待态、停止态）<br/>· 优先级：用于描述进程调度优先级的一个或多个域。在某些系统中，需要多个值（例如默认、当前、最高许可）<br/>· 调度相关信息：这取决于所使用的调度算法。例如进程等待的时间总量和进程在上一次运行时执行时间总量<br/>· 事件：进程在继续执行前等待的事件标识</td>
</tr>
<tr>
<td>数据结构</td>
<td>进程可以以队列、环或者别的结构形式与其他进程进行链接。例如，所有具有某一特定优先级且处于等待状态的进程可链接在一个队列中；进程还可以表示出与另一个进程的父子（创建者-被创建者）关系。进程控制块为支持这些结构需要包含指向其他进程的指针</td>
</tr>
<tr>
<td>进程间通信</td>
<td>与两个独立进程间的通信相关联的各种标记、信号和信息。进程控制块中维护着某些或全部此类信息</td>
</tr>
<tr>
<td>进程特权</td>
<td>进程根据其可以访问的内存空间以及可以执行的指令类型被赋予各种特权。此外，特权还用于系统实用程序和服务的使用</td>
</tr>
<tr>
<td>存储管理</td>
<td>这一部分包括指向描述分配给该进程的虚拟内存空间的段表和页表的指针</td>
</tr>
<tr>
<td>资源的所有权和使用情况</td>
<td>进程控制的资源可以表示成诸如一个打开的文件，还可能包括处理器或其他资源的使用历史；调度器会需要这些信息</td>
</tr>
</tbody>
</table>
</blockquote>
<blockquote>
<p>实际上在所有的操作系统中，对于进程标识符，每个进程都分配了一个唯一的数字标识符。进程标识符可以简单地表示为主进程表中的一个索引；否则，必须有一个映射，使得操作系统可以根据进程标识符定位相应的表。</p>
<p>除了进程标识符，还给进程分配了一个用户标识符，用于标明拥有该进程的用户。</p>
</blockquote>
<h2 id="进程控制（Process-Control）">进程控制（Process Control）</h2>
<p>执行模式（Modes of Execution）</p>
<p>大多数处理器至少支持两种执行模式：用户模式（User mode）以及内核模式（kernel mode）</p>
<p>用户模式：</p>
<ul>
<li>低权限模式</li>
<li>用户程序通常在这种模式下执行</li>
</ul>
<p>内核模式：</p>
<ul>
<li>高权限模式</li>
<li>操作系统的内核</li>
</ul>
<blockquote>
<p>使用两种模式的原因是很显然的，它可以保护操作系统和重要的操作系统表（如进程控制块）不受用户程序的干涉。在内核态下，软件具有对处理器以及所有指令、寄存器和内存的控制能力，这一级的控制对用户程序不是必需的，并且为了安全起见也不是用户程序可访问的。</p>
</blockquote>
<p>两种模式的切换</p>
<p>程序状态字中有一位表示执行模式，这一位应某些事件的要求而改变。在典型情况下，当用户调用一个操作系统服务或中断触发系统例程的执行时，执行模式被设置成内核态，当从系统服务返回到用户进程时，执行模式被设置为用户态。<strong>处理器状态寄存器（Processor status register ，PSR）<strong>中包含</strong>当前特权级别（Current privileged level，CPL）</strong>。当执行不同的进程时，操作系统会根据需要对CPL进行置位或清零的操作去改变其模式（通常数字越小，级别越大）。</p>
<p>进程创建（Process Creation）</p>
<p>进程创建的步骤按如下5步进行：</p>
<ol>
<li>
<p>给进程分配一个唯一的进程标识符。</p>
<p>此时，在主进程表中增加了一个新表项，表中的每个新表项对应着一个进程。</p>
</li>
<li>
<p>给进程分配空间。</p>
<p>这包括进程映像中的所有元素。</p>
</li>
<li>
<p>初始化进程控制块。</p>
</li>
<li>
<p>设置正确的连接。</p>
<p>例如，如果操作系统把每个调度队列都保存成链表，则新进程必须放置在就绪或就绪/挂起链表中。</p>
</li>
<li>
<p>创建或扩充其他数据结构。</p>
<p>例如，操作系统可能为每个进程保存着一个记账文件，可用于编制账单和/或进行性能评估。</p>
</li>
</ol>
<p>进程切换（Process Switching）</p>
<p>引发进程切换的原因：</p>
<ul>
<li>
<p>中断：当前指令的外部执行</p>
<ul>
<li>
<p>时钟中断（Clock interrupt）：当前运行的进程超过了最大允许时间段（片），则该进程必须切换到就绪态，调入另一个进程。</p>
</li>
<li>
<p>I/O中断</p>
</li>
<li>
<p>内存中断（失效，Memory fault）：处理器访问一个虚拟内存地址，且此地址单元不在内存中时，操作系统必须从外存中把包含这个引用的内存块（页或段）调入内存中。</p>
<blockquote>
<p>在发出调入内存块的I/O请求之后，操作系统可能会执行一个进程切换，以恢复另一个进程的执行，发生内存失效的进程被置为阻塞态，当想要的块调入内存中时，该进程被置为就绪态。</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>陷阱（Trap）：当前指令的执行相关</p>
<p>一个运行中的程序由于自身错误的原因引发操作系统的保护机制。可能导致进程被转为退出态。</p>
</li>
<li>
<p>系统调用（System Call）</p>
<p>例如打开文件操作。通常，使用系统调用会导致把用户进程置位阻塞态。</p>
</li>
</ul>
<p>模式切换VS进程切换</p>
<p>模式切换：</p>
<p>（当中断发生时）</p>
<ol>
<li>把程序计数器置成中断处理程序的开始地址。</li>
<li>从用户态切换到内核态，使得中断处理代码可以包含有特权的指令。</li>
</ol>
<p>进程切换：</p>
<ol>
<li>保存处理器上下文环境。包括程序计数器和其他寄存器。</li>
<li>更新当前处于运行态进程的进程控制块。包括将进程的状态改变到另一状态（就绪态、阻塞态、就绪/挂起态或退出态）。还必须更新其他相关域，包括离开运行态的原因和记账信息。</li>
<li>将进程的进程控制块移到相应的队列（就绪、在事件i处阻塞、就绪/挂起）。</li>
<li>选择另一个进程执行。</li>
<li>更新所选择进程的进程控制块。包括将进程的状态变为运行态。</li>
<li>更新内存管理的数据结构。</li>
<li>恢复处理器在被选择的进程最近一次切换出运行状态时的上下文环境。这可以通过载入程序计数器和其他寄存器以前的值来实现。</li>
</ol>
<blockquote>
<p>模式切换较进程切换的代价要小。</p>
<p>进程切换一定包含模式切换；但是模式切换不一定包含进程切换。</p>
</blockquote>
<p>操作系统的执行（Execution of the Operating System）</p>
<p>操作系统与普通计算机软件一样由处理器执行，同样的，操作系统也是一个进程。下面介绍关于如何控制这种进程。</p>
<p>无进程的内核（Non-process Kernel）</p>
<ul>
<li>
<p>在许多老操作系统中，非常传统和通用的一种方式就是在所有进程之外执行操作系统内核。</p>
</li>
<li>
<p>操作系统有自己的内存区域和系统栈，用于控制过程调用和返回。</p>
</li>
<li>
<p>操作系统代码作为一个在特权模式下工作的独立实体被执行。</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E6%97%A0%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%86%85%E6%A0%B8.jpg" alt=""></p>
</li>
</ul>
<p>在用户进程中执行（Execution Within User Processes）</p>
<ul>
<li>
<p>在用户进程的上下文中执行几乎所有操作系统软件。（操作系统从根本上说时用户调用的一组例程，在用户环境中执行，用于实现各种功能）</p>
</li>
<li>
<p>执行操作系统代码时，进程在特权模式下执行。</p>
</li>
<li>
<p>在用户进程中执行的代码是共享操作系统代码而不是用户代码。基于用户态和内核态的概念，即使操作系统例程在用户进程环境中执行，用户也不能篡改或干涉操作系统的历程。（这也进一步说明了进程和程序的概念是不同的）</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E5%9C%A8%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B%E4%B8%AD%E6%89%A7%E8%A1%8C.jpg" alt=""></p>
</li>
</ul>
<p>基于进程的操作系统（Process-Based Operating System）</p>
<ul>
<li>
<p>把操作系统作为一组系统进程来实现。</p>
</li>
<li>
<p>使用模块化操作系统，并且模块之间具有最小的、简明的接口。</p>
</li>
<li>
<p>一些非关键的操作系统函数可简单地用独立的进程实现。</p>
</li>
<li>
<p>这在多处理器或多机环境中都是十分有用的。</p>
<p><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OS%E5%9F%BA%E4%BA%8E%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.jpg" alt=""></p>
</li>
</ul>
<hr>
<h1>后记</h1>
<p>本篇已完结</p>
<p>（如有修改或补充欢迎评论）</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OperatingSystemscover1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/wechat.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/alipay.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/03/14/操作系统/操作系统学习笔记-计算机系统概述/" title="操作系统学习笔记-计算机系统概述"><img class="cover" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OperatingSystemscover1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-14</div><div class="title">操作系统学习笔记-计算机系统概述</div></div></a></div><div><a href="/2021/03/28/操作系统/操作系统学习笔记/" title="操作系统学习笔记"><img class="cover" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-28</div><div class="title">操作系统学习笔记</div></div></a></div><div><a href="/2021/06/02/操作系统/操作系统学习笔记-I-O管理和磁盘调度/" title="操作系统学习笔记-I/O管理和磁盘调度"><img class="cover" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OperatingSystemscover1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-02</div><div class="title">操作系统学习笔记-I/O管理和磁盘调度</div></div></a></div><div><a href="/2021/04/25/操作系统/操作系统学习笔记-信号量相关问题/" title="操作系统学习笔记-信号量相关问题"><img class="cover" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OperatingSystemscover1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-25</div><div class="title">操作系统学习笔记-信号量相关问题</div></div></a></div><div><a href="/2021/05/23/操作系统/操作系统学习笔记-内存管理/" title="操作系统学习笔记-内存管理"><img class="cover" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OperatingSystemscover1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-23</div><div class="title">操作系统学习笔记-内存管理</div></div></a></div><div><a href="/2021/05/30/操作系统/操作系统学习笔记-单处理器调度/" title="操作系统学习笔记-单处理器调度"><img class="cover" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/OperatingSystemscover1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-30</div><div class="title">操作系统学习笔记-单处理器调度</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Twikoo</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">花猪</div><div class="author-info__description">寄给你，这片小小的银杏叶<br>它什么也不暗示，因为是秋天了</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/CNhuazhu"><i class="fab fa-github"></i><span>我的github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/CNhuazhu" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">花猪在此欢迎您光临小破站 (՞•Ꙫ•՞) <br><br>  <b><i>本站已更新域名</i></b>：<a href="https://cnhuazhu.top">https://cnhuazhu.top</a> <br>  <b><i>码云地址（同步更新）</i></b>：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://cnhuazhu.gitee.io">https://cnhuazhu.gitee.io</a> <br><br>  本站主题：Butterfly 3.7.8 <br> <img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/pig.gif"></div><timing></timing></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">第三章：进程描述和控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%BF%9B%E7%A8%8B"><span class="toc-number">2.1.</span> <span class="toc-text">什么是进程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%92%8C%E8%BF%9B%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%9D%97"><span class="toc-number">2.2.</span> <span class="toc-text">进程和进程控制块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%EF%BC%88Process-States%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">进程状态（Process States）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E7%8A%B6%E6%80%81%E8%BF%9B%E7%A8%8B%E6%A8%A1%E5%9E%8B%EF%BC%88Two-State-Process-Model%EF%BC%89"><span class="toc-number">2.3.1.</span> <span class="toc-text">两状态进程模型（Two-State Process Model）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E7%BB%88%E6%AD%A2"><span class="toc-number">2.3.2.</span> <span class="toc-text">进程的创建和终止</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E7%8A%B6%E6%80%81%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.3.3.</span> <span class="toc-text">五状态模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A2%AB%E6%8C%82%E8%B5%B7%E7%9A%84%E8%BF%9B%E7%A8%8B%EF%BC%88Suspended-Processes%EF%BC%89"><span class="toc-number">2.3.4.</span> <span class="toc-text">被挂起的进程（Suspended Processes）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E6%8F%8F%E8%BF%B0%EF%BC%88Process-Description%EF%BC%89"><span class="toc-number">2.4.</span> <span class="toc-text">进程描述（Process Description）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E6%8E%A7%E5%88%B6%EF%BC%88Process-Control%EF%BC%89"><span class="toc-number">2.5.</span> <span class="toc-text">进程控制（Process Control）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">后记</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/10/12/Hexo%E9%83%A8%E7%BD%B2%E8%87%B3%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88Ubuntu-20-04%EF%BC%89/" title="Hexo部署至服务器（Ubuntu 20.04）"><img src="https://gitee.com/CNhuazhu/tu-chuang1/raw/master/img-blog/Ubuntu_Server_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo部署至服务器（Ubuntu 20.04）"/></a><div class="content"><a class="title" href="/2021/10/12/Hexo%E9%83%A8%E7%BD%B2%E8%87%B3%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88Ubuntu-20-04%EF%BC%89/" title="Hexo部署至服务器（Ubuntu 20.04）">Hexo部署至服务器（Ubuntu 20.04）</a><time datetime="2021-10-12T07:13:40.000Z" title="发表于 2021-10-12 15:13:40">2021-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/26/CSS/CSS%E9%80%89%E6%8B%A9%E5%99%A8/" title="CSS选择器"><img src="https://gitee.com/CNhuazhu/tu-chuang1/raw/master/img-blog/CSS3cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CSS选择器"/></a><div class="content"><a class="title" href="/2021/09/26/CSS/CSS%E9%80%89%E6%8B%A9%E5%99%A8/" title="CSS选择器">CSS选择器</a><time datetime="2021-09-26T09:08:37.000Z" title="发表于 2021-09-26 17:08:37">2021-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/19/Vue/Vue%E5%AD%A6%E4%B9%A0-axios/" title="Vue学习-axios"><img src="https://gitee.com/CNhuazhu/tu-chuang1/raw/master/img-blog/Vuecover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vue学习-axios"/></a><div class="content"><a class="title" href="/2021/08/19/Vue/Vue%E5%AD%A6%E4%B9%A0-axios/" title="Vue学习-axios">Vue学习-axios</a><time datetime="2021-08-19T13:14:44.000Z" title="发表于 2021-08-19 21:14:44">2021-08-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/19/Flask/Flask%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/" title="Flask解决跨域问题"><img src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/Flaskcover1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Flask解决跨域问题"/></a><div class="content"><a class="title" href="/2021/08/19/Flask/Flask%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/" title="Flask解决跨域问题">Flask解决跨域问题</a><time datetime="2021-08-19T12:47:12.000Z" title="发表于 2021-08-19 20:47:12">2021-08-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/17/Vue/Vue%E5%AD%A6%E4%B9%A0-Vuex/" title="Vue学习-Vuex"><img src="https://gitee.com/CNhuazhu/tu-chuang1/raw/master/img-blog/Vuecover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vue学习-Vuex"/></a><div class="content"><a class="title" href="/2021/08/17/Vue/Vue%E5%AD%A6%E4%B9%A0-Vuex/" title="Vue学习-Vuex">Vue学习-Vuex</a><time datetime="2021-08-17T12:02:53.000Z" title="发表于 2021-08-17 20:02:53">2021-08-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By 花猪</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">感谢光临<a target="_blank" rel="noopener external nofollow noreferrer" href="https://cnhuazhu.github.io/blog-LeadPage/" style="text-decoration:underline">小破站</a>,欢迎您提出宝贵的意见！</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})
setTimeout(function(){preloader.endLoading();}, 3000);</script></div><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'hexo-1g41404w9f800e94',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'hexo-1g41404w9f800e94',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'VHoX95KsBQSMyzEc3TdpmBkF-MdYXbMMI',
      appKey: 'qnwObDMbgMEKnu1Gp8tk7PYJ',
      placeholder: '欢迎留下你的评论（昵称和邮箱为必填项）',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Twikoo' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script src="/js/ip_content.js"></script><script src="/js/timing.js"></script><script src="https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fishes.js"></script><script src="/js/footer.js"></script><script src="/js/ginkgo-leaf.js"></script><script id="canvas_nest" defer="defer" color="0,0,0" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="pjax-reload"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__fadeInLeft');
    arr[i].setAttribute('data-wow-duration', '600ms');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__fadeInRightBig');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer="defer" src="https://cdn.jsdelivr.net/gh/graingert/wow@1.3.0/dist/wow.min.js"></script><script defer="defer" src="/js/wow_init.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
                        function butterfly_swiper_injector_config(){
                          var parent_div_git = document.getElementById('recent-posts');
                          var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/03/28/Hexo魔改/Hexo魔改记录/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage4.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-03-28</span><a class="blog-slider__title" href="2021/03/28/Hexo魔改/Hexo魔改记录/" alt="">Hexo魔改记录</a><div class="blog-slider__text">Hexo魔改记录</div><a class="blog-slider__button" href="2021/03/28/Hexo魔改/Hexo魔改记录/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/08/02/Vue/Vue学习笔记/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage5.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-08-02</span><a class="blog-slider__title" href="2021/08/02/Vue/Vue学习笔记/" alt="">Vue学习笔记</a><div class="blog-slider__text">本文将介绍Vue的基础语法</div><a class="blog-slider__button" href="2021/08/02/Vue/Vue学习笔记/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/03/28/Java/Java学习记录/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage8.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-03-28</span><a class="blog-slider__title" href="2021/03/28/Java/Java学习记录/" alt="">Java学习记录</a><div class="blog-slider__text">Java学习记录</div><a class="blog-slider__button" href="2021/03/28/Java/Java学习记录/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/03/28/操作系统/操作系统学习笔记/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage7.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-03-28</span><a class="blog-slider__title" href="2021/03/28/操作系统/操作系统学习笔记/" alt="">操作系统学习笔记</a><div class="blog-slider__text">记录操作系统学习历程</div><a class="blog-slider__button" href="2021/03/28/操作系统/操作系统学习笔记/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/03/28/计算机网络/计算机网络学习笔记/" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/CNhuazhu/Image/RotatingImage3.jpg" alt=""/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-03-28</span><a class="blog-slider__title" href="2021/03/28/计算机网络/计算机网络学习笔记/" alt="">计算机网络学习笔记</a><div class="blog-slider__text">记录计算机网络学习历程</div><a class="blog-slider__button" href="2021/03/28/计算机网络/计算机网络学习笔记/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
                          console.log('已挂载butterfly_swiper')
                          // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                          parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
                          }
                        if( document.getElementById('recent-posts') && (location.pathname ==='all'|| 'all' ==='all')){
                        butterfly_swiper_injector_config()
                        }
                      </script><script defer src="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"superSample":2,"width":200,"height":400,"position":"left","hOffset":0,"vOffset":-105},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>